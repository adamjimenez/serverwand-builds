{"version":3,"file":"js/6717.0b4e787f.js","mappings":"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","sources":["webpack://ServerWand/./src/views/sites/Backups.vue?313d","webpack://ServerWand/src/views/sites/Backups.vue","webpack://ServerWand/./src/views/sites/Backups.vue?446b","webpack://ServerWand/./src/views/sites/Backups.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(_vm.error)?_c('v-alert',{attrs:{\"type\":\"error\"}},[_vm._v(\" \"+_vm._s(_vm.error)+\" \")]):_vm._e(),_c('Loading',{attrs:{\"value\":_vm.loading}}),_c('v-card',{ref:\"results\",staticClass:\"pa-3\",attrs:{\"loading\":_vm.fetching}},[_c('v-container',{attrs:{\"fluid\":\"\"}},[_c('v-row',[_c('v-col',{staticClass:\"flex-grow-0\"},[_c('v-btn',{ref:\"uploadFolderButton\",attrs:{\"title\":\"Create backup\"},on:{\"click\":function($event){return _vm.createBackup()}}},[_c('v-icon',[_vm._v(\"add\")])],1)],1),_c('Upload',{attrs:{\"serverId\":_vm.serverId,\"path\":_vm.path,\"dropZone\":_vm.$refs.results},on:{\"complete\":function($event){return _vm.fetchData()},\"error\":_vm.handleError}})],1)],1),(_vm.data.items.length > 0)?_c('v-list',[_c('v-list-item-group',[_vm._l((_vm.data.items),function(item,i){return [_c('v-list-item',{key:(\"item-\" + i),attrs:{\"value\":item},on:{\"click\":[function($event){return _vm.restore(item.name)},function($event){$event.stopPropagation();}]},scopedSlots:_vm._u([{key:\"default\",fn:function(){return [_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(_vm._s(item.name))]),_c('v-list-item-subtitle',[_vm._v(_vm._s(item.date)+\" - \"+_vm._s(_vm._f(\"prettyBytes\")(item.size)))])],1),_c('v-list-item-action',[_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":[function($event){return _vm.download(item)},function($event){$event.stopPropagation();}]}},[_c('v-icon',{attrs:{\"small\":\"\"}},[_vm._v(\"download\")])],1)],1),_c('v-list-item-action',[_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":[function($event){return _vm.deleteBackup(item.name)},function($event){$event.stopPropagation();}]}},[_c('v-icon',{attrs:{\"small\":\"\"}},[_vm._v(\"delete\")])],1)],1)]},proxy:true}],null,true)})]})],2)],1):_c('v-card-text',[_vm._v(\" Empty \")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <v-alert v-if=\"error\" type=\"error\">\n      {{ error }}\n    </v-alert>\n\n    <Loading :value=\"loading\" />\n\n    <v-card class=\"pa-3\" :loading=\"fetching\" ref=\"results\">\n\n      <v-container fluid>\n        <v-row>\n\n          <v-col class=\"flex-grow-0\">\n            <v-btn title=\"Create backup\" ref=\"uploadFolderButton\" @click=\"createBackup()\">\n              <v-icon>add</v-icon>\n            </v-btn>\n          </v-col>\n\n          <Upload\n            :serverId=\"serverId\"\n            :path=\"path\"\n            :dropZone=\"$refs.results\"\n            @complete=\"fetchData()\"\n            @error=\"handleError\"        \n          />\n        </v-row>\n      </v-container>\n\n      <v-list v-if=\"data.items.length > 0\">\n        <v-list-item-group>\n          <template v-for=\"(item, i) in data.items\">\n            <v-list-item\n              :key=\"`item-${i}`\"\n              :value=\"item\"\n              @click=\"restore(item.name)\"\n              @click.stop\n            >\n              <template v-slot:default>\n                <v-list-item-content>\n                  <v-list-item-title>{{ item.name }}</v-list-item-title>\n                  <v-list-item-subtitle\n                    >{{ item.date }} -\n                    {{ item.size | prettyBytes }}</v-list-item-subtitle\n                  >\n                </v-list-item-content>\n\n                <v-list-item-action>\n                  <v-btn icon @click=\"download(item)\" @click.stop>\n                    <v-icon small>download</v-icon>\n                  </v-btn>\n                </v-list-item-action>\n\n                <v-list-item-action>\n                  <v-btn icon @click=\"deleteBackup(item.name)\" @click.stop>\n                    <v-icon small>delete</v-icon>\n                  </v-btn>\n                </v-list-item-action>\n              </template>\n            </v-list-item>\n          </template>\n        </v-list-item-group>\n      </v-list>\n\n      <v-card-text v-else> Empty </v-card-text>\n    </v-card>\n\n  </div>\n</template>\n\n<script>\nimport api from \"../../services/api\";\nimport Loading from \"../../components/Loading\";\nimport Upload from \"../../components/Files/Upload\";\n\nexport default {\n  components: {\n    Loading,\n    Upload,\n  },\n  data() {\n    return {\n      path: \"/\",\n      domainId: null,\n      post: null,\n      error: null,\n      data: {\n        domain: \"\",\n        items: [],\n      },\n      loading: false,\n      details: \"\",\n      loading: false,\n      fetching: false,\n      alias: {\n        domain: \"\",\n        dns: false,\n      },\n      timer: null,\n      serverId: 0,\n      progress: 0,\n    };\n  },\n  created() {\n    // fetch the data when the view is created and the data is\n    // already being observed\n    this.fetchData();\n  },\n  watch: {\n    // call again the method if the route changes\n    $route: \"fetchData\",\n  },\n  methods: {\n    fetchData() {\n      var self = this;\n      this.error = \"\";\n      this.domainId = this.$route.params.id;\n      clearTimeout(self.timer);\n\n      this.fetching = true;\n      this.progress = 0;\n\n      api\n        .get(\"sites/\" + this.domainId + \"/backups\")\n        .then(function (response) {\n          console.log(response);\n\n          if (response.data.error) {\n            self.error = response.data.error;\n            return false;\n          }\n\n          self.data = response.data;\n          document.title = \"Backups\" + \" | \" + self.data.domain;\n\n          self.serverId = self.data.server.id;\n          self.path = '/var/www/vhosts/' + self.data.server.ip + '/public/backups';\n        })\n        .catch(function (error) {\n          console.log(error);\n        })\n        .finally(function () {\n          self.fetching = false;\n        });\n    },\n    createBackup() {\n      var self = this;\n      this.fetching = true;\n      this.error = '';\n\n      api\n        .get(\"sites/\" + this.domainId + \"/backups/create\")\n        .then(function (response) {\n          console.log(response);\n\n          if (!response.data.success) {\n            self.error = response.data.error;\n          } else {\n            self.fetchData();\n          }\n        })\n        .catch(function (error) {\n          console.log(error);\n        })\n        .finally(function () {\n          self.fetching = false;\n        });\n    },\n    download(item) {\n      console.log(\"https://\" + this.data.server.ip + \"/backups/\" + item.name);\n      window.open(\"https://\" + this.data.server.ip + \"/backups/\" + item.name);\n    },\n    deleteBackup(item) {\n      this.$confirm(\"Delete \" + item + \"?\").then((res) => {\n        if (!res) {\n          return;\n        }\n\n        var self = this;\n        self.fetching = true;\n\n        api\n          .post(\"sites/\" + this.domainId + \"/backups\", { ids: [item] })\n          .then(function () {\n            self.fetchData();\n          })\n          .catch(function (error) {\n            console.log(error);\n            self.fetching = false;\n          });\n      });\n    },\n    restore(item) {\n      this.$confirm(\"Restore \" + item + \"?\").then((res) => {\n        if (!res) {\n          return;\n        }\n\n        var self = this;\n        self.fetching = true;\n\n        api\n          .post(\"sites/\" + this.domainId + \"/backups\", { restore: item })\n          .then(function () {\n            self.fetchData();\n          })\n          .catch(function (error) {\n            console.log(error);\n            self.fetching = false;\n          });\n      });\n    },\n    handleError(error) {\n      this.error = error;\n    },\n    handleLoading(loading) {\n      this.fetching = loading;\n    },\n  },\n};\n</script>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Backups.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Backups.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Backups.vue?vue&type=template&id=08cc1308&\"\nimport script from \"./Backups.vue?vue&type=script&lang=js&\"\nexport * from \"./Backups.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","_v","_s","error","_e","loading","ref","staticClass","fetching","on","$event","createBackup","serverId","path","$refs","results","fetchData","handleError","data","items","length","_l","item","i","key","restore","name","stopPropagation","scopedSlots","_u","fn","date","_f","size","download","deleteBackup","proxy","staticRenderFns","components","Loading","Upload","domainId","post","domain","details","alias","dns","timer","progress","created","watch","$route","methods","clearTimeout","api","then","console","self","document","catch","finally","window","ids","handleLoading","component"],"sourceRoot":""}