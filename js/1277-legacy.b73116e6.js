"use strict";(self["webpackChunkServerWand"]=self["webpackChunkServerWand"]||[]).push([[1277],{84285:function(t,e,a){a.d(e,{Z:function(){return c}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{persistent:"",content:"","content-class":"centered-dialog"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[a("v-container",{attrs:{"fill-height":""}},[a("v-card",{attrs:{color:"primary",dark:""}},[a("v-card-text",[a("v-layout",{attrs:{row:""}},[a("i",{staticClass:"fas fa-magic fa-2x faa-horizontal animated"}),a("h2",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t.message))])])],1)],1)],1)],1)},s=[],n={name:"Loading",data:function(){return{}},props:{value:{type:Boolean,default:!1},message:{type:String,default:"Summoning..."}}},r=n,l=a(1001),o=(0,l.Z)(r,i,s,!1,null,null,null),c=o.exports},91277:function(t,e,a){a.r(e),a.d(e,{default:function(){return u}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.error?a("v-alert",{attrs:{type:"error"}},[t._v(" "+t._s(t.error)+" ")]):t._e(),a("Loading",{attrs:{value:t.loading}}),a("v-card",{staticClass:"pa-3",attrs:{loading:t.fetching}},[a("v-list",[a("v-list-item-group",[t._l(t.data.aliases,(function(e,i){return[a("v-list-item",{key:"item-"+i,attrs:{value:e},scopedSlots:t._u([{key:"default",fn:function(){return[a("v-list-item-content",[a("v-list-item-title",[t._v(" "+t._s(e.domain)+" ")]),a("v-list-item-subtitle",[e.redirect?a("span",[t._v(" Redirect ")]):a("span",[t._v(" Alias ")])])],1),e.dns.A!=t.data.server.ip?a("v-list-item-action",[a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(i){var s=i.on;return[a("v-btn",t._g({attrs:{icon:""},on:{click:function(a){return t.fixAliasDns(e.domain)}}},s),[a("v-icon",{attrs:{small:""}},[t._v("build")])],1)]}}],null,!0)},[a("span",[t._v("Fix DNS mismatch ("+t._s(e.dns.A)+" => "+t._s(t.data.server.ip)+")")])])],1):t._e(),a("v-list-item-action",[a("v-btn",{attrs:{icon:"",disabled:t.fetching,loading:t.fetching},on:{click:function(a){return t.deleteAlias(e.domain)}}},[a("v-icon",{attrs:{small:""}},[t._v("delete")])],1)],1)]},proxy:!0}],null,!0)})]}))],2)],1)],1),a("v-card",[a("div",[a("v-card-title",{attrs:{"primary-title":""}},[a("v-btn",{on:{click:function(e){return t.addAlias()}}},[t._v(" Add domain alias ")])],1)],1)]),a("v-navigation-drawer",{attrs:{temporary:"",right:"",app:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[a("v-card",[a("v-card-title",[t._v(" Domain alias ")]),a("v-card-text",[a("v-text-field",{attrs:{label:"Alias",required:""},model:{value:t.alias.alias,callback:function(e){t.$set(t.alias,"alias",e)},expression:"alias.alias"}}),a("v-checkbox",{attrs:{label:"Configure DNS",disabled:""==t.data.server.dns},model:{value:t.alias.dns,callback:function(e){t.$set(t.alias,"dns",e)},expression:"alias.dns"}}),a("v-checkbox",{attrs:{label:"Redirect"},model:{value:t.alias.redirect,callback:function(e){t.$set(t.alias,"redirect",e)},expression:"alias.redirect"}}),a("v-btn",{attrs:{disabled:t.fetching,loading:t.fetching,color:"success"},on:{click:t.submitAlias}},[t._v(" Save ")])],1)],1)],1)],1)},s=[],n=(a(41539),a(54747),a(4296)),r=a(84285),l={components:{Loading:r.Z},data:function(){return{siteId:null,post:null,error:null,data:{disk_usage:0,server:{},app:{}},details:"",loading:!1,fetching:!1,passwordPanel:[!1],passwordFormValid:!0,rules:{required:function(t){return!!t||"Required."},min:function(t){return t.length>=8||"Min 8 characters"},emailMatch:function(){return"The email and password you entered don't match"}},alias:{alias:"",redirect:!1,dns:!1},drawer:!1,timer:null}},created:function(){this.fetchData()},watch:{$route:"fetchData"},methods:{fetchData:function(){var t=this;this.error="",this.siteId=this.$route.params.id,clearTimeout(t.timer),this.fetching=!0,n.Z.get("sites/"+this.siteId+"/aliases").then((function(e){console.log(e),t.data=e.data.item,document.title="Aliases | "+t.data.domain,t.data.aliases.forEach((function(e){if(e.dns.updating)return console.log("checking dns"),void(t.timer=setTimeout(t.fetchData,6e4))}))})).catch((function(t){console.log(t)})).finally((function(){t.fetching=!1}))},addAlias:function(){this.alias={},this.drawer=!0},submitAlias:function(){this.saveAlias()},saveAlias:function(t){var e,a=this;this.alias.alias&&(this.details="",this.fetching=!0,this.error="",!t&&this.alias.dns&&(e=window.open("/loading")),console.log(this.alias),n.Z.post("sites/"+this.siteId+"/aliases",this.alias).then((function(i){if(console.log(i),i.data.success)e&&e.close(),a.drawer=!1,a.fetchData();else if("auth"!=i.data.error||t)a.error=i.data.error;else{e.location="https://serverwand.com/account/services/"+a.data.server.dns;var s=setInterval((function(){if(e.closed)return clearInterval(s),void a.saveAlias(!0)}),500)}})).catch((function(t){console.log(t),a.fetching=!1})).finally((function(){a.fetching=!1})))},deleteAlias:function(t){var e=this;this.$confirm("Delete "+t+"?").then((function(a){if(a){var i=e;e.fetching=!0,e.error="",n.Z.post("sites/"+e.siteId+"/aliases",{delete:1,alias:t}).then((function(t){console.log(t),t.data.success?i.fetchData():i.error=t.data.error})).catch((function(t){console.log(t),i.fetching=!1}))}}))},fixAliasDns:function(t,e){var a=this;this.details="",this.fetching=!0,this.error="",n.Z.post("sites/"+a.siteId+"/fixaliasdns",{alias:t}).then((function(i){if(console.log(i),i.data.success)a.fetchData();else if("auth"!=i.data.error||e)a.error=i.data.error;else var s=window.open("https://serverwand.com/account/services/"+a.data.server.dns),n=setInterval((function(){if(s.closed)return clearInterval(n),void a.fixAliasDns(t,!0)}),500)})).catch((function(t){console.log(t),a.fetching=!1})).finally((function(){a.fetching=!1}))}}},o=l,c=a(1001),d=(0,c.Z)(o,i,s,!1,null,null,null),u=d.exports}}]);
//# sourceMappingURL=1277-legacy.b73116e6.js.map