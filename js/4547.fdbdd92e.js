"use strict";(self["webpackChunkServerWand"]=self["webpackChunkServerWand"]||[]).push([[4547],{60173:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var n=a(66252),r=a(3577),i=a(49963);function o(e,t,a,o,s,l){const d=(0,n.up)("v-alert"),c=(0,n.up)("Loading"),u=(0,n.up)("v-icon"),f=(0,n.up)("v-btn"),h=(0,n.up)("v-col"),p=(0,n.up)("Upload"),m=(0,n.up)("v-row"),g=(0,n.up)("v-container"),w=(0,n.up)("v-list-item"),v=(0,n.up)("v-list"),k=(0,n.up)("v-card-text"),b=(0,n.up)("v-card"),y=(0,n.up)("Confirm");return(0,n.wg)(),(0,n.iD)("div",null,[s.error?((0,n.wg)(),(0,n.j4)(d,{key:0,type:"error"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,r.zw)(s.error),1)])),_:1})):(0,n.kq)("",!0),(0,n.Wm)(c,{value:s.loading},null,8,["value"]),(0,n.Wm)(b,{class:"pa-3",loading:s.fetching,ref:"results"},{default:(0,n.w5)((()=>[(0,n.Wm)(g,{fluid:""},{default:(0,n.w5)((()=>[(0,n.Wm)(m,null,{default:(0,n.w5)((()=>[(0,n.Wm)(h,{class:"flex-grow-0"},{default:(0,n.w5)((()=>[(0,n.Wm)(f,{title:"Create backup",ref:"uploadFolderButton",onClick:t[0]||(t[0]=e=>l.createBackup())},{default:(0,n.w5)((()=>[(0,n.Wm)(u,null,{default:(0,n.w5)((()=>[(0,n.Uk)("mdi:mdi-plus")])),_:1})])),_:1},512)])),_:1}),(0,n.Wm)(p,{serverId:s.serverId,path:s.path,dropZone:e.$refs.results,onComplete:t[1]||(t[1]=e=>l.fetchData()),onError:l.handleError},null,8,["serverId","path","dropZone","onError"])])),_:1})])),_:1}),s.data.items.length>0?((0,n.wg)(),(0,n.j4)(v,{key:0},{default:(0,n.w5)((()=>[(0,n.Wm)(v,{group:"","max-width":"600"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.data.items,((e,a)=>((0,n.wg)(),(0,n.j4)(w,{key:`item-${a}`,title:e.name,subtitle:e.date+" - "+l.prettyBytes(e.size),onClick:t=>l.restore(e)},{append:(0,n.w5)((()=>[(0,n.Wm)(f,{icon:"",disabled:s.fetching,loading:s.fetching,onClick:[t=>l.deleteItem(e),t[2]||(t[2]=(0,i.iM)((()=>{}),["stop"]))]},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{size:"small"},{default:(0,n.w5)((()=>[(0,n.Uk)("mdi:mdi-delete")])),_:1})])),_:2},1032,["disabled","loading","onClick"])])),_:2},1032,["title","subtitle","onClick"])))),128))])),_:1})])),_:1})):((0,n.wg)(),(0,n.j4)(k,{key:1},{default:(0,n.w5)((()=>[(0,n.Uk)(" Empty ")])),_:1}))])),_:1},8,["loading"]),(0,n.Wm)(y,{ref:"confirm"},null,512)])}var s=a(1006),l=a(48236),d=a(98686),c=a(90947),u=a(72564),f={components:{Loading:l.Z,Upload:d.Z,Confirm:c.Z},data(){return{path:"/",domainId:null,post:null,error:null,data:{domain:"",items:[]},loading:!1,details:"",loading:!1,fetching:!1,alias:{domain:"",dns:!1},timer:null,serverId:0,progress:0}},created(){this.fetchData()},watch:{$route:"fetchData"},methods:{fetchData(){var e=this;this.error="",this.domainId=this.$route.params.id,clearTimeout(e.timer),this.fetching=!0,this.progress=0,s.Z.get("sites/"+this.domainId+"/backups").then((function(t){if(console.log(t),t.data.error)return e.error=t.data.error,!1;e.data=t.data,document.title="Backups | "+e.data.domain,e.serverId=e.data.server.id,e.path="/var/www/vhosts/"+e.data.server.ip+"/public/backups"})).catch((function(e){console.log(e)})).finally((function(){e.fetching=!1}))},createBackup(){var e=this;this.fetching=!0,this.error="",s.Z.get("sites/"+this.domainId+"/backups/create").then((function(t){console.log(t),t.data.success?e.fetchData():e.error=t.data.error})).catch((function(e){console.log(e)})).finally((function(){e.fetching=!1}))},download(e){console.log("https://"+this.data.server.ip+"/backups/"+e.name),window.open("https://"+this.data.server.ip+"/backups/"+e.name)},deleteItem:async function(e){if(await this.$refs.confirm.open("Confirm","Delete "+e.name)){var t=this;t.fetching=!0,s.Z.post("sites/"+this.domainId+"/backups",{ids:[e.name]}).then((function(){t.fetchData()})).catch((function(e){console.log(e),t.fetching=!1}))}},restore:async function(e){if(await this.$refs.confirm.open("Confirm","Restore "+e.name)){var t=this;t.fetching=!0,s.Z.post("sites/"+this.domainId+"/backups",{restore:e.name}).then((function(){t.fetchData()})).catch((function(e){console.log(e),t.fetching=!1}))}},handleError(e){this.error=e},handleLoading(e){this.fetching=e},prettyBytes(e){return u.Z.prettyBytes(e)}}},h=a(48118);const p=(0,h.Z)(f,[["render",o]]);var m=p}}]);
//# sourceMappingURL=4547.fdbdd92e.js.map