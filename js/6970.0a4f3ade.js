"use strict";(self["webpackChunkServerWand"]=self["webpackChunkServerWand"]||[]).push([[6970],{64990:function(t,e,a){a.r(e),a.d(e,{default:function(){return p}});var n=a(66252),i=a(49963);function o(t,e,a,o,r,s){const l=(0,n.up)("v-alert"),d=(0,n.up)("Loading"),c=(0,n.up)("v-btn"),u=(0,n.up)("Upload"),h=(0,n.up)("v-card-actions"),f=(0,n.up)("v-icon"),p=(0,n.up)("v-list-item"),m=(0,n.up)("v-list"),g=(0,n.up)("v-card-text"),v=(0,n.up)("v-card"),k=(0,n.up)("Confirm");return(0,n.wg)(),(0,n.iD)("div",null,[r.error?((0,n.wg)(),(0,n.j4)(l,{key:0,type:"error",text:r.error},null,8,["text"])):(0,n.kq)("",!0),(0,n.Wm)(d,{value:r.loading},null,8,["value"]),(0,n.Wm)(v,{loading:r.fetching,ref:"results"},{default:(0,n.w5)((()=>[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(c,{title:"Create backup",ref:"uploadFolderButton",onClick:e[0]||(e[0]=t=>s.createBackup()),icon:"mdi:mdi-plus"},null,512),(0,n.Wm)(u,{serverId:r.serverId,path:r.path,dropZone:t.$refs.results,onComplete:e[1]||(e[1]=t=>s.fetchData()),onError:s.handleError},null,8,["serverId","path","dropZone","onError"])])),_:1}),(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[r.data.items.length>0?((0,n.wg)(),(0,n.j4)(m,{key:0,"max-width":"600"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.data.items,((t,e)=>((0,n.wg)(),(0,n.j4)(p,{key:`item-${e}`,title:t.name,subtitle:t.date+" - "+s.prettyBytes(t.size),onClick:e=>s.restore(t)},{append:(0,n.w5)((()=>[(0,n.Wm)(c,{icon:"",disabled:r.fetching,onClick:(0,i.iM)((e=>s.download(t)),["stop"])},{default:(0,n.w5)((()=>[(0,n.Wm)(f,{size:"small"},{default:(0,n.w5)((()=>[(0,n.Uk)("mdi:mdi-download")])),_:1})])),_:2},1032,["disabled","onClick"]),(0,n.Wm)(c,{icon:"",disabled:r.fetching,loading:r.loading===t.name,onClick:(0,i.iM)((e=>s.deleteItem(t)),["stop"])},{default:(0,n.w5)((()=>[(0,n.Wm)(f,{size:"small"},{default:(0,n.w5)((()=>[(0,n.Uk)("mdi:mdi-delete")])),_:1})])),_:2},1032,["disabled","loading","onClick"])])),_:2},1032,["title","subtitle","onClick"])))),128))])),_:1})):(0,n.kq)("",!0)])),_:1})])),_:1},8,["loading"]),(0,n.Wm)(k,{ref:"confirm"},null,512)])}var r=a(1006),s=a(11297),l=a(98048),d=a(64574),c=a(72564),u={components:{Loading:s.Z,Upload:l.Z,Confirm:d.Z},data(){return{path:"/",domainId:null,post:null,error:null,data:{domain:"",items:[]},loading:!1,details:"",fetching:!1,loading:null,alias:{domain:"",dns:!1},serverId:0,progress:0}},created(){this.fetchData()},watch:{$route:"fetchData"},methods:{fetchData(){var t=this;this.error="",this.domainId=this.$route.params.id,this.fetching=!0,this.progress=0,r.Z.get("sites/"+this.domainId+"/backups").then((function(e){if(console.log(e),e.data.error)return t.error=e.data.error,!1;t.data=e.data,document.title="Backups | "+t.data.domain,t.serverId=t.data.server.id,t.path="/var/www/vhosts/"+t.data.server.ip+"/public/backups"})).catch((function(t){console.log(t)})).finally((function(){t.fetching=!1}))},createBackup(){var t=this;this.fetching=!0,this.error="",r.Z.get("sites/"+this.domainId+"/backups/create").then((function(e){console.log(e),e.data.success?t.fetchData():t.error=e.data.error})).catch((function(t){console.log(t)})).finally((function(){t.fetching=!1}))},download(t){console.log("https://"+this.data.server.ip+"/backups/"+t.name),window.open("https://"+this.data.server.ip+"/backups/"+t.name)},deleteItem:async function(t){if(await this.$refs.confirm.open("Delete "+t.name)){var e=this;this.fetching=!0,this.loading=t.name,r.Z.post("sites/"+this.domainId+"/backups",{ids:[t.name]}).then((function(){e.fetchData()})).catch((function(t){console.log(t),e.fetching=!1})).finally((function(){e.loading=null}))}},restore:async function(t){if(await this.$refs.confirm.open("Restore "+t.name)){var e=this;e.fetching=!0,r.Z.post("sites/"+this.domainId+"/backups",{restore:t.name}).then((function(){e.fetchData()})).catch((function(t){console.log(t),e.fetching=!1}))}},handleError(t){this.error=t},handleLoading(t){this.fetching=t},prettyBytes(t){return c.Z.prettyBytes(t)}}},h=a(83744);const f=(0,h.Z)(u,[["render",o]]);var p=f}}]);
//# sourceMappingURL=6970.0a4f3ade.js.map