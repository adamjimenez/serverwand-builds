"use strict";(self["webpackChunkServerWand"]=self["webpackChunkServerWand"]||[]).push([[581],{37428:function(t,e,s){s.d(e,{Z:function(){return l}});var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{ref:"container"},[t.text?s("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on;return[s("span",t._g({on:{click:function(e){return t.copy(t.val)},mouseleave:function(e){return t.resetCopyText()}}},r),[t._v(" "+t._s(t.val)+" ")])]}}],null,!1,276876146)},[s("span",[t._v(t._s(t.copyText))])]):s("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on;return[s("v-btn",t._g({attrs:{icon:""},on:{click:function(e){return t.copy(t.val)},mouseleave:function(e){return t.resetCopyText()}}},r),[s("v-icon",{attrs:{small:""}},[t._v("file_copy")])],1)]}}])},[s("span",[t._v(t._s(t.copyText))])])],1)},n=[],a={props:{val:null,text:Boolean},data:function(){return{copyText:"Copy"}},methods:{copy:function(t){var e=document.createElement("textarea");this.$refs["container"].appendChild(e),e.setAttribute("id","clipboard"),e.value=t,e.select(),document.execCommand("Copy"),e.parentNode.removeChild(e),this.copyText="Copied"},resetCopyText:function(){var t=this;setTimeout((function(){return t.copyText="Copy"}),500)}}},o=a,i=s(1001),c=(0,i.Z)(o,r,n,!1,null,null,null),l=c.exports},84285:function(t,e,s){s.d(e,{Z:function(){return l}});var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-dialog",{attrs:{persistent:"",content:"","content-class":"centered-dialog"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[s("v-container",{attrs:{"fill-height":""}},[s("v-card",{attrs:{color:"primary",dark:""}},[s("v-card-text",[s("v-layout",{attrs:{row:""}},[s("i",{staticClass:"fas fa-magic fa-2x faa-horizontal animated"}),s("h2",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t.message))])])],1)],1)],1)],1)},n=[],a={name:"Loading",data:function(){return{}},props:{value:{type:Boolean,default:!1},message:{type:String,default:"Summoning..."}}},o=a,i=s(1001),c=(0,i.Z)(o,r,n,!1,null,null,null),l=c.exports},10581:function(t,e,s){s.r(e),s.d(e,{default:function(){return S}});var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.error?s("v-alert",{attrs:{type:"error"}},[t._v(" "+t._s(t.error)+" ")]):t._e(),s("Loading",{attrs:{value:t.loading}}),s("v-card",{staticClass:"pa-3",attrs:{loading:t.fetching}},[s("TogglePasswordAuthentication",{attrs:{serverId:t.serverId,passwordAuthentication:t.data.password_authentication}}),s("v-list",[s("v-list-item-group",[t._l(t.data.users,(function(e,r){return[s("v-list-item",{key:"item-"+r,attrs:{value:e},on:{click:function(s){return t.editItem(e)}},scopedSlots:t._u([{key:"default",fn:function(){return[s("v-list-item-content",[s("v-list-item-title",[t._v(" "+t._s(e.name)+" "),e.sudo?s("v-icon",{attrs:{"x-small":"",right:""}},[t._v("fas fa-crown")]):t._e()],1)],1),s("v-list-item-action",[s("v-btn",{attrs:{icon:"",disabled:t.loading,loading:t.loading,title:"Authorized keys"},on:{click:[function(s){return t.openKeys(e)},function(t){t.stopPropagation()}]}},[s("v-icon",{attrs:{small:""}},[t._v("vpn_key")])],1)],1),s("v-list-item-action",[s("v-btn",{attrs:{icon:"",disabled:t.loading,loading:t.loading},on:{click:[function(s){return t.deleteItem(e.name)},function(t){t.stopPropagation()}]}},[s("v-icon",{attrs:{small:""}},[t._v("delete")])],1)],1)]},proxy:!0}],null,!0)})]}))],2)],1),s("v-container",{staticClass:"mt-5",attrs:{fluid:""}},[s("v-row",[s("v-btn",{staticClass:"mr-3",on:{click:function(e){return t.addItem()}}},[t._v(" Add system user ")]),s("ClearSSHUser",{attrs:{serverId:t.serverId,server:t.data}})],1)],1)],1),s("v-navigation-drawer",{attrs:{app:"",temporary:"",right:""},model:{value:t.userDrawer,callback:function(e){t.userDrawer=e},expression:"userDrawer"}},[s("v-card",[s("v-card-title",[t._v(" System user ")]),s("v-card-text",[s("v-text-field",{attrs:{label:"User",required:""},model:{value:t.system_user.name,callback:function(e){t.$set(t.system_user,"name",e)},expression:"system_user.name"}}),s("v-text-field",{attrs:{type:"password",label:"Password",required:"",autocomplete:"new-password"},model:{value:t.system_user.password,callback:function(e){t.$set(t.system_user,"password",e)},expression:"system_user.password"}}),s("v-switch",{attrs:{label:"sudo"},model:{value:t.system_user.sudo,callback:function(e){t.$set(t.system_user,"sudo",e)},expression:"system_user.sudo"}}),s("v-switch",{attrs:{disabled:!t.system_user.sudo,label:"sudo without password"},model:{value:t.system_user.sudo_without_password,callback:function(e){t.$set(t.system_user,"sudo_without_password",e)},expression:"system_user.sudo_without_password"}}),s("v-btn",{attrs:{disabled:t.fetching,loading:t.loading,color:"success"},on:{click:t.saveUser}},[t._v(" Save ")])],1)],1)],1),s("v-navigation-drawer",{attrs:{app:"",temporary:"",right:""},model:{value:t.keyDrawer,callback:function(e){t.keyDrawer=e},expression:"keyDrawer"}},[s("v-card",[s("v-card-title",[t._v(" Add key for "+t._s(t.user.name)+" ")]),s("v-card-text",[s("v-text-field",{attrs:{label:"key"},model:{value:t.key,callback:function(e){t.key=e},expression:"key"}}),s("v-btn",{attrs:{disabled:t.fetching,loading:t.loading,color:"success"},on:{click:t.saveKey}},[t._v(" Save ")])],1)],1)],1),s("v-dialog",{model:{value:t.showKeys,callback:function(e){t.showKeys=e},expression:"showKeys"}},[s("v-card",{attrs:{loading:t.fetching}},[s("v-card-title",[t._v(" Keys for "+t._s(t.user.name)+" ")]),s("v-card-text",[s("div",[t._v("Public SSH key")]),s("v-list",[s("v-list-item-group",[s("v-list-item",[s("v-list-item-content",[s("v-list-item-subtitle",[t._v(" "+t._s(t.user.key)+" ")])],1),s("v-list-item-action",[s("v-btn",{attrs:{icon:"",disabled:t.fetching,loading:t.fetching}},[s("Copy",{attrs:{val:t.user.key}})],1)],1)],1)],1)],1),s("div",[t._v("Authorized keys")]),t.fetching?t._e():s("v-list",[s("v-list-item-group",[t._l(t.keys,(function(e,r){return[s("v-list-item",{key:"item-"+r,attrs:{value:e},scopedSlots:t._u([{key:"default",fn:function(){return[s("v-list-item-content",[s("v-list-item-title",[t._v(" "+t._s(e.name)+" ")]),s("v-list-item-subtitle",[t._v(" "+t._s(e.key)+" ")])],1),s("v-list-item-action",[s("v-btn",{attrs:{icon:"",disabled:t.fetching,loading:t.fetching}},[s("Copy",{attrs:{val:e.key}})],1),s("v-btn",{attrs:{icon:"",disabled:t.fetching,loading:t.fetching},on:{click:[function(s){return t.deleteKey(e.line)},function(t){t.stopPropagation()}]}},[s("v-icon",{attrs:{small:""}},[t._v("delete")])],1)],1)]},proxy:!0}],null,!0)})]}))],2)],1)],1),t.keys.length?t._e():s("v-card-text",[t._v(" No keys ")])],1),s("v-card",[s("div",[s("v-card-title",{attrs:{"primary-title":""}},[s("v-btn",{on:{click:function(e){return t.addKey()}}},[t._v(" Add Key ")])],1)],1)])],1)],1)},n=[],a=(s(41539),s(68309),s(33948),s(4296)),o=s(84285),i=s(37428),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("v-container",{attrs:{fluid:""}},[s("v-row",[s("v-switch",{staticClass:"mx-3",attrs:{label:"Password Authentication"},on:{change:function(e){return t.togglePasswordAuthentication()}},model:{value:t.data.passwordAuthentication,callback:function(e){t.$set(t.data,"passwordAuthentication",e)},expression:"data.passwordAuthentication"}}),s("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,n=e.attrs;return[s("v-icon",t._g(t._b({attrs:{color:"primary"}},"v-icon",n,!1),r),[t._v(" mdi-information ")])]}}])},[s("span",[t._v(" Allow password authentication. We recommend this is disabled in favour of key authentication.")])])],1)],1)],1)},l=[],u={props:{serverId:null,passwordAuthentication:null},watch:{passwordAuthentication:function(t){this.data.passwordAuthentication=t}},data:function(){return{fetching:!1,data:{passwordAuthentication:!1}}},created:function(){this.data.passwordAuthentication=this.passwordAuthentication},methods:{togglePasswordAuthentication:function(){var t=this;this.error="",this.fetching=!0,this.loading=!0,a.Z.post("servers/"+this.serverId+"/password_authentication",{save:1,enable:this.data.passwordAuthentication}).then((function(e){console.log(e),e.data.error?t.error=e.data.error:e.data.success&&t.$emit("complete")})).catch((function(t){console.log(t)})).finally((function(){t.fetching=!1,t.loading=!1}))}}},d=u,v=s(1001),f=(0,v.Z)(d,c,l,!1,null,null,null),h=f.exports,m=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-btn",{attrs:{disabled:t.fetching,loading:t.fetching},on:{click:t.clearSSHUser}},[t._v(" Clear SSH user ")])},p=[],y={props:{serverId:null},data:function(){return{fetching:!1}},methods:{clearSSHUser:function(){var t=this;this.$confirm("Clear the default SSH user used for terminal access?").then((function(e){if(e){var s=t;s.fetching=!0,a.Z.post("servers/"+t.serverId+"/savesshuser",{ssh_username:""}).then((function(t){console.log(t),t.data.success?s.$emit("complete"):s.error=t.data.error})).catch((function(t){return console.log(t)})).finally((function(){return s.fetching=!1}))}}))}}},g=y,_=(0,v.Z)(g,m,p,!1,null,null,null),w=_.exports,k={components:{Loading:o.Z,Copy:i.Z,TogglePasswordAuthentication:h,ClearSSHUser:w},data:function(){return{error:"",data:{users:{}},system_user:{user:"",password:"",key:"",sudo:!1,sudo_without_password:!1},details:"",loading:!1,fetching:!1,userDrawer:!1,keyDrawer:!1,serverId:0,user:"",showKeys:!1,keys:[],key:""}},created:function(){this.serverId=this.$route.params.id,this.fetchData()},methods:{fetchData:function(){var t=this;this.error="",this.fetching=!0,a.Z.get("servers/"+this.serverId+"/systemusers?detailed=1").then((function(e){if(console.log(e),e.data.error)return t.error=e.data.error,!1;t.data=e.data.item,document.title="System users | "+t.data.name})).catch((function(t){console.log(t)})).finally((function(){t.fetching=!1}))},addItem:function(){this.system_user.name="",this.system_user.password="",this.system_user.key="",this.system_user.sudo=!1,this.userDrawer=!0},editItem:function(t){this.system_user=t,this.userDrawer=!0},deleteItem:function(t){var e=this;return this.$confirm("Delete "+t+"?").then((function(s){if(s){var r=e;e.fetching=!0,e.error="",a.Z.post("servers/"+e.serverId+"/systemusers",{user:t}).then((function(t){console.log(t),t.data.success?r.fetchData():(r.error=t.data.error,r.fetching=!1)})).catch((function(t){console.log(t),r.fetching=!1}))}})),!1},saveUser:function(){var t=this;this.system_user.name&&(this.details="",this.fetching=!0,this.error="",a.Z.post("servers/"+this.serverId+"/systemusers",this.system_user).then((function(e){console.log(e),e.data.success?(t.userDrawer=!1,t.fetchData()):(t.error=e.data.error,t.fetching=!1)})).catch((function(e){console.log(e),t.fetching=!1})))},openKeys:function(t){var e=this;this.user=t,this.showKeys=!0,this.fetching=!0,a.Z.get("servers/"+this.serverId+"/systemusers/"+this.user.name).then((function(t){console.log(t),e.keys=t.data.keys,e.fetching=!1})).catch((function(t){console.log(t),e.fetching=!1}))},deleteKey:function(t){var e=this;this.$confirm("Delete key?").then((function(s){if(s){var r=e;e.fetching=!0,e.error="",a.Z.post("servers/"+e.serverId+"/systemusers/"+e.user.name,{line:t}).then((function(t){console.log(t),t.data.success?r.openKeys(r.user):(r.fetching=!1,r.error=t.data.error)})).catch((function(t){r.fetching=!1,console.log(t)}))}}))},addKey:function(){this.showKeys=!1,this.keyDrawer=!0},saveKey:function(){var t=this;this.fetching=!0,this.error="",a.Z.post("servers/"+this.serverId+"/systemusers/"+this.user.name,{key:t.key}).then((function(e){console.log(e),e.data.success?(t.keyDrawer=!0,t.openKeys(t.user)):(t.fetching=!1,t.error=e.data.error)})).catch((function(e){t.fetching=!1,console.log(e)}))}}},b=k,x=(0,v.Z)(b,r,n,!1,null,null,null),S=x.exports}}]);
//# sourceMappingURL=581-legacy.a041581d.js.map