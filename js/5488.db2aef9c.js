"use strict";(self["webpackChunkServerWand"]=self["webpackChunkServerWand"]||[]).push([[5488],{15488:function(e,t,r){r.r(t),r.d(t,{default:function(){return f}});var a=r(66252),l=r(3577);const n=["innerHTML"],o=["innerHTML"];function i(e,t,r,i,s,u){const d=(0,a.up)("v-alert"),c=(0,a.up)("EditFile"),h=(0,a.up)("v-select"),f=(0,a.up)("v-col"),g=(0,a.up)("v-text-field"),v=(0,a.up)("v-btn"),p=(0,a.up)("v-row"),m=(0,a.up)("v-card-title"),w=(0,a.up)("v-card-text"),L=(0,a.up)("v-card");return(0,a.wg)(),(0,a.iD)("div",null,[s.error?((0,a.wg)(),(0,a.j4)(d,{key:0,type:"error",text:s.error},null,8,["text"])):(0,a.kq)("",!0),(0,a.Wm)(c,{ref:"editFile",serverId:s.serverId,action:"files",onComplete:t[0]||(t[0]=e=>u.fetchLog()),onError:u.handleError,onLoading:u.handleLoading},null,8,["serverId","onError","onLoading"]),(0,a.Wm)(L,{loading:s.fetching},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{"primary-title":""},{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(h,{items:s.logs,label:"Log","onUpdate:modelValue":u.fetchLog,"hide-details":""},null,8,["items","onUpdate:modelValue"])])),_:1}),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{label:"Filter",modelValue:s.filter,"onUpdate:modelValue":t[1]||(t[1]=e=>s.filter=e),"hide-details":""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(f,{cols:"1"},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{onClick:t[2]||(t[2]=e=>u.fetchLog()),disabled:!s.log,icon:""},{default:(0,a.w5)((()=>[(0,a._)("i",{class:(0,l.C_)(["fas fa-redo-alt",s.fetching?"fa-spin":""])},null,2)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1}),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>["serverstatus"==s.log?((0,a.wg)(),(0,a.iD)("div",{key:0,innerHTML:s.logContent,class:"serverstatus"},null,8,n)):((0,a.wg)(),(0,a.iD)("div",{key:1,class:"pre",innerHTML:u.filteredLog},null,8,o))])),_:1})])),_:1},8,["loading"])])}var s=r(1006),u=r(52406),d={components:{EditFile:u.Z},data(){return{error:"",data:{users:{}},system_user:{user:"",password:""},cronjob:{name:"",user:"",command:"",minute:"",hour:"",dom:"",mon:"",dow:""},cronjobs:[],rules:{required:e=>!!e||"Required.",alpha:e=>/^[a-zA-Z]+$/g.test(e)||"Must contain a-z characters only",minute:e=>"*"==e||e>=0&&e<60||"0-59 or *",hour:e=>"*"==e||e>=0&&e<24||"0-23 or *",dom:e=>"*"==e||e>=1&&e<=31||"1-31 or *",mon:e=>"*"==e||e>=1&&e<12||"1-12 or *",dow:e=>"*"==e||e>=1&&e<7||"1-7 or *"},details:"",fetching:!0,userDrawer:!1,cronjobDrawer:!1,serverId:0,logs:[{value:"journal",title:"Journal"},{value:"auth",title:"Auth"},{value:"apache_access",title:"Apache Access"},{value:"other_vhosts",title:"Other Vhosts"},{value:"apache_error",title:"Apache Error"},{value:"mail",title:"Mail"},{value:"mysql",title:"MySQL"},{value:"fail2ban",title:"Fail2ban"},{value:"letsencrypt",title:"Let's Encrypt"},{value:"serverstatus",title:"Server Status"}],log:"",logContent:"",filter:""}},created(){this.serverId=this.$route.params.id,this.fetchData();var e=this;window.onhashchange=async function(){var t=location.hash.substr(1);if(t){var r=t,a=1;if(-1!==r.indexOf(":")){var l=r.split(":");r=l[0],a=l[1]}e.fecthing=!0,await e.$refs.editFile.open({id:r,name:r}),e.$refs.editFile.goToLine(a),location.hash=""}}},computed:{filteredLog:function(){const e=/(\/(var|etc)[^\s:\\']+( on line [0-9]+))/g;var t=this.logContent.split("\n");return t.filter((e=>e.toLowerCase().includes(this.filter.toLowerCase()))).join("\n").replace(e,'<a href="'+location.pathname+'#$1">$1</a>').replace(/( on line )([0-9]+)/g,":$2").replace(/(PHP Fatal error)/g,'<span class="error">$1</span>').replace(/(PHP Parse error)/g,'<span class="error">$1</span>').replace(/(PHP Warning)/g,'<span class="warning">$1</span>')}},methods:{fetchData(){var e=this;this.error="",this.fetching=!0,s.Z.get("servers/"+this.serverId).then((function(t){if(console.log(t),t.data.error)return e.error=t.data.error,!1;e.data=t.data.item,document.title="Logs | "+e.data.name})).catch((function(e){console.log(e)})).finally((function(){e.fetching=!1}))},fetchLog(e){var t=this;if(this.fetching=!0,e)t.log=e;else if(!t.log)return;this.logContent="loading..",s.Z.post("servers/"+this.serverId+"/fetchlog",{log:t.log}).then((function(e){console.log(e),t.logContent=e.data.content})).finally((function(){t.fetching=!1}))},handleError(e){this.error=e},handleLoading(e){this.fetching=e}}},c=r(48118);const h=(0,c.Z)(d,[["render",i]]);var f=h}}]);
//# sourceMappingURL=5488.db2aef9c.js.map