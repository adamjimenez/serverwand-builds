"use strict";(self["webpackChunkServerWand"]=self["webpackChunkServerWand"]||[]).push([[4266],{44569:function(e,t,l){l.r(t),l.d(t,{default:function(){return re}});var a=l(66252),d=l(3577),o=l(49963);function r(e,t,l,r,n,s){const i=(0,a.up)("v-alert"),u=(0,a.up)("Loading"),c=(0,a.up)("EditFile"),h=(0,a.up)("NewFile"),m=(0,a.up)("v-col"),p=(0,a.up)("NewFolder"),f=(0,a.up)("Upload"),v=(0,a.up)("Rename"),w=(0,a.up)("DeleteFiles"),g=(0,a.up)("Chmod"),W=(0,a.up)("Chown"),k=(0,a.up)("Extract"),_=(0,a.up)("Download"),b=(0,a.up)("Clipboard"),C=(0,a.up)("v-row"),V=(0,a.up)("v-container"),I=(0,a.up)("v-icon"),y=(0,a.up)("v-btn"),E=(0,a.up)("v-text-field"),U=(0,a.up)("v-data-table"),x=(0,a.up)("v-card");return(0,a.wg)(),(0,a.iD)("div",null,[n.error?((0,a.wg)(),(0,a.j4)(i,{key:0,type:"error"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,d.zw)(n.error),1)])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(u,{value:n.loading},null,8,["value"]),(0,a.Wm)(c,{ref:"editFile",serverId:n.serverId,action:"files",onComplete:t[0]||(t[0]=e=>s.fetchData()),onError:s.handleError,onLoading:s.handleLoading},null,8,["serverId","onError","onLoading"]),(0,a.Wm)(x,{loading:n.fetching},{default:(0,a.w5)((()=>[(0,a.Wm)(V,{fluid:""},{default:(0,a.w5)((()=>[(0,a.Wm)(C,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"flex-grow-0"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{serverId:n.serverId,path:n.path,onComplete:t[1]||(t[1]=e=>s.fetchData()),onError:s.handleError},null,8,["serverId","path","onError"])])),_:1}),(0,a.Wm)(m,{class:"flex-grow-0"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{serverId:n.serverId,path:n.path,onComplete:t[2]||(t[2]=e=>s.fetchData()),onError:s.handleError},null,8,["serverId","path","onError"])])),_:1}),(0,a.Wm)(f,{serverId:n.serverId,path:n.path,dropZone:e.$refs.results,onComplete:t[3]||(t[3]=e=>s.fetchData()),onError:s.handleError,folder:"folder"},null,8,["serverId","path","dropZone","onError"]),1===s.selected.length?((0,a.wg)(),(0,a.j4)(m,{key:0,class:"flex-grow-0"},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{serverId:n.serverId,path:n.path,selected:s.selected,onComplete:t[4]||(t[4]=e=>s.fetchData()),onError:s.handleError},null,8,["serverId","path","selected","onError"])])),_:1})):(0,a.kq)("",!0),s.selected.length?((0,a.wg)(),(0,a.j4)(m,{key:1,class:"flex-grow-0"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{serverId:n.serverId,path:n.path,selected:s.selected,onComplete:t[5]||(t[5]=e=>s.fetchData()),onError:s.handleError},null,8,["serverId","path","selected","onError"])])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(m,{class:"flex-grow-0"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{serverId:n.serverId,path:n.path,selected:s.selected,folderSelected:n.folderSelected,onComplete:t[6]||(t[6]=e=>s.fetchData()),onError:s.handleError},null,8,["serverId","path","selected","folderSelected","onError"])])),_:1}),(0,a.Wm)(m,{class:"flex-grow-0"},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{serverId:n.serverId,path:n.path,selected:s.selected,folderSelected:n.folderSelected,onComplete:t[7]||(t[7]=e=>s.fetchData()),onError:s.handleError},null,8,["serverId","path","selected","folderSelected","onError"])])),_:1}),(0,a.Wm)(k,{serverId:n.serverId,path:n.path,selected:s.selected,onComplete:s.fetchData,onError:s.handleError,onLoading:s.handleLoading},null,8,["serverId","path","selected","onComplete","onError","onLoading"]),1===s.selected.length&&"file"===s.selected[0].type?((0,a.wg)(),(0,a.j4)(m,{key:2,class:"flex-grow-0"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{serverId:n.serverId,path:n.path,selected:s.selected},null,8,["serverId","path","selected"])])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(b,{serverId:n.serverId,path:n.path,selected:s.selected,onComplete:t[8]||(t[8]=e=>s.fetchData()),onError:s.handleError},null,8,["serverId","path","selected","onError"])])),_:1})])),_:1}),(0,a.Wm)(V,{fluid:""},{default:(0,a.w5)((()=>[(0,a.Wm)(C,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"flex-grow-0"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{icon:"",onClick:t[9]||(t[9]=e=>s.upLevel()),disabled:"/"===n.path,title:"Up one level"},{default:(0,a.w5)((()=>[(0,a.Wm)(I,{small:""},{default:(0,a.w5)((()=>[(0,a.Uk)("mdi:mdi-arrow-up")])),_:1})])),_:1},8,["disabled"])])),_:1}),(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(E,{modelValue:n.path,"onUpdate:modelValue":t[10]||(t[10]=e=>n.path=e),class:"ma-0 pa-0",onChange:s.fetchData,onKeydown:(0,o.D2)(s.fetchData,["enter"])},null,8,["modelValue","onChange","onKeydown"])])),_:1}),(0,a.Wm)(m,{cols:"2"},{default:(0,a.w5)((()=>[(0,a.Wm)(E,{placeholder:"Search","prepend-inner-icon":"search",modelValue:n.search,"onUpdate:modelValue":t[11]||(t[11]=e=>n.search=e),class:"ma-0 pa-0",onChange:s.fetchData,onKeydown:(0,o.D2)(s.fetchData,["enter"])},null,8,["modelValue","onChange","onKeydown"])])),_:1})])),_:1})])),_:1}),(0,a.Wm)(U,{modelValue:n.selectedIds,"onUpdate:modelValue":t[12]||(t[12]=e=>n.selectedIds=e),headers:n.headers,items:n.items,class:"results",ref:"results","show-select":"","mobile-breakpoint":"0","onClick:row":t[13]||(t[13]=function(e,t){s.open(t.item.raw)})},{"item.size":(0,a.w5)((({item:e})=>[(0,a.Uk)((0,d.zw)(s.prettyBytes(e.raw.size)),1)])),"item.modified":(0,a.w5)((({item:e})=>[(0,a.Uk)((0,d.zw)(s.formatDate(e.raw.modified)),1)])),"item.owner":(0,a.w5)((({item:e})=>[(0,a.Uk)((0,d.zw)(e.raw.owner)+" "+(0,d.zw)(e.raw.group),1)])),_:1},8,["modelValue","headers","items"])])),_:1},8,["loading"])])}var n=l(1006),s=l(72564),i=l(48236);function u(e,t,l,d,o,r){const n=(0,a.up)("v-icon"),s=(0,a.up)("v-btn"),i=(0,a.up)("v-card-title"),u=(0,a.up)("v-text-field"),c=(0,a.up)("v-card-text"),h=(0,a.up)("v-card"),m=(0,a.up)("v-dialog");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(s,{onClick:t[0]||(t[0]=e=>r.open()),title:"New file"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Uk)("mdi:mdi-file-outline")])),_:1})])),_:1}),(0,a.Wm)(m,{app:"",modelValue:o.dialog,"onUpdate:modelValue":t[2]||(t[2]=e=>o.dialog=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{loading:o.fetching},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a.Uk)(" New file ")])),_:1}),(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:o.data.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.data.value=e),label:"name",autofocus:""},null,8,["modelValue"]),(0,a.Wm)(s,{color:"primary",onClick:r.save,disabled:""===o.data.value},{default:(0,a.w5)((()=>[(0,a.Uk)(" Save ")])),_:1},8,["onClick","disabled"])])),_:1})])),_:1},8,["loading"])])),_:1},8,["modelValue"])])}var c={props:{serverId:null,path:null},watch:{path:function(e){this&&(this.data.path=e)}},data(){return{fetching:!1,dialog:!1,data:{value:""}}},created(){this.data.path=this.path},methods:{open(){this.data.value="",this.dialog=!0},save(){var e=this;this.error="",this.fetching=!0,this.loading=!0,n.Z.post("servers/"+this.serverId+"/files",{cmd:"new_file",new_file:this.data.value,path:this.data.path}).then((t=>{if(console.log(t),t.data.success)e.dialog=!1,e.$emit("complete");else{var l=t.data.error?t.data.error:t.data;e.$emit("error",l)}})).catch((e=>console.log(e))).finally((()=>{e.fetching=!1,e.loading=!1}))}}},h=l(48118);const m=(0,h.Z)(c,[["render",u]]);var p=m;function f(e,t,l,d,o,r){const n=(0,a.up)("v-icon"),s=(0,a.up)("v-btn"),i=(0,a.up)("v-card-title"),u=(0,a.up)("v-text-field"),c=(0,a.up)("v-card-text"),h=(0,a.up)("v-card"),m=(0,a.up)("v-dialog");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(s,{onClick:t[0]||(t[0]=e=>r.open()),title:"New folder"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Uk)("mdi:mdi-folder-outline")])),_:1})])),_:1}),(0,a.Wm)(m,{app:"",modelValue:o.dialog,"onUpdate:modelValue":t[2]||(t[2]=e=>o.dialog=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{loading:o.fetching},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a.Uk)(" New folder ")])),_:1}),(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:o.data.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.data.value=e),label:"name",autofocus:""},null,8,["modelValue"]),(0,a.Wm)(s,{color:"primary",onClick:r.save,disabled:""===o.data.value},{default:(0,a.w5)((()=>[(0,a.Uk)(" Save ")])),_:1},8,["onClick","disabled"])])),_:1})])),_:1},8,["loading"])])),_:1},8,["modelValue"])])}var v={props:{serverId:null,path:null},watch:{path:function(e){this&&(this.data.path=e)}},data(){return{fetching:!1,dialog:!1,data:{value:""}}},created(){this.data.path=this.path},methods:{open(){this.data.value="",this.dialog=!0},save(){var e=this;this.error="",this.fetching=!0,this.loading=!0,n.Z.post("servers/"+this.serverId+"/files",{cmd:"new_folder",new_folder:this.data.value,path:this.data.path}).then((t=>{if(console.log(t),t.data.success)e.dialog=!1,e.$emit("complete");else{var l=t.data.error?t.data.error:t.data;e.$emit("error",l)}})).catch((e=>console.log(e))).finally((()=>{e.fetching=!1,e.loading=!1}))}}};const w=(0,h.Z)(v,[["render",f]]);var g=w;const W={key:0},k=(0,a._)("div",null,"Owner",-1),_=(0,a._)("div",{class:"mt-5"},"Group",-1),b=(0,a._)("div",{class:"mt-5"},"Public",-1);function C(e,t,l,d,o,r){const n=(0,a.up)("v-icon"),s=(0,a.up)("v-btn"),i=(0,a.up)("v-card-title"),u=(0,a.up)("v-checkbox"),c=(0,a.up)("v-col"),h=(0,a.up)("v-row"),m=(0,a.up)("v-container"),p=(0,a.up)("v-text-field"),f=(0,a.up)("v-card-text"),v=(0,a.up)("v-card"),w=(0,a.up)("v-dialog");return l.selected.length?((0,a.wg)(),(0,a.iD)("div",W,[(0,a.Wm)(s,{onClick:t[0]||(t[0]=e=>r.chmod()),disabled:!l.selected,title:"Change Permissions"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Uk)("mdi:mdi-file-key-outline")])),_:1})])),_:1},8,["disabled"]),(0,a.Wm)(w,{app:"",modelValue:o.dialog,"onUpdate:modelValue":t[23]||(t[23]=e=>o.dialog=e),width:"unset"},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{loading:o.fetching,flat:""},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a.Uk)(" File permissions ")])),_:1}),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,{fluid:""},{default:(0,a.w5)((()=>[k,(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:o.ownerR,"onUpdate:modelValue":t[1]||(t[1]=e=>o.ownerR=e),label:"Read",onChange:t[2]||(t[2]=e=>r.calcMode())},null,8,["modelValue"])])),_:1}),(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:o.ownerW,"onUpdate:modelValue":t[3]||(t[3]=e=>o.ownerW=e),label:"Write",onChange:t[4]||(t[4]=e=>r.calcMode())},null,8,["modelValue"])])),_:1}),(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:o.ownerE,"onUpdate:modelValue":t[5]||(t[5]=e=>o.ownerE=e),label:"Execute",onChange:t[6]||(t[6]=e=>r.calcMode())},null,8,["modelValue"])])),_:1})])),_:1}),_,(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:o.groupR,"onUpdate:modelValue":t[7]||(t[7]=e=>o.groupR=e),label:"Read",onChange:t[8]||(t[8]=e=>r.calcMode())},null,8,["modelValue"])])),_:1}),(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:o.groupW,"onUpdate:modelValue":t[9]||(t[9]=e=>o.groupW=e),label:"Write",onChange:t[10]||(t[10]=e=>r.calcMode())},null,8,["modelValue"])])),_:1}),(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:o.groupE,"onUpdate:modelValue":t[11]||(t[11]=e=>o.groupE=e),label:"Execute",onChange:t[12]||(t[12]=e=>r.calcMode())},null,8,["modelValue"])])),_:1})])),_:1}),b,(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:o.publicR,"onUpdate:modelValue":t[13]||(t[13]=e=>o.publicR=e),label:"Read",onChange:t[14]||(t[14]=e=>r.calcMode())},null,8,["modelValue"])])),_:1}),(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:o.publicW,"onUpdate:modelValue":t[15]||(t[15]=e=>o.publicW=e),label:"Write",onChange:t[16]||(t[16]=e=>r.calcMode())},null,8,["modelValue"])])),_:1}),(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:o.publicE,"onUpdate:modelValue":t[17]||(t[17]=e=>o.publicE=e),label:"Execute",onChange:t[18]||(t[18]=e=>r.calcMode())},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,a.Wm)(p,{modelValue:o.data.mode,"onUpdate:modelValue":t[19]||(t[19]=e=>o.data.mode=e),label:"mode",autofocus:"",onKeyup:t[20]||(t[20]=e=>r.modeToCheckboxes())},null,8,["modelValue"]),l.folderSelected?((0,a.wg)(),(0,a.j4)(u,{key:0,modelValue:o.data.recursive,"onUpdate:modelValue":t[21]||(t[21]=e=>o.data.recursive=e),label:"Replace child permissions"},null,8,["modelValue"])):(0,a.kq)("",!0),(0,a.Wm)(s,{color:"primary",onClick:t[22]||(t[22]=e=>r.doChmod())},{default:(0,a.w5)((()=>[(0,a.Uk)(" Save ")])),_:1})])),_:1})])),_:1},8,["loading"])])),_:1},8,["modelValue"])])):(0,a.kq)("",!0)}var V={props:{serverId:null,path:null,selected:null,folderSelected:null},watch:{path:function(e){this.data.path=e},selected:function(e){this.data.selected=e}},data(){return{fetching:!1,data:{recursive:!1},error:"",dialog:!1,ownerR:!1,ownerW:!1,ownerE:!1,groupR:!1,groupW:!1,groupE:!1,publicR:!1,publicW:!1,publicE:!1}},methods:{calcMode(){var e=0,t=0,l=0;this.ownerR&&(e+=4),this.ownerW&&(e+=2),this.ownerE&&(e+=1),this.groupR&&(l+=4),this.groupW&&(l+=2),this.groupE&&(l+=1),this.publicR&&(t+=4),this.publicW&&(t+=2),this.publicE&&(t+=1),this.data.mode=""+e+l+t},modeToCheckboxes(){var e=this.data.mode,t=e.substr(0,1),l=e.substr(1,1),a=e.substr(2,1);this.ownerR=t>=4&&t<=7,this.ownerW=2==t||3==t||6==t||7==t,this.ownerE=1==t||3==t||5==t||7==t,this.groupR=l>=4&&l<=7,this.groupW=2==l||3==l||6==l||7==l,this.groupE=1==l||3==l||5==l||7==l,this.publicR=a>=4&&a<=7,this.publicW=2==a||3==a||6==a||7==a,this.publicE=1==a||3==a||5==a||7==a},chmod(){this.dialog=!0,1===this.selected.length?this.data.mode=this.selected[0].permsn:this.data.mode="000",this.modeToCheckboxes()},doChmod(){var e=this;this.fetching=!0;var t=[];this.selected.forEach((e=>t.push(e.id))),n.Z.post("servers/"+this.serverId+"/files",{cmd:"chmod",mode:this.data.mode,recursive:this.data.recursive,files:t}).then((t=>{if(console.log(t),t.data.success)e.dialog=!1,e.$emit("complete");else{var l=t.data.error?t.data.error:t.data;e.$emit("error",l)}})).catch((e=>console.log(e))).finally((()=>e.fetching=!1))}}};const I=(0,h.Z)(V,[["render",C]]);var y=I;const E={key:0};function U(e,t,l,d,o,r){const n=(0,a.up)("v-icon"),s=(0,a.up)("v-btn"),i=(0,a.up)("v-card-title"),u=(0,a.up)("v-text-field"),c=(0,a.up)("v-checkbox"),h=(0,a.up)("v-card-text"),m=(0,a.up)("v-card"),p=(0,a.up)("v-dialog");return l.selected.length?((0,a.wg)(),(0,a.iD)("div",E,[(0,a.Wm)(s,{onClick:t[0]||(t[0]=e=>r.chown()),disabled:!l.selected,title:"Change owner"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Uk)("mdi:mdi-account")])),_:1})])),_:1},8,["disabled"]),(0,a.Wm)(p,{app:"",modelValue:o.dialog,"onUpdate:modelValue":t[5]||(t[5]=e=>o.dialog=e),width:"unset"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{loading:o.fetching,flat:""},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a.Uk)(" File ownership ")])),_:1}),(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:o.data.owner,"onUpdate:modelValue":t[1]||(t[1]=e=>o.data.owner=e),label:"Owner",autofocus:""},null,8,["modelValue"]),(0,a.Wm)(u,{modelValue:o.data.group,"onUpdate:modelValue":t[2]||(t[2]=e=>o.data.group=e),label:"Group"},null,8,["modelValue"]),l.folderSelected?((0,a.wg)(),(0,a.j4)(c,{key:0,modelValue:o.data.recursive,"onUpdate:modelValue":t[3]||(t[3]=e=>o.data.recursive=e),label:"Replace child permissions"},null,8,["modelValue"])):(0,a.kq)("",!0),(0,a.Wm)(s,{color:"primary",onClick:t[4]||(t[4]=e=>r.doChown())},{default:(0,a.w5)((()=>[(0,a.Uk)(" Save ")])),_:1})])),_:1})])),_:1},8,["loading"])])),_:1},8,["modelValue"])])):(0,a.kq)("",!0)}var x={props:{serverId:null,path:null,selected:null,folderSelected:null},watch:{path:function(e){this.data.path=e},selected:function(e){this.data.selected=e}},data(){return{fetching:!1,data:{recursive:!1},error:"",dialog:!1}},methods:{chown(){this.dialog=!0,1===this.selected.length?(this.data.owner=this.selected[0].owner,this.data.group=this.selected[0].group):(this.data.owner="",this.data.group="")},doChown(){var e=this;this.fetching=!0;var t=[];this.selected.forEach((e=>t.push(e.id))),n.Z.post("servers/"+this.serverId+"/files",{cmd:"chown",owner:this.data.owner,group:this.data.group,recursive:this.data.recursive,files:t}).then((t=>{if(console.log(t),t.data.success)e.dialog=!1,e.$emit("complete");else{var l=t.data.error?t.data.error:t.data;e.$emit("error",l)}})).catch((e=>{console.log(e)})).finally((()=>{e.fetching=!1}))}}};const D=(0,h.Z)(x,[["render",U]]);var R=D;const Z={key:0};function $(e,t,l,d,o,r){const n=(0,a.up)("v-icon"),s=(0,a.up)("v-btn"),i=(0,a.up)("v-card-title"),u=(0,a.up)("v-text-field"),c=(0,a.up)("v-card-text"),h=(0,a.up)("v-card"),m=(0,a.up)("v-dialog");return 1===l.selected.length?((0,a.wg)(),(0,a.iD)("div",Z,[(0,a.Wm)(s,{onClick:t[0]||(t[0]=e=>r.rename()),disabled:!l.selected,title:"Rename"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Uk)("mdi:mdi-rename-box")])),_:1})])),_:1},8,["disabled"]),(0,a.Wm)(m,{app:"",modelValue:o.dialog,"onUpdate:modelValue":t[2]||(t[2]=e=>o.dialog=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{loading:o.fetching},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a.Uk)(" Rename ")])),_:1}),(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:o.data.newName,"onUpdate:modelValue":t[1]||(t[1]=e=>o.data.newName=e),label:"name",autofocus:""},null,8,["modelValue"]),(0,a.Wm)(s,{color:"primary",onClick:r.doRename},{default:(0,a.w5)((()=>[(0,a.Uk)(" Save ")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["loading"])])),_:1},8,["modelValue"])])):(0,a.kq)("",!0)}var S={props:{serverId:null,path:null,selected:null},watch:{path:e=>(void 0).data.path=e,selected:e=>(void 0).data.selected=e},data(){return{fetching:!1,data:{path:"",selected:[]},error:"",dialog:!1}},methods:{rename(){console.log(this.selected),this.dialog=!0,this.data.oldName=this.selected[0].name,this.data.newName=this.selected[0].name},doRename(){var e=this;this.fetching=!0,n.Z.post("servers/"+this.serverId+"/files",{cmd:"rename",path:this.path,old_name:this.data.oldName,new_name:this.data.newName}).then((t=>{if(console.log(t),t.data.success)e.dialog=!1,e.$emit("complete");else{var l=t.data.error?t.data.error:t.data;e.$emit("error",l)}})).catch((e=>console.log(e))).finally((()=>e.fetching=!1))}}};const q=(0,h.Z)(S,[["render",$]]);var z=q,F=l(72888);const L={key:0};function N(e,t,l,d,o,r){const n=(0,a.up)("v-icon"),s=(0,a.up)("v-btn"),i=(0,a.up)("Confirm");return l.selected.length?((0,a.wg)(),(0,a.iD)("div",L,[(0,a.Wm)(s,{onClick:t[0]||(t[0]=e=>r.deleteItem()),title:"Delete"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Uk)("mdi:mdi-delete")])),_:1})])),_:1}),(0,a.Wm)(i,{ref:"confirm"},null,512)])):(0,a.kq)("",!0)}var O=l(90947),j={components:{Confirm:O.Z},props:{serverId:null,path:null,selected:null},watch:{path:function(e){this.data.path=e},selected:function(e){this.data.selected=e}},data(){return{fetching:!1,error:"",data:{}}},methods:{deleteItem:async function(){if(await this.$refs.confirm.open("Confirm","Delete selected files?")){var e=this;this.fetching=!0;var t=[];this.selected.forEach((e=>t.push(e.id))),n.Z.post("servers/"+this.serverId+"/files",{cmd:"delete",files:t}).then((t=>{if(console.log(t),t.data.success)e.$emit("complete");else{var l=t.data.error?t.data.error:t.data;e.$emit("error",l)}})).catch((e=>{console.log(e)})).finally((()=>e.fetching=!1))}}}};const M=(0,h.Z)(j,[["render",N]]);var T=M;const K={key:0};function H(e,t,l,d,o,r){const n=(0,a.up)("v-icon"),s=(0,a.up)("v-btn");return 1===l.selected.length&&"file"===l.selected[0].type?((0,a.wg)(),(0,a.iD)("div",K,[(0,a.Wm)(s,{onClick:t[0]||(t[0]=e=>r.download()),title:"Download"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Uk)("mdi:mdi-download")])),_:1})])),_:1})])):(0,a.kq)("",!0)}var P={props:{serverId:null,path:null,selected:null},watch:{path:e=>(void 0).data.path=e,selected:e=>(void 0).data.selected=e},data(){return{fetching:!1,data:{},error:"",dialog:!1}},methods:{download(){window.open("https://serverwand.com/api/servers/"+this.serverId+"/files?d="+encodeURIComponent(this.selected[0].id))}}};const B=(0,h.Z)(P,[["render",H]]);var G=B;function A(e,t,l,d,o,r){const n=(0,a.up)("v-icon"),s=(0,a.up)("v-btn"),i=(0,a.up)("v-col"),u=(0,a.up)("v-row");return(0,a.wg)(),(0,a.j4)(i,{class:"flex-grow-0",style:{"min-width":"264px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[l.selected.length?((0,a.wg)(),(0,a.j4)(i,{key:0,class:"flex-grow-0"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{onClick:t[0]||(t[0]=e=>r.cut()),title:"Cut"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Uk)("mdi:mdi-content-cut")])),_:1})])),_:1})])),_:1})):(0,a.kq)("",!0),l.selected.length?((0,a.wg)(),(0,a.j4)(i,{key:1,class:"flex-grow-0"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{onClick:t[1]||(t[1]=e=>r.copy()),title:"Copy"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Uk)("mdi:mdi-content-copy")])),_:1})])),_:1})])),_:1})):(0,a.kq)("",!0),o.data.items.length&&l.path!=o.data.src?((0,a.wg)(),(0,a.j4)(i,{key:2,class:"flex-grow-0"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{onClick:t[2]||(t[2]=e=>r.paste()),title:"Paste"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Uk)("mdi:mdi-content-paste")])),_:1})])),_:1})])),_:1})):(0,a.kq)("",!0)])),_:1})])),_:1})}var J={props:{serverId:null,path:null,selected:null},watch:{path:function(e){this.data.path=e},selected:function(e){this.data.selected=e}},data(){return{fetching:!1,data:{items:[],cut:!1,src:""},error:"",dialog:!1}},methods:{cut(){this.copy(!0)},copy(e){this.data.cut=!!e,this.data.src=this.path,this.data.items=[],this.selected.forEach((e=>this.data.items.push(e.name)))},paste(){console.log(this.data);var e=this.data.cut?"Move":"Copy";this.$confirm(e+" "+this.data.items.length+" items?").then((t=>{if(t){var l=this;this.fetching=!0,n.Z.post("servers/"+this.serverId+"/files",{cmd:e.toLowerCase(),path:this.path,src:this.data.src,files:this.data.items}).then((t=>{if(console.log(t),"move"===e.toLowerCase()&&(l.data.items=[]),t.data.success)l.$emit("complete");else{var a=t.data.error?t.data.error:t.data;l.$emit("error",a)}})).catch((e=>console.log(e))).finally((()=>l.fetching=!1))}}))}}};const Q=(0,h.Z)(J,[["render",A]]);var X=Q,Y=l(98686);function ee(e,t,l,o,r,n){const s=(0,a.up)("v-alert"),i=(0,a.up)("v-icon"),u=(0,a.up)("v-btn"),c=(0,a.up)("v-col");return(0,a.wg)(),(0,a.iD)("div",null,[r.msg?((0,a.wg)(),(0,a.j4)(s,{key:0,dark:"",style:{position:"fixed",width:"100%","z-index":"10",left:"0",bottom:"0",margin:"0 auto"},type:"info"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,d.zw)(r.msg),1)])),_:1})):(0,a.kq)("",!0),1===l.selected?.length&&-1!==["zip","gz","tar"].indexOf(n.fileExtension(l.selected[0]))?((0,a.wg)(),(0,a.j4)(c,{key:1,class:"flex-grow-0"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{onClick:t[0]||(t[0]=e=>n.extract()),disabled:!l.selected,title:"Extract"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a.Uk)("mdi:mdi-folder-zip-outline")])),_:1})])),_:1},8,["disabled"])])),_:1})):(0,a.kq)("",!0)])}var te={props:{serverId:null,path:null,selected:null},watch:{path:function(e){this.data.path=e},selected:function(e){this.data.selected=e}},data(){return{data:{recursive:!1},error:"",dialog:!1,msg:""}},methods:{fileExtension(e){var t=e.name.lastIndexOf(".");return-1===t?"":e.name.substr(t+1,e.name.length)},extract(){var e=this;this.$emit("loading",!0),n.Z.event("servers/"+this.serverId+"/files?cmd=extract&id="+encodeURIComponent(this.selected[0].id),(t=>{e.msg=t.msg}),(t=>e.$emit("error",t)),(()=>{e.msg="",e.$emit("complete")}))}}};const le=(0,h.Z)(te,[["render",ee]]);var ae=le,de={components:{Loading:i.Z,NewFile:p,NewFolder:g,Chmod:y,Chown:R,Rename:z,EditFile:F.Z,DeleteFiles:T,Download:G,Clipboard:X,Upload:Y.Z,Extract:ae},data(){return{path:"/",search:"",error:"",items:[],server:{},data:{},loading:!1,fetching:!1,userHashChange:!0,serverId:0,selectedIds:[],folderSelected:!1,headers:[{title:"",key:""},{title:"Name ",key:"name"},{title:"Size ",key:"size",class:"d-none d-sm-table-cell",cellClass:"d-none d-sm-table-cell"},{title:"Last modified ",key:"modified",class:"d-none d-sm-table-cell",cellClass:"d-none d-sm-table-cell"},{title:"Permissions ",key:"perms",class:"d-none d-sm-table-cell",cellClass:"d-none d-sm-table-cell"},{title:"Owner ",key:"owner",class:"d-none d-sm-table-cell",cellClass:"d-none d-sm-table-cell"}],fileToOpen:""}},computed:{dir:function(){let e=this.path;if(!e.endsWith("/")){let t=e.lastIndexOf("/");-1!==t&&(e=e.substr(0,t))}return e},selected:function(){let e=[];var t=this;return this.selectedIds.forEach((function(l){e.push(t.items.find((e=>e.id===l)))})),e}},watch:{path:{handler:function(e){window.ssh_path=e,this.userHashChange=!1,location.hash=e}},selected:function(e){let t=!1;e.forEach((e=>{"folder"===e.type&&(t=!0)})),this.folderSelected=t}},created(){this.serverId=this.$route.params.id;var e=this;if(window.onhashchange=function(){e.userHashChange?(e.path=location.hash.substr(1),e.fetchData()):e.userHashChange=!0},location.hash){this.path=location.hash.substr(1);var t=this.basename(this.path);-1!==t.indexOf(".")&&(this.fileToOpen=t)}this.fetchData()},methods:{basename(e){return e.split(/[\\/]/).pop()},fetchData(){var e=this;this.error="",this.fetching=!0,this.search?(this.items=[],n.Z.event("servers/"+this.serverId+"/files?path="+encodeURIComponent(this.dir)+"&search="+encodeURIComponent(this.search),(t=>{let l=t.msg.split("\n");l.forEach((t=>{let l=!1;e.items.forEach((e=>{e.id===t&&(l=!0)})),l||e.items.push({id:t,name:e.basename(t),type:"file"})}))}),(t=>e.error=t),(()=>e.fetching=!1))):n.Z.post("servers/"+this.serverId+"/files",{path:this.dir}).then((t=>{console.log(t),t.data.error?e.error=t.data.error:(e.server=t.data.item,e.items=[],t.data.files.forEach((t=>{e.items.push({id:t.id,name:t.name,size:t.size,type:t.type,modified:t.modified,perms:t.perms,permsn:t.permsn,owner:t.owner,group:t.group,selected:!1})})),document.title="Files | "+e.server.name)})).catch((e=>{console.log(e)})).finally((()=>{if(e.fetching=!1,e.selectedIds=[],e.fileToOpen){var t=e.fileToOpen,l=1;if(-1!==t.indexOf(":")){var a=t.split(":");t=a[0],l=a[1]}e.items.forEach((async a=>{a.name===t&&(e.fileToOpen="",await e.$refs.editFile.open(a),e.$refs.editFile.goToLine(l))}))}}))},open(e){this.error="","folder"===e.type||"link"===e.type?(this.path=e.id,this.fetchData()):"file"===e.type&&this.$refs.editFile.open(e)},upLevel(){console.log(this.path),this.search="";var e=this.path.substr(0,this.path.length-1).lastIndexOf("/");-1!==e&&(this.path=this.path.substr(0,e+1),this.dir||(this.path="/")),this.fetchData()},handleError(e){this.error=e},handleLoading(e){this.fetching=e},prettyBytes(e){return s.Z.prettyBytes(e)},formatDate(e){return s.Z.formatDate(e)}}};const oe=(0,h.Z)(de,[["render",r]]);var re=oe}}]);
//# sourceMappingURL=4266.8ab4003b.js.map