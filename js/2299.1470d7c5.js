"use strict";(self["webpackChunkServerWand"]=self["webpackChunkServerWand"]||[]).push([[2299],{73544:function(e,t,l){l.r(t),l.d(t,{default:function(){return me}});var a=l(20641),d=l(53751),o=l(90033);const s={key:0};function i(e,t,l,i,r,n){const h=(0,a.g2)("v-alert"),c=(0,a.g2)("Loading"),u=(0,a.g2)("EditFile"),p=(0,a.g2)("NewFile"),m=(0,a.g2)("NewFolder"),g=(0,a.g2)("NewLink"),f=(0,a.g2)("Upload"),v=(0,a.g2)("Rename"),b=(0,a.g2)("DeleteFiles"),k=(0,a.g2)("Chmod"),w=(0,a.g2)("Chown"),F=(0,a.g2)("Extract"),C=(0,a.g2)("Tail"),E=(0,a.g2)("Download"),V=(0,a.g2)("Clipboard"),y=(0,a.g2)("v-row"),I=(0,a.g2)("v-container"),_=(0,a.g2)("v-icon"),W=(0,a.g2)("v-btn"),x=(0,a.g2)("v-text-field"),U=(0,a.g2)("v-data-table"),A=(0,a.g2)("v-card");return(0,a.uX)(),(0,a.CE)("div",null,[r.error?((0,a.uX)(),(0,a.Wv)(h,{key:0,type:"error",text:r.error},null,8,["text"])):(0,a.Q3)("",!0),(0,a.bF)(c,{value:r.loading},null,8,["value"]),(0,a.bF)(u,{ref:"editFile",serverId:r.serverId,action:"files",onComplete:t[0]||(t[0]=e=>n.fetchData()),onError:n.handleError,onLoading:n.handleLoading},null,8,["serverId","onError","onLoading"]),(0,a.bF)(A,{loading:r.fetching},{default:(0,a.k6)((()=>[(0,a.bF)(I,{fluid:""},{default:(0,a.k6)((()=>[(0,a.bF)(y,null,{default:(0,a.k6)((()=>[0===n.selected.length?((0,a.uX)(),(0,a.Wv)(p,{key:0,serverId:r.serverId,path:r.path,onComplete:t[1]||(t[1]=e=>n.fetchData()),onError:n.handleError},null,8,["serverId","path","onError"])):(0,a.Q3)("",!0),0===n.selected.length?((0,a.uX)(),(0,a.Wv)(m,{key:1,serverId:r.serverId,path:r.path,onComplete:t[2]||(t[2]=e=>n.fetchData()),onError:n.handleError},null,8,["serverId","path","onError"])):(0,a.Q3)("",!0),0===n.selected.length?((0,a.uX)(),(0,a.Wv)(g,{key:2,serverId:r.serverId,path:r.path,onComplete:t[3]||(t[3]=e=>n.fetchData()),onError:n.handleError},null,8,["serverId","path","onError"])):(0,a.Q3)("",!0),0===n.selected.length?((0,a.uX)(),(0,a.Wv)(f,{key:3,serverId:r.serverId,path:r.path,dropZone:e.$refs.results,onComplete:t[4]||(t[4]=e=>n.fetchData()),onError:n.handleError,folder:"folder"},null,8,["serverId","path","dropZone","onError"])):(0,a.Q3)("",!0),1===n.selected.length?((0,a.uX)(),(0,a.Wv)(v,{key:4,serverId:r.serverId,path:r.path,selected:n.selected,onComplete:t[5]||(t[5]=e=>n.fetchData()),onError:n.handleError},null,8,["serverId","path","selected","onError"])):(0,a.Q3)("",!0),n.selected.length?((0,a.uX)(),(0,a.Wv)(b,{key:5,serverId:r.serverId,path:r.path,selected:n.selected,onComplete:t[6]||(t[6]=e=>n.fetchData()),onError:n.handleError},null,8,["serverId","path","selected","onError"])):(0,a.Q3)("",!0),(0,a.bF)(k,{serverId:r.serverId,path:r.path,selected:n.selected,folderSelected:r.folderSelected,onComplete:t[7]||(t[7]=e=>n.fetchData()),onError:n.handleError},null,8,["serverId","path","selected","folderSelected","onError"]),(0,a.bF)(w,{serverId:r.serverId,path:r.path,selected:n.selected,folderSelected:r.folderSelected,onComplete:t[8]||(t[8]=e=>n.fetchData()),onError:n.handleError},null,8,["serverId","path","selected","folderSelected","onError"]),(0,a.bF)(F,{serverId:r.serverId,path:r.path,selected:n.selected,onComplete:t[9]||(t[9]=e=>n.fetchData()),onError:n.handleError,onLoading:n.handleLoading},null,8,["serverId","path","selected","onError","onLoading"]),1===n.selected.length?((0,a.uX)(),(0,a.Wv)(C,{key:6,serverId:r.serverId,path:r.path,selected:n.selected,onComplete:t[10]||(t[10]=e=>n.fetchData()),onError:n.handleError},null,8,["serverId","path","selected","onError"])):(0,a.Q3)("",!0),1===n.selected.length&&"file"===n.selected[0].type?((0,a.uX)(),(0,a.Wv)(E,{key:7,serverId:r.serverId,path:r.path,selected:n.selected},null,8,["serverId","path","selected"])):(0,a.Q3)("",!0),(0,a.bF)(V,{serverId:r.serverId,path:r.path,selected:n.selected,onComplete:t[11]||(t[11]=e=>n.fetchData()),onError:n.handleError},null,8,["serverId","path","selected","onError"])])),_:1})])),_:1}),(0,a.bF)(I,{fluid:""},{default:(0,a.k6)((()=>[(0,a.bF)(y,null,{default:(0,a.k6)((()=>[(0,a.bF)(W,{icon:"",onClick:t[12]||(t[12]=e=>n.upLevel()),disabled:"/"===r.path,title:"Up one level"},{default:(0,a.k6)((()=>[(0,a.bF)(_,{size:"small"},{default:(0,a.k6)((()=>t[16]||(t[16]=[(0,a.eW)("mdi:mdi-arrow-up")]))),_:1})])),_:1},8,["disabled"]),(0,a.bF)(x,{modelValue:r.path,"onUpdate:modelValue":t[13]||(t[13]=e=>r.path=e),class:"mx-2",onChange:n.fetchData,onKeydown:(0,d.jR)(n.fetchData,["enter"])},null,8,["modelValue","onChange","onKeydown"])])),_:1})])),_:1}),(0,a.bF)(U,{modelValue:r.selectedIds,"onUpdate:modelValue":t[14]||(t[14]=e=>r.selectedIds=e),headers:r.headers,items:r.items,"items-per-page":100,ref:"results","show-select":"","mobile-breakpoint":"0","onClick:row":t[15]||(t[15]=function(e,t){n.open(t.item)}),loading:r.fetching,page:r.page,"onUpdate:page":n.updatePage,hover:"","row-props":n.rowProps},{"item.size":(0,a.k6)((({item:e})=>["file"===e.type?((0,a.uX)(),(0,a.CE)("span",s,(0,o.v_)(n.prettyBytes(e.size)),1)):(0,a.Q3)("",!0)])),"item.modified":(0,a.k6)((({item:e})=>[(0,a.eW)((0,o.v_)(n.formatDate(e.modified)),1)])),"item.owner":(0,a.k6)((({item:e})=>[(0,a.eW)((0,o.v_)(e.owner)+" "+(0,o.v_)(e.group),1)])),_:1},8,["modelValue","headers","items","loading","page","onUpdate:page","row-props"])])),_:1},8,["loading"])])}l(44114),l(98992),l(72577),l(3949);var r=l(74300),n=l(27274),h=l(81815);function c(e,t,l,d,o,s){const i=(0,a.g2)("v-icon"),r=(0,a.g2)("v-btn"),n=(0,a.g2)("v-card-title"),h=(0,a.g2)("v-text-field"),c=(0,a.g2)("v-card-text"),u=(0,a.g2)("v-card"),p=(0,a.g2)("v-dialog");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(r,{onClick:t[0]||(t[0]=e=>s.open()),title:"New file",icon:""},{default:(0,a.k6)((()=>[(0,a.bF)(i,null,{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)("mdi:mdi-file-outline")]))),_:1})])),_:1}),(0,a.bF)(p,{app:"",modelValue:o.dialog,"onUpdate:modelValue":t[2]||(t[2]=e=>o.dialog=e),"max-width":"600"},{default:(0,a.k6)((()=>[(0,a.bF)(u,{loading:o.fetching},{default:(0,a.k6)((()=>[(0,a.bF)(n,null,{default:(0,a.k6)((()=>t[4]||(t[4]=[(0,a.eW)(" New file ")]))),_:1}),(0,a.bF)(c,null,{default:(0,a.k6)((()=>[(0,a.bF)(h,{modelValue:o.data.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.data.value=e),label:"name",autofocus:""},null,8,["modelValue"]),(0,a.bF)(r,{color:"primary",onClick:s.save,disabled:""===o.data.value},{default:(0,a.k6)((()=>t[5]||(t[5]=[(0,a.eW)(" Save ")]))),_:1},8,["onClick","disabled"])])),_:1})])),_:1},8,["loading"])])),_:1},8,["modelValue"])])}var u={props:{serverId:null,path:null},watch:{path:function(e){this.data.path=e}},data(){return{fetching:!1,dialog:!1,data:{value:""}}},created(){this.data.path=this.path},methods:{open(){this.data.value="",this.dialog=!0},save(){this.error="",this.fetching=!0,this.loading=!0,r.A.post("servers/"+this.serverId+"/files",{cmd:"new_file",new_file:this.data.value,path:this.data.path}).then((e=>{if(console.log(e),e.data.success)this.dialog=!1,this.$emit("complete");else{let t=e.data.error?e.data.error:e.data;this.$emit("error",t)}})).catch((e=>console.log(e))).finally((()=>{this.fetching=!1,this.loading=!1}))}}},p=l(66262);const m=(0,p.A)(u,[["render",c]]);var g=m;function f(e,t,l,d,o,s){const i=(0,a.g2)("v-btn"),r=(0,a.g2)("v-text-field"),n=(0,a.g2)("v-card-text"),h=(0,a.g2)("v-card"),c=(0,a.g2)("v-dialog");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(i,{onClick:t[0]||(t[0]=e=>s.open()),title:"New folder",icon:"mdi:mdi-folder-outline"}),(0,a.bF)(c,{app:"",modelValue:o.dialog,"onUpdate:modelValue":t[2]||(t[2]=e=>o.dialog=e),"max-width":"600"},{default:(0,a.k6)((()=>[(0,a.bF)(h,{loading:o.fetching,title:"New folder"},{default:(0,a.k6)((()=>[(0,a.bF)(n,null,{default:(0,a.k6)((()=>[(0,a.bF)(r,{modelValue:o.data.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.data.value=e),label:"name",autofocus:""},null,8,["modelValue"]),(0,a.bF)(i,{color:"primary",onClick:s.save,disabled:""===o.data.value},{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)(" Save ")]))),_:1},8,["onClick","disabled"])])),_:1})])),_:1},8,["loading"])])),_:1},8,["modelValue"])])}var v={props:{serverId:null,path:null},watch:{path:function(e){this.data.path=e}},data(){return{fetching:!1,dialog:!1,data:{value:""}}},created(){this.data.path=this.path},methods:{open(){this.data.value="",this.dialog=!0},save(){this.error="",this.fetching=!0,this.loading=!0,r.A.post("servers/"+this.serverId+"/files",{cmd:"new_folder",new_folder:this.data.value,path:this.data.path}).then((e=>{if(console.log(e),e.data.success)this.dialog=!1,this.$emit("complete");else{let t=e.data.error?e.data.error:e.data;this.$emit("error",t)}})).catch((e=>console.log(e))).finally((()=>{this.fetching=!1,this.loading=!1}))}}};const b=(0,p.A)(v,[["render",f]]);var k=b;function w(e,t,l,d,o,s){const i=(0,a.g2)("v-btn"),r=(0,a.g2)("v-text-field"),n=(0,a.g2)("v-card-text"),h=(0,a.g2)("v-card"),c=(0,a.g2)("v-dialog");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(i,{onClick:t[0]||(t[0]=e=>s.open()),title:"New folder",icon:"mdi:mdi-link"}),(0,a.bF)(c,{app:"",modelValue:o.dialog,"onUpdate:modelValue":t[3]||(t[3]=e=>o.dialog=e),"max-width":"600"},{default:(0,a.k6)((()=>[(0,a.bF)(h,{loading:o.fetching,title:"New link"},{default:(0,a.k6)((()=>[(0,a.bF)(n,null,{default:(0,a.k6)((()=>[(0,a.bF)(r,{modelValue:o.data.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.data.value=e),label:"name",autofocus:""},null,8,["modelValue"]),(0,a.bF)(r,{modelValue:o.data.dest,"onUpdate:modelValue":t[2]||(t[2]=e=>o.data.dest=e),label:"destination path"},null,8,["modelValue"]),(0,a.bF)(i,{color:"primary",onClick:s.save,disabled:""===o.data.value},{default:(0,a.k6)((()=>t[4]||(t[4]=[(0,a.eW)(" Save ")]))),_:1},8,["onClick","disabled"])])),_:1})])),_:1},8,["loading"])])),_:1},8,["modelValue"])])}var F={props:{serverId:null,path:null},watch:{path:function(e){this.data.path=e}},data(){return{fetching:!1,dialog:!1,data:{value:"",dest:""}}},created(){this.data.path=this.path},methods:{open(){this.data.value="",this.dialog=!0},save(){this.error="",this.fetching=!0,this.loading=!0,r.A.post("servers/"+this.serverId+"/files",{cmd:"new_link",new_link:this.data.value,dest:this.data.dest}).then((e=>{if(console.log(e),e.data.success)this.dialog=!1,this.$emit("complete");else{let t=e.data.error?e.data.error:e.data;this.$emit("error",t)}})).catch((e=>console.log(e))).finally((()=>{this.fetching=!1,this.loading=!1}))}}};const C=(0,p.A)(F,[["render",w]]);var E=C;const V={key:0};function y(e,t,l,d,o,s){const i=(0,a.g2)("v-btn"),r=(0,a.g2)("v-checkbox"),n=(0,a.g2)("v-col"),h=(0,a.g2)("v-row"),c=(0,a.g2)("v-container"),u=(0,a.g2)("v-text-field"),p=(0,a.g2)("v-form"),m=(0,a.g2)("v-card-text"),g=(0,a.g2)("v-card"),f=(0,a.g2)("v-dialog");return l.selected.length?((0,a.uX)(),(0,a.CE)("div",V,[(0,a.bF)(i,{onClick:t[0]||(t[0]=e=>s.chmod()),disabled:!l.selected,title:"Change permissions",icon:"mdi:mdi-file-key-outline"},null,8,["disabled"]),(0,a.bF)(f,{app:"",modelValue:o.dialog,"onUpdate:modelValue":t[24]||(t[24]=e=>o.dialog=e),width:"600"},{default:(0,a.k6)((()=>[(0,a.bF)(g,{loading:o.fetching,flat:"",title:"File permissions"},{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.bF)(c,{fluid:""},{default:(0,a.k6)((()=>[t[25]||(t[25]=(0,a.Lk)("div",null,"Owner",-1)),(0,a.bF)(h,null,{default:(0,a.k6)((()=>[(0,a.bF)(n,null,{default:(0,a.k6)((()=>[(0,a.bF)(r,{modelValue:o.ownerR,"onUpdate:modelValue":t[1]||(t[1]=e=>o.ownerR=e),label:"Read",onChange:t[2]||(t[2]=e=>s.calcMode())},null,8,["modelValue"])])),_:1}),(0,a.bF)(n,null,{default:(0,a.k6)((()=>[(0,a.bF)(r,{modelValue:o.ownerW,"onUpdate:modelValue":t[3]||(t[3]=e=>o.ownerW=e),label:"Write",onChange:t[4]||(t[4]=e=>s.calcMode())},null,8,["modelValue"])])),_:1}),(0,a.bF)(n,null,{default:(0,a.k6)((()=>[(0,a.bF)(r,{modelValue:o.ownerE,"onUpdate:modelValue":t[5]||(t[5]=e=>o.ownerE=e),label:"Execute",onChange:t[6]||(t[6]=e=>s.calcMode())},null,8,["modelValue"])])),_:1})])),_:1}),t[26]||(t[26]=(0,a.Lk)("div",{class:"mt-5"},"Group",-1)),(0,a.bF)(h,null,{default:(0,a.k6)((()=>[(0,a.bF)(n,null,{default:(0,a.k6)((()=>[(0,a.bF)(r,{modelValue:o.groupR,"onUpdate:modelValue":t[7]||(t[7]=e=>o.groupR=e),label:"Read",onChange:t[8]||(t[8]=e=>s.calcMode())},null,8,["modelValue"])])),_:1}),(0,a.bF)(n,null,{default:(0,a.k6)((()=>[(0,a.bF)(r,{modelValue:o.groupW,"onUpdate:modelValue":t[9]||(t[9]=e=>o.groupW=e),label:"Write",onChange:t[10]||(t[10]=e=>s.calcMode())},null,8,["modelValue"])])),_:1}),(0,a.bF)(n,null,{default:(0,a.k6)((()=>[(0,a.bF)(r,{modelValue:o.groupE,"onUpdate:modelValue":t[11]||(t[11]=e=>o.groupE=e),label:"Execute",onChange:t[12]||(t[12]=e=>s.calcMode())},null,8,["modelValue"])])),_:1})])),_:1}),t[27]||(t[27]=(0,a.Lk)("div",{class:"mt-5"},"Public",-1)),(0,a.bF)(h,null,{default:(0,a.k6)((()=>[(0,a.bF)(n,null,{default:(0,a.k6)((()=>[(0,a.bF)(r,{modelValue:o.publicR,"onUpdate:modelValue":t[13]||(t[13]=e=>o.publicR=e),label:"Read",onChange:t[14]||(t[14]=e=>s.calcMode())},null,8,["modelValue"])])),_:1}),(0,a.bF)(n,null,{default:(0,a.k6)((()=>[(0,a.bF)(r,{modelValue:o.publicW,"onUpdate:modelValue":t[15]||(t[15]=e=>o.publicW=e),label:"Write",onChange:t[16]||(t[16]=e=>s.calcMode())},null,8,["modelValue"])])),_:1}),(0,a.bF)(n,null,{default:(0,a.k6)((()=>[(0,a.bF)(r,{modelValue:o.publicE,"onUpdate:modelValue":t[17]||(t[17]=e=>o.publicE=e),label:"Execute",onChange:t[18]||(t[18]=e=>s.calcMode())},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,a.bF)(p,{modelValue:o.valid,"onUpdate:modelValue":t[23]||(t[23]=e=>o.valid=e)},{default:(0,a.k6)((()=>[(0,a.bF)(u,{modelValue:o.data.mode,"onUpdate:modelValue":t[19]||(t[19]=e=>o.data.mode=e),label:"mode",autofocus:"",onKeyup:t[20]||(t[20]=e=>s.modeToCheckboxes()),rules:[o.rules.required,o.rules.perms]},null,8,["modelValue","rules"]),l.folderSelected?((0,a.uX)(),(0,a.Wv)(r,{key:0,modelValue:o.data.recursive,"onUpdate:modelValue":t[21]||(t[21]=e=>o.data.recursive=e),label:"Replace child permissions"},null,8,["modelValue"])):(0,a.Q3)("",!0),(0,a.bF)(i,{color:"primary",onClick:t[22]||(t[22]=e=>s.doChmod()),disabled:!o.valid},{default:(0,a.k6)((()=>t[28]||(t[28]=[(0,a.eW)("Save")]))),_:1},8,["disabled"])])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["loading"])])),_:1},8,["modelValue"])])):(0,a.Q3)("",!0)}var I={props:{serverId:null,path:null,selected:null,folderSelected:null},watch:{path:function(e){this.data.path=e},selected:function(e){this.data.selected=e}},data(){return{fetching:!1,data:{recursive:!1},error:"",dialog:!1,ownerR:!1,ownerW:!1,ownerE:!1,groupR:!1,groupW:!1,groupE:!1,publicR:!1,publicW:!1,publicE:!1,rules:{required:e=>!!e||"Required.",perms:e=>!e||/^([0-7][0-7][0-7])$/.test(e)||"Invalid Permissions"},valid:null}},methods:{calcMode(){let e=0,t=0,l=0;this.ownerR&&(e+=4),this.ownerW&&(e+=2),this.ownerE&&(e+=1),this.groupR&&(l+=4),this.groupW&&(l+=2),this.groupE&&(l+=1),this.publicR&&(t+=4),this.publicW&&(t+=2),this.publicE&&(t+=1),this.data.mode=""+e+l+t},modeToCheckboxes(){let e=this.data.mode,t=e.substr(0,1),l=e.substr(1,1),a=e.substr(2,1);this.ownerR=t>=4&&t<=7,this.ownerW=2==t||3==t||6==t||7==t,this.ownerE=1==t||3==t||5==t||7==t,this.groupR=l>=4&&l<=7,this.groupW=2==l||3==l||6==l||7==l,this.groupE=1==l||3==l||5==l||7==l,this.publicR=a>=4&&a<=7,this.publicW=2==a||3==a||6==a||7==a,this.publicE=1==a||3==a||5==a||7==a},chmod(){this.dialog=!0,1===this.selected.length?this.data.mode=this.selected[0].permsn:this.data.mode="000",this.modeToCheckboxes()},doChmod(){this.fetching=!0;let e=[];this.selected.forEach((t=>e.push(t.id))),r.A.post("servers/"+this.serverId+"/files",{cmd:"chmod",mode:this.data.mode,recursive:this.data.recursive,files:e}).then((e=>{if(console.log(e),e.data.success)this.dialog=!1,this.$emit("complete");else{let t=e.data.error?e.data.error:e.data;this.$emit("error",t)}})).catch((e=>console.log(e))).finally((()=>this.fetching=!1))}}};const _=(0,p.A)(I,[["render",y]]);var W=_;const x={key:0};function U(e,t,l,d,o,s){const i=(0,a.g2)("v-icon"),r=(0,a.g2)("v-btn"),n=(0,a.g2)("v-card-title"),h=(0,a.g2)("v-autocomplete"),c=(0,a.g2)("v-checkbox"),u=(0,a.g2)("v-card-text"),p=(0,a.g2)("v-card"),m=(0,a.g2)("v-dialog");return l.selected.length?((0,a.uX)(),(0,a.CE)("div",x,[(0,a.bF)(r,{onClick:t[0]||(t[0]=e=>s.chown()),disabled:!l.selected,title:"Change owner",icon:""},{default:(0,a.k6)((()=>[(0,a.bF)(i,null,{default:(0,a.k6)((()=>t[6]||(t[6]=[(0,a.eW)("mdi:mdi-account")]))),_:1})])),_:1},8,["disabled"]),(0,a.bF)(m,{app:"",modelValue:o.dialog,"onUpdate:modelValue":t[5]||(t[5]=e=>o.dialog=e),"max-width":"600"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{loading:o.fetching,flat:""},{default:(0,a.k6)((()=>[(0,a.bF)(n,null,{default:(0,a.k6)((()=>t[7]||(t[7]=[(0,a.eW)(" File ownership ")]))),_:1}),(0,a.bF)(u,null,{default:(0,a.k6)((()=>[(0,a.bF)(h,{modelValue:o.data.owner,"onUpdate:modelValue":t[1]||(t[1]=e=>o.data.owner=e),label:"Owner",items:o.users,autofocus:"","hide-details":"",class:"mb-5"},null,8,["modelValue","items"]),(0,a.bF)(h,{modelValue:o.data.group,"onUpdate:modelValue":t[2]||(t[2]=e=>o.data.group=e),label:"Group",items:o.groups,"hide-details":"",class:"mb-5"},null,8,["modelValue","items"]),l.folderSelected?((0,a.uX)(),(0,a.Wv)(c,{key:0,modelValue:o.data.recursive,"onUpdate:modelValue":t[3]||(t[3]=e=>o.data.recursive=e),label:"Replace child permissions",class:"mb-5"},null,8,["modelValue"])):(0,a.Q3)("",!0),(0,a.bF)(r,{color:"primary",onClick:t[4]||(t[4]=e=>s.doChown())},{default:(0,a.k6)((()=>t[8]||(t[8]=[(0,a.eW)(" Save ")]))),_:1})])),_:1})])),_:1},8,["loading"])])),_:1},8,["modelValue"])])):(0,a.Q3)("",!0)}var A={props:{serverId:null,path:null,selected:null,folderSelected:null},watch:{path:function(e){this.data.path=e},selected:function(e){this.data.selected=e}},data(){return{fetching:!1,data:{recursive:!1},groups:[],users:[],error:"",dialog:!1}},methods:{chown(){this.dialog=!0,r.A.get("servers/"+this.serverId+"/usersAndGroups").then((e=>{this.groups=e.data.groups,this.users=e.data.users})),1===this.selected.length?(this.data.owner=this.selected[0].owner,this.data.group=this.selected[0].group):(this.data.owner="",this.data.group="")},doChown(){this.fetching=!0;let e=[];this.selected.forEach((t=>e.push(t.id))),r.A.post("servers/"+this.serverId+"/files",{cmd:"chown",owner:this.data.owner,group:this.data.group,recursive:this.data.recursive,files:e}).then((e=>{if(console.log(e),e.data.success)this.dialog=!1,this.$emit("complete");else{let t=e.data.error?e.data.error:e.data;this.$emit("error",t)}})).catch((e=>{console.log(e)})).finally((()=>{this.fetching=!1}))}}};const R=(0,p.A)(A,[["render",U]]);var D=R;const X={key:0};function $(e,t,l,d,o,s){const i=(0,a.g2)("v-icon"),r=(0,a.g2)("v-btn"),n=(0,a.g2)("v-text-field"),h=(0,a.g2)("v-card-text"),c=(0,a.g2)("v-card"),u=(0,a.g2)("v-dialog");return 1===l.selected.length?((0,a.uX)(),(0,a.CE)("div",X,[(0,a.bF)(r,{onClick:t[0]||(t[0]=e=>s.rename()),disabled:!l.selected,title:"Rename",icon:""},{default:(0,a.k6)((()=>[(0,a.bF)(i,null,{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)("mdi:mdi-rename-box")]))),_:1})])),_:1},8,["disabled"]),(0,a.bF)(u,{app:"",modelValue:o.dialog,"onUpdate:modelValue":t[2]||(t[2]=e=>o.dialog=e),"max-width":"600"},{default:(0,a.k6)((()=>[(0,a.bF)(c,{loading:o.fetching,title:"Rename"},{default:(0,a.k6)((()=>[(0,a.bF)(h,null,{default:(0,a.k6)((()=>[(0,a.bF)(n,{modelValue:o.data.newName,"onUpdate:modelValue":t[1]||(t[1]=e=>o.data.newName=e),label:"name",autofocus:""},null,8,["modelValue"]),(0,a.bF)(r,{color:"primary",onClick:s.doRename},{default:(0,a.k6)((()=>t[4]||(t[4]=[(0,a.eW)(" Save ")]))),_:1},8,["onClick"])])),_:1})])),_:1},8,["loading"])])),_:1},8,["modelValue"])])):(0,a.Q3)("",!0)}var Q={props:{serverId:null,path:null,selected:null},watch:{path:function(e){this.data.path=e},selected:function(e){this.data.selected=e}},data(){return{fetching:!1,data:{path:"",selected:[]},error:"",dialog:!1}},methods:{rename(){console.log(this.selected),this.dialog=!0,this.data.oldName=this.selected[0].name,this.data.newName=this.selected[0].name},doRename(){this.fetching=!0,r.A.post("servers/"+this.serverId+"/files",{cmd:"rename",path:this.path,old_name:this.data.oldName,new_name:this.data.newName}).then((e=>{if(console.log(e),e.data.success)this.dialog=!1,this.$emit("complete");else{let t=e.data.error?e.data.error:e.data;this.$emit("error",t)}})).catch((e=>console.log(e))).finally((()=>this.fetching=!1))}}};const S=(0,p.A)(Q,[["render",$]]);var L=S,N=l(65229);const O={key:0};function M(e,t,l,d,o,s){const i=(0,a.g2)("v-icon"),r=(0,a.g2)("v-btn"),n=(0,a.g2)("Confirm");return l.selected.length?((0,a.uX)(),(0,a.CE)("div",O,[(0,a.bF)(r,{onClick:t[0]||(t[0]=e=>s.deleteItem()),title:"Delete",icon:"",loading:o.fetching},{default:(0,a.k6)((()=>[(0,a.bF)(i,null,{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)("mdi:mdi-delete")]))),_:1})])),_:1},8,["loading"]),(0,a.bF)(n,{ref:"confirm"},null,512)])):(0,a.Q3)("",!0)}var T=l(26301),z={components:{Confirm:T.A},props:{serverId:null,path:null,selected:null},watch:{path:function(e){this.data.path=e},selected:function(e){this.data.selected=e}},data(){return{fetching:!1,error:"",data:{}}},methods:{deleteItem:async function(){if(!await this.$refs.confirm.open("Delete selected files?"))return;this.fetching=!0;let e=[];this.selected.forEach((t=>e.push(t.id))),r.A.post("servers/"+this.serverId+"/files",{cmd:"delete",files:e}).then((e=>{if(console.log(e),e.data.success)this.$emit("complete");else{let t=e.data.error?e.data.error:e.data;this.$emit("error",t)}})).catch((e=>{console.log(e)})).finally((()=>this.fetching=!1))}}};const P=(0,p.A)(z,[["render",M]]);var H=P;const q={key:0};function B(e,t,l,d,o,s){const i=(0,a.g2)("v-icon"),r=(0,a.g2)("v-btn");return 1===l.selected.length&&"file"===l.selected[0].type?((0,a.uX)(),(0,a.CE)("div",q,[(0,a.bF)(r,{onClick:t[0]||(t[0]=e=>s.download()),title:"Download",icon:""},{default:(0,a.k6)((()=>[(0,a.bF)(i,null,{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)("mdi:mdi-download")]))),_:1})])),_:1})])):(0,a.Q3)("",!0)}var G={props:{serverId:null,path:null,selected:null},watch:{path:function(e){this.data.path=e},selected:function(e){this.data.selected=e}},data(){return{fetching:!1,data:{},error:"",dialog:!1}},methods:{download(){window.open("https://serverwand.com/api/servers/"+this.serverId+"/files?d="+encodeURIComponent(this.selected[0].id))}}};const K=(0,p.A)(G,[["render",B]]);var j=K;function Z(e,t,l,d,o,s){const i=(0,a.g2)("v-btn"),r=(0,a.g2)("Confirm");return(0,a.uX)(),(0,a.CE)("div",null,[l.selected.length?((0,a.uX)(),(0,a.Wv)(i,{key:0,onClick:t[0]||(t[0]=e=>s.cut()),title:"Cut",icon:"mdi:mdi-content-cut"})):(0,a.Q3)("",!0),l.selected.length?((0,a.uX)(),(0,a.Wv)(i,{key:1,onClick:t[1]||(t[1]=e=>s.copy()),title:"Copy",icon:"mdi:mdi-content-copy"})):(0,a.Q3)("",!0),!o.data.items.length||l.path==o.data.src&&o.data.cut?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(i,{key:2,onClick:t[2]||(t[2]=e=>s.paste()),title:"Paste",icon:"mdi:mdi-content-paste"})),(0,a.bF)(r,{ref:"confirm"},null,512)])}var J={components:{Confirm:T.A},props:{serverId:null,path:null,selected:null},watch:{path:function(e){this.data.path=e},selected:function(e){this.data.selected=e}},data(){return{fetching:!1,data:{items:[],cut:!1,src:""},error:"",dialog:!1}},methods:{cut(){this.copy(!0)},copy(e){this.data.cut=!!e,this.data.src=this.path,this.data.items=[],this.selected.forEach((e=>this.data.items.push(e.name)))},paste:async function(){console.log(this.data);let e=this.data.cut?"Move":"Copy";await this.$refs.confirm.open(e+" "+this.data.items.length+" items?")&&(this.fetching=!0,this.$emit("error",null),r.A.post("servers/"+this.serverId+"/files",{cmd:e.toLowerCase(),path:this.path,src:this.data.src,files:this.data.items}).then((t=>{if(console.log(t),"move"===e.toLowerCase()&&(this.data.items=[]),t.data.success)this.$emit("complete");else{let e=t.data.error?t.data.error:t.data;this.$emit("error",e)}})).catch((e=>console.log(e))).finally((()=>this.fetching=!1)))}}};const Y=(0,p.A)(J,[["render",Z]]);var ee=Y,te=l(30247);function le(e,t,l,d,s,i){const r=(0,a.g2)("v-alert"),n=(0,a.g2)("v-icon"),h=(0,a.g2)("v-btn");return(0,a.uX)(),(0,a.CE)("div",null,[s.msg?((0,a.uX)(),(0,a.Wv)(r,{key:0,dark:"",style:{position:"fixed",width:"100%","z-index":"10",left:"0",bottom:"0",margin:"0 auto"},type:"info"},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(s.msg),1)])),_:1})):(0,a.Q3)("",!0),1===l.selected?.length&&-1!==["zip","gz","tar"].indexOf(i.fileExtension(l.selected[0]))?((0,a.uX)(),(0,a.Wv)(h,{key:1,onClick:t[0]||(t[0]=e=>i.extract()),disabled:!l.selected,title:"Extract",icon:""},{default:(0,a.k6)((()=>[(0,a.bF)(n,null,{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)("mdi:mdi-folder-zip-outline")]))),_:1})])),_:1},8,["disabled"])):(0,a.Q3)("",!0)])}var ae={props:{serverId:null,path:null,selected:null},watch:{path:function(e){this.data.path=e},selected:function(e){this.data.selected=e}},data(){return{data:{recursive:!1},error:"",dialog:!1,msg:""}},methods:{fileExtension(e){var t=e.name.lastIndexOf(".");return-1===t?"":e.name.substr(t+1,e.name.length)},extract(){this.$emit("loading",!0),r.A.event("servers/"+this.serverId+"/files?cmd=extract&id="+encodeURIComponent(this.selected[0].id),(e=>{this.msg=e.msg}),(e=>this.$emit("error",e)),(()=>{this.msg="",this.$emit("complete")}))}}};const de=(0,p.A)(ae,[["render",le]]);var oe=de;const se={key:0};function ie(e,t,l,d,o,s){const i=(0,a.g2)("v-icon"),r=(0,a.g2)("v-btn"),n=(0,a.g2)("v-alert"),h=(0,a.g2)("v-toolbar"),c=(0,a.g2)("MonacoEditor"),u=(0,a.g2)("v-card-text"),p=(0,a.g2)("v-card"),m=(0,a.g2)("v-dialog");return 1===l.selected.length?((0,a.uX)(),(0,a.CE)("div",se,[1===l.selected?.length&&"file"===l.selected[0].type?((0,a.uX)(),(0,a.Wv)(r,{key:0,onClick:t[0]||(t[0]=e=>s.tail()),disabled:!l.selected,title:"Tail",icon:""},{default:(0,a.k6)((()=>[(0,a.bF)(i,null,{default:(0,a.k6)((()=>t[4]||(t[4]=[(0,a.eW)("mdi:mdi-format-align-bottom")]))),_:1})])),_:1},8,["disabled"])):(0,a.Q3)("",!0),o.error?((0,a.uX)(),(0,a.Wv)(n,{key:1,type:"error",text:o.error},null,8,["text"])):(0,a.Q3)("",!0),(0,a.bF)(m,{modelValue:o.dialog,"onUpdate:modelValue":t[3]||(t[3]=e=>o.dialog=e),fullscreen:""},{default:(0,a.k6)((()=>[(0,a.bF)(p,{loading:o.fetching,style:{height:"95vh"}},{default:(0,a.k6)((()=>[(0,a.bF)(h,{title:o.data.id},{append:(0,a.k6)((()=>[(0,a.bF)(r,{onClick:t[1]||(t[1]=e=>o.dialog=!1),icon:"mdi:mdi-close"})])),_:1},8,["title"]),(0,a.bF)(u,null,{default:(0,a.k6)((()=>[(0,a.bF)(c,{class:"editor",ref:"editor",language:o.language,value:o.data.content,"onUpdate:value":t[2]||(t[2]=e=>o.data.content=e),theme:"vs-dark"},null,8,["language","value"])])),_:1})])),_:1},8,["loading"])])),_:1},8,["modelValue"])])):(0,a.Q3)("",!0)}var re=l(12547),ne={components:{MonacoEditor:re.A},props:{serverId:null,path:null,selected:null},watch:{path:function(e){this.data.path=e},selected:function(e){this.data.selected=e}},data(){return{fetching:!1,data:{path:"",selected:[]},error:"",dialog:!1,language:"javascript"}},methods:{basename(e){return e.split(/[\\/]/).pop()},tail(){this.$emit("loading",!0);let e=this.selected[0];return r.A.post("servers/"+this.serverId+"/files",{cmd:"tail",id:e.id}).then((t=>{console.log(t),!1!==t.data.success?(this.data.id=e.id,this.data.file=this.basename(e.id),this.data.content=t.data.content,this.dialog=!0):this.$emit("error",t.data.error)})).catch((e=>console.log(e))).finally((()=>{this.fetching=!1,this.$emit("loading",!1)}))}}};const he=(0,p.A)(ne,[["render",ie]]);var ce=he,ue={components:{Loading:h.A,NewFile:g,NewFolder:k,NewLink:E,Chmod:W,Chown:D,Rename:L,EditFile:N.A,DeleteFiles:H,Download:j,Clipboard:ee,Upload:te.A,Extract:oe,Tail:ce},data(){return{path:"/",search:"",error:"",items:[],server:{},data:{},loading:!1,fetching:!1,userHashChange:!0,serverId:0,selectedIds:[],folderSelected:!1,headers:[{title:"",key:""},{title:"Name",key:"name"},{title:"Size",key:"size",class:"d-none d-sm-table-cell",cellClass:"d-none d-sm-table-cell"},{title:"Date modified",key:"modified",class:"d-none d-sm-table-cell",cellClass:"d-none d-sm-table-cell"},{title:"Permissions",key:"perms",class:"d-none d-sm-table-cell",cellClass:"d-none d-sm-table-cell"},{title:"Owner",key:"owner",class:"d-none d-sm-table-cell",cellClass:"d-none d-sm-table-cell"},{title:"Destination",key:"dest",class:"d-none d-sm-table-cell",cellClass:"d-none d-sm-table-cell"}],fileToOpen:"",page:1}},computed:{dir:function(){let e=this.path;if(!e.endsWith("/")){let t=e.lastIndexOf("/");-1!==t&&(e=e.substr(0,t))}return e},selected:function(){let e=[];return this.selectedIds.forEach((t=>{let l=this.items.find((e=>e.id===t));l&&e.push(l)})),e}},watch:{path:{handler:function(e){window.ssh_path=e,this.selectedIds=[],this.userHashChange=!1,location.hash=e}},selected:function(e){let t=!1;e.forEach((e=>{"folder"===e.type&&(t=!0)})),this.folderSelected=t}},created(){if(this.serverId=this.$route.params.id,window.onhashchange=()=>{this.userHashChange?(this.path=location.hash.substr(1),this.fetchData()):this.userHashChange=!0},location.hash){this.path=location.hash.substr(1);let e=this.basename(this.path);-1!==e.indexOf(".")&&(this.fileToOpen=e)}this.fetchData()},methods:{basename(e){return e.split(/[\\/]/).pop()},fetchData(){this.error="",this.fetching=!0,this.page=1,this.search?(this.items=[],r.A.event("servers/"+this.serverId+"/files?path="+encodeURIComponent(this.dir)+"&search="+encodeURIComponent(this.search),(e=>{let t=e.msg.split("\n");t.forEach((e=>{let t=!1;this.items.forEach((l=>{l.id===e&&(t=!0)})),t||this.items.push({id:e,name:this.basename(e),type:"file"})}))}),(e=>this.error=e),(()=>this.fetching=!1))):r.A.post("servers/"+this.serverId+"/files",{path:this.dir}).then((e=>{console.log(e),e.data.error?this.error=e.data.error:(this.server=e.data.item,this.page=1,this.items=[],e.data.files.forEach((e=>{let t={...e};t.selected=!0,this.items.push(t)})),document.title="Files | "+this.server.name)})).catch((e=>{console.log(e)})).finally((()=>{if(this.fetching=!1,this.selectedIds=[],this.fileToOpen){let e=this.fileToOpen,t=1;if(-1!==e.indexOf(":")){let l=e.split(":");e=l[0],t=l[1]}this.items.forEach((async l=>{l.name===e&&(this.fileToOpen="",await this.$refs.editFile.open(l),this.$refs.editFile.goToLine(t))}))}}))},open(e){this.error="","folder"===e.type||"link"===e.type?(this.path=e.id,this.fetchData()):"file"===e.type&&this.$refs.editFile.open(e)},upLevel(){this.search="";let e=this.path.substr(0,this.path.length-1).lastIndexOf("/");-1!==e&&(this.path=this.path.substr(0,e+1),this.dir||(this.path="/")),this.fetchData()},handleError(e){this.error=e},handleLoading(e){this.fetching=e},prettyBytes(e){return n.A.prettyBytes(e)},formatDate(e){return n.A.formatDate(e)},updatePage(e){this.page=e},rowProps(e){if(this.selected.find((t=>t.id===e.item.id)))return{class:"bg-primary"}}}};const pe=(0,p.A)(ue,[["render",i]]);var me=pe}}]);
//# sourceMappingURL=2299.1470d7c5.js.map