"use strict";(self["webpackChunkServerWand"]=self["webpackChunkServerWand"]||[]).push([[2542],{84285:function(e,t,a){a.d(t,{Z:function(){return c}});var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{persistent:"",content:"","content-class":"centered-dialog"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[a("v-container",{attrs:{"fill-height":""}},[a("v-card",{attrs:{color:"primary",dark:""}},[a("v-card-text",[a("v-layout",{attrs:{row:""}},[a("i",{staticClass:"fas fa-magic fa-2x faa-horizontal animated"}),a("h2",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.message))])])],1)],1)],1)],1)},n=[],r={name:"Loading",data:function(){return{}},props:{value:{type:Boolean,default:!1},message:{type:String,default:"Summoning..."}}},o=r,i=a(1001),l=(0,i.Z)(o,s,n,!1,null,null,null),c=l.exports},72542:function(e,t,a){a.r(t),a.d(t,{default:function(){return S}});var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.error?a("v-alert",{attrs:{type:"error"}},[e._v(" "+e._s(e.error)+" ")]):e._e(),e.message?a("v-alert",{attrs:{type:"info"}},[e._v(" "+e._s(e.message)+" ")]):e._e(),a("Loading",{attrs:{value:e.loading}}),a("EditFile",{ref:"editFile",attrs:{serverId:e.serverId,path:e.path,selected:e.selected,action:"backups",save:"false"},on:{complete:function(t){return e.list()},error:e.handleError}}),a("v-card",{staticClass:"pa-3"},[a("v-row",[a("v-col",{staticClass:"flex-grow-0"},[a("v-btn",{attrs:{title:"Configure S3"},on:{click:e.configure}},[a("v-icon",[e._v("settings")])],1)],1),e.s3.access_key?a("v-col",{staticClass:"flex-grow-0"},[a("Snapshot",{attrs:{serverId:e.serverId},on:{complete:e.handleComplete,error:e.handleError}})],1):e._e(),a("v-col",[a("v-switch",{staticClass:"my-0",attrs:{label:"Nightly backups"},on:{change:function(t){return e.toggleBackups()}},model:{value:e.s3.active,callback:function(t){e.$set(e.s3,"active",t)},expression:"s3.active"}})],1)],1)],1),a("v-card",{attrs:{loading:e.fetching}},[a("v-container",{attrs:{fluid:""}},[a("v-row",[a("v-col",{staticClass:"flex-grow-0"},[a("Restore",{attrs:{serverId:e.serverId,path:e.path,selected:e.selected},on:{complete:e.handleComplete,error:e.handleError}})],1)],1),e.s3.access_key?a("div",["/"!==e.path?a("div",[a("v-row",[a("v-col",{staticClass:"flex-grow-0"},[a("v-btn",{attrs:{icon:"",disabled:"/"===e.path},on:{click:function(t){return e.upLevel()}}},[a("v-icon",{attrs:{small:""}},[e._v("arrow_upward")])],1)],1),a("v-col",[a("v-text-field",{staticClass:"ma-0 pa-0",on:{change:e.list,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.list.apply(null,arguments)}},model:{value:e.path,callback:function(t){e.path=t},expression:"path"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-data-table",{ref:"results",staticClass:"results",attrs:{headers:e.headers,items:e.items,"mobile-breakpoint":"0","show-select":""},on:{"click:row":e.open},scopedSlots:e._u([{key:"item.modified",fn:function(t){var a=t.item;return[e._v(" "+e._s(e._f("formatDate")(a.modified))+" ")]}}],null,!1,1414384129),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)],1)],1):a("div",[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-data-table",{attrs:{headers:e.backupHeaders,items:e.backups,"mobile-breakpoint":"0"},on:{"click:row":e.browse},scopedSlots:e._u([{key:"item.name",fn:function(t){var s=t.item;return[a("span",{on:{click:function(t){return e.browse(s)}}},[e._v(e._s(s.name))])]}},{key:"item.timestamp",fn:function(t){var a=t.item;return[e._v(" "+e._s(e._f("formatDate")(a.timestamp))+" ")]}},{key:"item.complete",fn:function(t){var a=t.item;return[e._v(" "+e._s(a.complete?"Complete":"Incomplete")+" ")]}},{key:"item.automatic",fn:function(t){var a=t.item;return[e._v(" "+e._s(a.automatic?"Automatic":"Manual")+" ")]}},{key:"item.duration",fn:function(t){var a=t.item;return[e._v(" "+e._s(Math.round(a.duration/60))+"m ")]}},{key:"item.size",fn:function(t){var a=t.item;return[e._v(" "+e._s(e._f("prettyBytes")(a.size))+" ")]}},{key:"item.actions",fn:function(t){var s=t.item;return[a("v-btn",{attrs:{icon:"",disabled:e.loading,loading:e.loading},on:{click:[function(t){return e.deleteSnapshot(s.name)},function(e){e.stopPropagation()}]}},[a("v-icon",{attrs:{small:""}},[e._v("delete")])],1)]}}],null,!1,3975779090)})],1)],1)],1)]):e._e()],1)],1),a("v-navigation-drawer",{attrs:{app:"",temporary:"",right:""},model:{value:e.s3Drawer,callback:function(t){e.s3Drawer=t},expression:"s3Drawer"}},[a("v-card",[a("v-card-title",[e._v(" S3 Settings ")]),a("v-card-text",[a("v-select",{attrs:{items:e.hosts,label:"Host"},model:{value:e.s3.host,callback:function(t){e.$set(e.s3,"host",t)},expression:"s3.host"}}),a("v-text-field",{attrs:{label:"Access Key",required:""},model:{value:e.s3.access_key,callback:function(t){e.$set(e.s3,"access_key",t)},expression:"s3.access_key"}}),a("v-text-field",{attrs:{label:"Secret Key",required:""},model:{value:e.s3.secret_key,callback:function(t){e.$set(e.s3,"secret_key",t)},expression:"s3.secret_key"}}),a("v-text-field",{attrs:{label:"Bucket",required:""},model:{value:e.s3.bucket,callback:function(t){e.$set(e.s3,"bucket",t)},expression:"s3.bucket"}}),a("v-btn",{attrs:{disabled:e.fetching,loading:e.loading,color:"success"},on:{click:e.save}},[e._v(" Save ")])],1)],1)],1)],1)},n=[],r=(a(41539),a(68309),a(54747),a(4296)),o=a(84285),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.selected.length?a("div",[a("v-btn",{attrs:{title:"Restore"},on:{click:function(t){return e.restore()}}},[a("v-icon",[e._v("restore")])],1)],1):e._e()},l=[],c={props:{serverId:null,path:null,selected:null},watch:{path:function(e){this.data.path=e},selected:function(e){this.data.selected=e}},data:function(){return{fetching:!1,data:{},error:"",dialog:!1}},methods:{restore:function(){var e=this;this.$confirm("Restore selected files?").then((function(t){if(t){var a=e;e.fetching=!0;var s=[];e.selected.forEach((function(e){s.push(e.name)})),r.Z.post("servers/"+e.serverId+"/backups",{cmd:"restore",path:e.path,files:s}).then((function(e){if(console.log(e),e.data.success)a.$emit("complete",e.data.result);else{var t=e.data.error?e.data.error:e.data;a.$emit("error",t)}})).catch((function(e){return console.log(e)})).finally((function(){return a.fetching=!1}))}}))}}},u=c,d=a(1001),h=(0,d.Z)(u,i,l,!1,null,null,null),v=h.exports,f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-btn",{attrs:{title:"Create snapshot"},on:{click:e.newSnapshot}},[a("v-icon",[e._v("backup")])],1),a("v-dialog",{attrs:{app:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",{attrs:{loading:e.fetching}},[a("v-card-title",[e._v(" Snapshot ")]),a("v-card-text",[a("v-text-field",{attrs:{label:"Name",autofocus:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),a("v-btn",{attrs:{color:"primary",disabled:0===e.name.length},on:{click:e.createSnapshot}},[e._v(" Create snapshot ")])],1)],1)],1),a("v-dialog",{attrs:{app:"",scrollable:"",persistent:""},model:{value:e.showMessage,callback:function(t){e.showMessage=t},expression:"showMessage"}},[a("v-card",{attrs:{loading:e.fetching}},[a("v-card-title",[e._v(" Response ")]),a("v-card-text",{attrs:{id:"messageBody"}},[a("v-textarea",{attrs:{value:e.message,readonly:"","auto-grow":"",loading:e.fetching}})],1),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{disabled:e.fetching},on:{click:function(t){e.$emit("closed"),e.showMessage=!1}}},[e._v(" Close ")])],1)],1)],1)],1)},p=[],m={props:{serverId:null},data:function(){return{message:"",fetching:!1,name:"",dialog:!1,showMessage:!1}},methods:{newSnapshot:function(){this.dialog=!0},createSnapshot:function(){var e=this;this.$confirm("Create snapshot?").then((function(t){if(t){var a=e;e.fetching=!0,r.Z.post("servers/"+e.serverId+"/backups",{cmd:"snapshot",name:e.name}).then((function(e){if(console.log(e),a.dialog=!1,e.data.success)a.$emit("complete",e.data.result);else{var t=e.data.error?e.data.error:e.data;a.$emit("error",t)}})).catch((function(e){return console.log(e)})).finally((function(){return a.fetching=!1}))}}))}}},g=m,k=(0,d.Z)(g,f,p,!1,null,null,null),b=k.exports,_=a(32724),x={components:{Loading:o.Z,Restore:v,Snapshot:b,EditFile:_.Z},data:function(){return{path:"/",error:"",message:"",backups:[],items:[],data:{},details:"",loading:!1,fetching:!1,serverId:0,s3Drawer:!1,s3:{access_key:"",active:!1},selected:[],hosts:[{text:"AWS",value:""},{text:"Linode (Atlanta, GA)",value:"https://us-southeast-1.linodeobjects.com"},{text:"Linode (Frankfurt, DE)",value:"https://eu-central-1.linodeobjects.com"},{text:"Linode (Newark, NJ)",value:"https://us-east-1.linodeobjects.com"},{text:"Linode (Singapore, SG)",value:"https://ap-south-1.linodeobjects.com"},{text:"Digital Ocean (NYC3)",value:"https://nyc3.digitaloceanspaces.com"},{text:"Digital Ocean (SFO3)",value:"https://sfo3.digitaloceanspaces.com"},{text:"Digital Ocean (AMS3)",value:"https://ams3.digitaloceanspaces.com"},{text:"Digital Ocean (SGP1)",value:"https://sgp1.digitaloceanspaces.com"},{text:"Digital Ocean (FRA1)",value:"https://fra1.digitaloceanspaces.com"},{text:"Vultr",value:"https://ewr1.vultrobjects.com"}],headers:[{text:"Name ",value:"name"},{text:"Size ",value:"size"},{text:"Last modified ",value:"modified"}],backupHeaders:[{text:"Name",value:"name"},{text:"Date",value:"date"},{text:"Status",value:"complete",class:"d-none d-sm-table-cell",cellClass:"d-none d-sm-table-cell"},{text:"Type",value:"automatic",class:"d-none d-sm-table-cell",cellClass:"d-none d-sm-table-cell"},{text:"Duration",value:"duration",class:"d-none d-sm-table-cell",cellClass:"d-none d-sm-table-cell"},{text:"Size",value:"size",class:"d-none d-sm-table-cell",cellClass:"d-none d-sm-table-cell"},{text:" ",value:"action"}]}},watch:{items:{handler:function(e){this.selected=[];for(var t=0;t<e.length;t++)e[t].selected&&this.selected.push(e[t])},deep:!0},path:{handler:function(e){window.ssh_path=e}}},created:function(){this.serverId=this.$route.params.id,this.fetchData()},methods:{fetchData:function(){var e=this;this.error="",this.message="",this.fetching=!0,r.Z.post("servers/"+this.serverId+"/backups",{path:this.path}).then((function(t){console.log(t),t.data.error?e.error=t.data.error:(e.s3=t.data.s3,e.server=t.data.item,t.data.backups&&t.data.backups.length&&(e.backups=t.data.backups),document.title="Backups | "+e.server.name,e.list())})).catch((function(e){console.log(e)})).finally((function(){e.fetching=!1}))},browse:function(e){this.path="/"+e.name,this.list()},list:function(){var e=this;this.error="",this.message="",this.fetching=!0,r.Z.post("servers/"+this.serverId+"/backups?cmd=list",{path:this.path}).then((function(t){console.log(t),t.data.error?e.error=t.data.error:(e.items=[],t.data.files.forEach((function(t){e.items.push({id:t.id,name:t.name,size:t.size?t.size:0,type:t.type,modified:t.modified,perms:t.perms,permsn:t.permsn,owner:t.owner,group:t.group,selected:!1})})))})).catch((function(e){console.log(e)})).finally((function(){e.fetching=!1}))},open:function(e){"folder"===e.type||"link"===e.type?(this.path=e.id,this.list()):"file"===e.type&&this.$refs.editFile.open(e)},upLevel:function(){console.log(this.path);var e=this.path.lastIndexOf("/");-1!==e&&(this.path=this.path.substr(0,e),this.path||(this.path="/")),this.list()},configure:function(){this.s3Drawer=!0},save:function(){var e=this;this.fetching=!0,r.Z.post("servers/"+this.serverId+"/backups",this.s3).then((function(){e.fetchData(),e.s3Drawer=!1})).catch((function(t){console.log(t),e.fetching=!1}))},deleteSnapshot:function(e){var t=this;return this.$confirm("Delete "+e+"?").then((function(a){if(a){var s=t;t.fetching=!0,t.error="",r.Z.post("servers/"+t.serverId+"/backups",{cmd:"deleteSnapshot",name:e}).then((function(e){console.log(e),e.data.success?s.fetchData():(s.error=e.data.error,s.fetching=!1)})).catch((function(e){console.log(e),s.fetching=!1}))}})),!1},handleError:function(e){this.error=e},handleComplete:function(e){console.log(e),this.message=e},toggleBackups:function(){var e=this;this.fetching=!0,this.error="",r.Z.post("servers/"+this.serverId+"/backups",{active:this.s3.active}).then((function(t){console.log(t),t.data.success?e.fetchData():e.error=t.data.error})).catch((function(e){console.log(e)})).finally((function(){e.fetching=!1}))}}},y=x,w=(0,d.Z)(y,s,n,!1,null,null,null),S=w.exports}}]);
//# sourceMappingURL=2542-legacy.9a3b7c13.js.map