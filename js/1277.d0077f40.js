"use strict";(self["webpackChunkServerWand"]=self["webpackChunkServerWand"]||[]).push([[1277],{84285:function(t,a,e){e.d(a,{Z:function(){return c}});var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-dialog",{attrs:{persistent:"",content:"","content-class":"centered-dialog"},model:{value:t.value,callback:function(a){t.value=a},expression:"value"}},[e("v-container",{attrs:{"fill-height":""}},[e("v-card",{attrs:{color:"primary",dark:""}},[e("v-card-text",[e("v-layout",{attrs:{row:""}},[e("i",{staticClass:"fas fa-magic fa-2x faa-horizontal animated"}),e("h2",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t.message))])])],1)],1)],1)],1)},s=[],n={name:"Loading",data:()=>({}),props:{value:{type:Boolean,default:!1},message:{type:String,default:"Summoning..."}}},r=n,l=e(1001),o=(0,l.Z)(r,i,s,!1,null,null,null),c=o.exports},91277:function(t,a,e){e.r(a),e.d(a,{default:function(){return u}});var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[t.error?e("v-alert",{attrs:{type:"error"}},[t._v(" "+t._s(t.error)+" ")]):t._e(),e("Loading",{attrs:{value:t.loading}}),e("v-card",{staticClass:"pa-3",attrs:{loading:t.fetching}},[e("v-list",[e("v-list-item-group",[t._l(t.data.aliases,(function(a,i){return[e("v-list-item",{key:"item-"+i,attrs:{value:a},scopedSlots:t._u([{key:"default",fn:function(){return[e("v-list-item-content",[e("v-list-item-title",[t._v(" "+t._s(a.domain)+" ")]),e("v-list-item-subtitle",[a.redirect?e("span",[t._v(" Redirect ")]):e("span",[t._v(" Alias ")])])],1),a.dns.A!=t.data.server.ip?e("v-list-item-action",[e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(i){var s=i.on;return[e("v-btn",t._g({attrs:{icon:""},on:{click:function(e){return t.fixAliasDns(a.domain)}}},s),[e("v-icon",{attrs:{small:""}},[t._v("build")])],1)]}}],null,!0)},[e("span",[t._v("Fix DNS mismatch ("+t._s(a.dns.A)+" => "+t._s(t.data.server.ip)+")")])])],1):t._e(),e("v-list-item-action",[e("v-btn",{attrs:{icon:"",disabled:t.fetching,loading:t.fetching},on:{click:function(e){return t.deleteAlias(a.domain)}}},[e("v-icon",{attrs:{small:""}},[t._v("delete")])],1)],1)]},proxy:!0}],null,!0)})]}))],2)],1)],1),e("v-card",[e("div",[e("v-card-title",{attrs:{"primary-title":""}},[e("v-btn",{on:{click:function(a){return t.addAlias()}}},[t._v(" Add domain alias ")])],1)],1)]),e("v-navigation-drawer",{attrs:{temporary:"",right:"",app:""},model:{value:t.drawer,callback:function(a){t.drawer=a},expression:"drawer"}},[e("v-card",[e("v-card-title",[t._v(" Domain alias ")]),e("v-card-text",[e("v-text-field",{attrs:{label:"Alias",required:""},model:{value:t.alias.alias,callback:function(a){t.$set(t.alias,"alias",a)},expression:"alias.alias"}}),e("v-checkbox",{attrs:{label:"Configure DNS",disabled:""==t.data.server.dns},model:{value:t.alias.dns,callback:function(a){t.$set(t.alias,"dns",a)},expression:"alias.dns"}}),e("v-checkbox",{attrs:{label:"Redirect"},model:{value:t.alias.redirect,callback:function(a){t.$set(t.alias,"redirect",a)},expression:"alias.redirect"}}),e("v-btn",{attrs:{disabled:t.fetching,loading:t.fetching,color:"success"},on:{click:t.submitAlias}},[t._v(" Save ")])],1)],1)],1)],1)},s=[],n=e(4296),r=e(84285),l={components:{Loading:r.Z},data(){return{siteId:null,post:null,error:null,data:{disk_usage:0,server:{},app:{}},details:"",loading:!1,fetching:!1,passwordPanel:[!1],passwordFormValid:!0,rules:{required:t=>!!t||"Required.",min:t=>t.length>=8||"Min 8 characters",emailMatch:()=>"The email and password you entered don't match"},alias:{alias:"",redirect:!1,dns:!1},drawer:!1,timer:null}},created(){this.fetchData()},watch:{$route:"fetchData"},methods:{fetchData(){var t=this;this.error="",this.siteId=this.$route.params.id,clearTimeout(t.timer),this.fetching=!0,n.Z.get("sites/"+this.siteId+"/aliases").then((function(a){console.log(a),t.data=a.data.item,document.title="Aliases | "+t.data.domain,t.data.aliases.forEach((a=>{if(a.dns.updating)return console.log("checking dns"),void(t.timer=setTimeout(t.fetchData,6e4))}))})).catch((function(t){console.log(t)})).finally((function(){t.fetching=!1}))},addAlias(){this.alias={},this.drawer=!0},submitAlias(){this.saveAlias()},saveAlias(t){var a,e=this;this.alias.alias&&(this.details="",this.fetching=!0,this.error="",!t&&this.alias.dns&&(a=window.open("/loading")),console.log(this.alias),n.Z.post("sites/"+this.siteId+"/aliases",this.alias).then((function(i){if(console.log(i),i.data.success)a&&a.close(),e.drawer=!1,e.fetchData();else if("auth"!=i.data.error||t)e.error=i.data.error;else{a.location="https://serverwand.com/account/services/"+e.data.server.dns;var s=setInterval((function(){if(a.closed)return clearInterval(s),void e.saveAlias(!0)}),500)}})).catch((function(t){console.log(t),e.fetching=!1})).finally((function(){e.fetching=!1})))},deleteAlias(t){this.$confirm("Delete "+t+"?").then((a=>{if(a){var e=this;this.fetching=!0,this.error="",n.Z.post("sites/"+this.siteId+"/aliases",{delete:1,alias:t}).then((function(t){console.log(t),t.data.success?e.fetchData():e.error=t.data.error})).catch((function(t){console.log(t),e.fetching=!1}))}}))},fixAliasDns(t,a){var e=this;this.details="",this.fetching=!0,this.error="",n.Z.post("sites/"+e.siteId+"/fixaliasdns",{alias:t}).then((function(i){if(console.log(i),i.data.success)e.fetchData();else if("auth"!=i.data.error||a)e.error=i.data.error;else var s=window.open("https://serverwand.com/account/services/"+e.data.server.dns),n=setInterval((function(){if(s.closed)return clearInterval(n),void e.fixAliasDns(t,!0)}),500)})).catch((function(t){console.log(t),e.fetching=!1})).finally((function(){e.fetching=!1}))}}},o=l,c=e(1001),d=(0,c.Z)(o,i,s,!1,null,null,null),u=d.exports}}]);
//# sourceMappingURL=1277.d0077f40.js.map