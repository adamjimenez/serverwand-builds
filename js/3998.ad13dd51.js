"use strict";(self["webpackChunkServerWand"]=self["webpackChunkServerWand"]||[]).push([[3998],{81815:function(e,a,t){t.d(a,{A:function(){return s}});var l=t(20641);function r(e,a,t,r,d,o){const i=(0,l.g2)("v-icon"),s=(0,l.g2)("v-alert"),n=(0,l.g2)("v-dialog");return(0,l.uX)(),(0,l.Wv)(n,{modelValue:e.show,"onUpdate:modelValue":a[0]||(a[0]=a=>e.show=a),persistent:"",width:"600"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{title:t.message,color:"primary"},{prepend:(0,l.k6)((()=>[(0,l.bF)(i,{icon:"fas fa-magic fa-2x faa-horizontal animated"})])),_:1},8,["title"])])),_:1},8,["modelValue"])}var d={name:"Loading",data:()=>({show:!1}),props:{value:{type:Boolean,default:!1},message:{type:String,default:"Summoning..."}},watch:{value:function(e){this.show=e}}},o=t(66262);const i=(0,o.A)(d,[["render",r]]);var s=i},33998:function(e,a,t){t.r(a),t.d(a,{default:function(){return c}});var l=t(20641);const r={key:2},d={key:3},o={key:0},i=["innerHTML"];function s(e,a,t,s,n,u){const v=(0,l.g2)("v-alert"),m=(0,l.g2)("Loading"),p=(0,l.g2)("v-card-subtitle"),c=(0,l.g2)("v-list"),h=(0,l.g2)("v-select"),g=(0,l.g2)("v-text-field"),b=(0,l.g2)("v-checkbox"),k=(0,l.g2)("v-btn"),f=(0,l.g2)("v-form"),V=(0,l.g2)("v-card-text"),y=(0,l.g2)("v-card"),I=(0,l.g2)("v-icon"),_=(0,l.g2)("v-progress-linear"),w=(0,l.g2)("v-dialog"),F=(0,l.g2)("v-card-title"),U=(0,l.g2)("v-navigation-drawer");return(0,l.uX)(),(0,l.CE)("div",null,[e.error?((0,l.uX)(),(0,l.Wv)(v,{key:0,type:"error",text:e.error},null,8,["text"])):(0,l.Q3)("",!0),(0,l.bF)(m,{value:e.loading},null,8,["value"]),(0,l.bF)(y,{loading:e.fetching,class:"pb-5",title:"Server details"},{default:(0,l.k6)((()=>[e.serverId?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(p,{key:0},{default:(0,l.k6)((()=>a[19]||(a[19]=[(0,l.eW)(" Choose a VPS provider below or connect to a server freshly installed with Ubuntu ")]))),_:1})),(0,l.bF)(V,null,{default:(0,l.k6)((()=>[e.serverId?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(c,{key:0,items:e.items,"onClick:select":u.getOptions},null,8,["items","onClick:select"])),e.data.provider||e.serverId?((0,l.uX)(),(0,l.Wv)(f,{key:1,ref:"form",modelValue:e.valid,"onUpdate:modelValue":a[13]||(a[13]=a=>e.valid=a),class:"mt-5"},{default:(0,l.k6)((()=>[e.unclaimed.length?((0,l.uX)(),(0,l.Wv)(h,{key:0,modelValue:e.data.unclaimed,"onUpdate:modelValue":a[0]||(a[0]=a=>e.data.unclaimed=a),items:e.unclaimed,label:"Server"},null,8,["modelValue","items"])):(0,l.Q3)("",!0),(0,l.bF)(g,{modelValue:e.data.name,"onUpdate:modelValue":a[1]||(a[1]=a=>e.data.name=a),label:"Name",rules:[e.rules.required,e.rules.alphanumeric],required:""},null,8,["modelValue","rules"]),"custom"===e.data.provider||this.serverId>0?((0,l.uX)(),(0,l.Wv)(g,{key:1,modelValue:e.data.ip,"onUpdate:modelValue":a[2]||(a[2]=a=>e.data.ip=a),rules:[e.rules.required,e.rules.ip],label:"Server IP"},null,8,["modelValue","rules"])):(0,l.Q3)("",!0),"custom"===e.data.provider||"vultr"===e.data.provider||e.unclaimed.length?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",r,[e.serverId?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(h,{key:0,modelValue:e.data.region,"onUpdate:modelValue":a[3]||(a[3]=a=>e.data.region=a),items:e.regions,label:"Region"},null,8,["modelValue","items"])),e.serverId?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(h,{key:1,modelValue:e.data.type,"onUpdate:modelValue":a[4]||(a[4]=a=>e.data.type=a),items:e.types,label:"Type"},null,8,["modelValue","items"])),!e.serverId&&e.images.length?((0,l.uX)(),(0,l.Wv)(h,{key:2,modelValue:e.data.image,"onUpdate:modelValue":a[5]||(a[5]=a=>e.data.image=a),items:e.images,label:"Image"},null,8,["modelValue","items"])):(0,l.Q3)("",!0)])),"custom"==e.data.provider||"vultr"==e.data.provider?((0,l.uX)(),(0,l.CE)("div",d,[(0,l.bF)(g,{disabled:e.serverId>0,modelValue:e.data.hostname,"onUpdate:modelValue":a[6]||(a[6]=a=>e.data.hostname=a),label:"Host name",rules:[e.rules.required],required:""},null,8,["disabled","modelValue","rules"]),"custom"==e.data.provider?((0,l.uX)(),(0,l.CE)("div",o,[(0,l.bF)(g,{disabled:e.serverId>0,modelValue:e.data.user,"onUpdate:modelValue":a[7]||(a[7]=a=>e.data.user=a),label:"Username",rules:[e.rules.required],required:""},null,8,["disabled","modelValue","rules"]),(0,l.bF)(g,{type:"password",disabled:e.serverId>0,modelValue:e.data.pass,"onUpdate:modelValue":a[8]||(a[8]=a=>e.data.pass=a),label:"Password",required:""},null,8,["disabled","modelValue"])])):(0,l.Q3)("",!0)])):(0,l.Q3)("",!0),e.serverId>0||"custom"==e.data.provider?((0,l.uX)(),(0,l.Wv)(g,{key:4,modelValue:e.data.port,"onUpdate:modelValue":a[9]||(a[9]=a=>e.data.port=a),label:"Port",required:""},null,8,["modelValue"])):(0,l.Q3)("",!0),"custom"===e.data.provider||e.serverId>0?((0,l.uX)(),(0,l.Wv)(h,{key:5,modelValue:e.data.dns,"onUpdate:modelValue":a[10]||(a[10]=a=>e.data.dns=a),items:e.dns,label:"DNS provider"},null,8,["modelValue","items"])):(0,l.Q3)("",!0),e.data.dns?((0,l.uX)(),(0,l.Wv)(h,{key:6,modelValue:e.data.provider_token,"onUpdate:modelValue":a[11]||(a[11]=a=>e.data.provider_token=a),items:e.provider_tokens,label:"DNS provider API token (optional)"},null,8,["modelValue","items"])):(0,l.Q3)("",!0),(0,l.bF)(b,{modelValue:e.data.mailserver,"onUpdate:modelValue":a[12]||(a[12]=a=>e.data.mailserver=a),label:"Mailserver"},null,8,["modelValue"]),(0,l.bF)(k,{disabled:!e.valid,loading:e.dialog,color:"success",onClick:u.validate},{default:(0,l.k6)((()=>a[20]||(a[20]=[(0,l.eW)(" Save ")]))),_:1},8,["disabled","loading","onClick"])])),_:1},8,["modelValue"])):(0,l.Q3)("",!0)])),_:1})])),_:1},8,["loading"]),(0,l.bF)(w,{modelValue:e.dialog,"onUpdate:modelValue":a[15]||(a[15]=a=>e.dialog=a),persistent:"",width:"300"},{default:(0,l.k6)((()=>[(0,l.bF)(y,{color:"primary"},{default:(0,l.k6)((()=>[(0,l.bF)(V,null,{default:(0,l.k6)((()=>[(0,l.bF)(v,{title:"Spellcasting...",color:"primary"},{prepend:(0,l.k6)((()=>[(0,l.bF)(I,{icon:"fas fa-magic fa-2x faa-horizontal animated"})])),_:1}),(0,l.bF)(_,{indeterminate:0==e.progress,modelValue:e.progress,"onUpdate:modelValue":a[14]||(a[14]=a=>e.progress=a),color:"white"},null,8,["indeterminate","modelValue"]),(0,l.Lk)("div",{innerHTML:e.details},null,8,i)])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.bF)(U,{modelValue:e.drawer,"onUpdate:modelValue":a[18]||(a[18]=a=>e.drawer=a),temporary:"",right:"",app:""},{default:(0,l.k6)((()=>[(0,l.bF)(y,null,{default:(0,l.k6)((()=>[(0,l.bF)(F,null,{default:(0,l.k6)((()=>a[21]||(a[21]=[(0,l.eW)(" API token ")]))),_:1}),(0,l.bF)(V,null,{default:(0,l.k6)((()=>[(0,l.bF)(g,{modelValue:e.provider_token.label,"onUpdate:modelValue":a[16]||(a[16]=a=>e.provider_token.label=a),label:"Label",required:""},null,8,["modelValue"]),(0,l.bF)(g,{modelValue:e.provider_token.token,"onUpdate:modelValue":a[17]||(a[17]=a=>e.provider_token.token=a),label:"Token",required:""},null,8,["modelValue"]),(0,l.bF)(k,{disabled:e.fetching,loading:e.fetching,color:"success",onClick:u.submitToken},{default:(0,l.k6)((()=>a[22]||(a[22]=[(0,l.eW)(" Save ")]))),_:1},8,["disabled","loading","onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}t(44114);var n=t(74300),u=t(81815),v={components:{Loading:u.A},data:()=>({fetching:!1,loading:!1,valid:!0,data:{images:[],unclaimed:[],provider:"",name:"New-server",hostname:"",user:"root",pass:"",port:"22",webserver:!0,mailserver:!1},dns:[{title:"Linode",value:"linode"},{title:"Digital Ocean",value:"digitalocean"},{title:"Other",value:""}],provider_tokens:[{title:"Add new",value:"new"}],rules:{alphanumeric:e=>/^[a-zA-Z0-9_-]+$/g.test(e)||"Must contain alphanumeric characters only",required:e=>!!e||"Required.",port:e=>!e||/^\d+(:\d+)?$/.test(e)||"1-65535",ip:e=>!e||/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)||"Invalid IP address"},provider_token:{},drawer:!1,dialog:!1,details:"",serverId:0,error:"",progress:0,regions:[],types:[],images:[],unclaimed:[],items:[{title:"Linode",value:"linode",props:{prependIcon:"fab fa-linode"}},{title:"DigitalOcean",value:"digitalocean",props:{prependIcon:"fab fa-digital-ocean"}},{title:"Vultr",value:"vultr",props:{prependIcon:"fas fa-server"}},{title:"Ubuntu server",value:"custom",props:{prependIcon:"fab fa-ubuntu"}}],isOpen:!1,provider:"Choose"}),created(){document.title="Server details",this.$route.params.id&&(this.serverId=this.$route.params.id),this.fetchData(),this.$route.query.ip&&(this.data.hostname=this.$route.query.ip,this.data.provider="vultr",this.provider="vultr")},watch:{"data.provider_token":function(){"new"===this.data.provider_token&&(this.drawer=!0,this.data.provider_token="",this.provider_token["provider"]=this.data.dns)}},methods:{fetchData(){this.error="",this.loading=!0,n.A.get("servers/"+this.serverId).then((e=>{console.log(e),this.serverId&&(this.data=e.data.item)})).catch((e=>{console.log(e)})).finally((()=>{this.loading=!1})),n.A.get("providers/tokens").then((e=>{console.log(e),this.provider_tokens.splice(1),e.data.tokens&&e.data.tokens.forEach((e=>{this.provider_tokens.push({text:e.label,value:e.id})}))})).catch((e=>{this.error=e})).finally((()=>{this.loading=!1}))},install(){this.dialog=!0,this.details="";let e="servers/"+this.serverId+"/install?webserver=1";this.data.mailserver&&(e+="&mailserver=1"),n.A.event(e,(e=>{this.details=e.msg+"...",e.progress&&(this.progress=e.progress)}),(e=>{this.error=e}),(()=>{this.dialog=!1,this.error||this.$router.push("/servers/"+this.serverId+"/summary")}))},validate:async function(){const{valid:e}=await this.$refs.form.validate();e&&(this.details="",this.dialog=!0,this.error="",this.data.unclaimed>0&&(this.serverId=this.data.unclaimed),console.log("save server"),console.log(this.serverId),this.serverId?n.A.post("servers/"+this.serverId+"/update",this.data).then((()=>{this.install()})).catch((e=>{console.log(e)})):n.A.post("servers/create",this.data).then((e=>{console.log(e),e.data.success?e.data.id&&(this.serverId=e.data.id,this.serverId&&this.install()):(this.error=e.data.error,this.dialog=!1)})).catch((e=>{console.log(e),this.dialog=!1})))},getOptions(e,a){let t,l=e.id;this.data.provider=l,this.provider=l,"custom"!==l&&"vultr"!==l&&(a||(t=window.open("loading")),this.loading=!0,this.regions=[],this.images=[],this.types=[],this.unclaimed=[],n.A.post("providers/?cmd=options",{provider:l}).then((r=>{if(console.log(r),r.data.require_auth&&!a){t.location="https://serverwand.com/account/services/"+l;let a=setInterval((()=>{if(t.closed)return clearInterval(a),void this.getOptions(e,!0)}),500)}else r.data.require_auth||(t&&t.close(),this.regions=r.data.options.regions,this.images=r.data.options.images,this.types=r.data.options.types,r.data.unclaimed.forEach((e=>{this.unclaimed.push({title:e.label,value:e.id})})))})).catch((e=>{t&&t.close(),console.log(e)})).finally((()=>{this.loading=!1})))},submitToken(){n.A.post("providers/tokens",this.provider_token).then((e=>{e.data.error?this.error=e.data.error:(this.drawer=!1,this.fetchData())})).catch((e=>{this.error=e}))}}},m=t(66262);const p=(0,m.A)(v,[["render",s]]);var c=p}}]);
//# sourceMappingURL=3998.ad13dd51.js.map