{"version":3,"file":"js/8737-legacy.bffa3f13.js","mappings":"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","sources":["webpack://ServerWand/./src/views/sites/Backups.vue","webpack://ServerWand/./src/views/sites/Backups.vue?815c"],"sourcesContent":["<template>\n  <div>\n    <v-alert v-if=\"error\" type=\"error\" :text=\"error\"></v-alert>\n\n    <Loading :value=\"loading\" />\n\n    <v-card :loading=\"fetching\" ref=\"results\">\n      <v-card-actions>\n        <v-btn title=\"Create backup\" ref=\"uploadFolderButton\" @click=\"createBackup()\" icon=\"mdi:mdi-plus\"></v-btn>\n        <Upload :serverId=\"serverId\" :path=\"path\" :dropZone=\"$refs.results\" @complete=\"fetchData()\"\n          @error=\"handleError\" />\n      </v-card-actions>\n      <v-card-text>\n\n        <v-list v-if=\"data.items.length > 0\" max-width=\"600\">\n          <v-list-item v-for=\"(item, i) in data.items\" :key=\"`item-${i}`\" :title=\"item.name\"\n            :subtitle=\"item.date + ' - ' + prettyBytes(item.size)\" @click=\"restore(item)\">\n            <template v-slot:append>\n              <v-btn icon :disabled=\"fetching\" @click.stop=\"download(item)\">\n                <v-icon size=\"small\">mdi:mdi-download</v-icon>\n              </v-btn>\n              <v-btn icon :disabled=\"fetching\" :loading=\"loading === item.name\" @click.stop=\"deleteItem(item)\">\n                <v-icon size=\"small\">mdi:mdi-delete</v-icon>\n              </v-btn>\n            </template>\n          </v-list-item>\n        </v-list>\n      </v-card-text>\n    </v-card>\n    <Confirm ref=\"confirm\" />\n  </div>\n</template>\n\n<script>\nimport api from \"../../services/api\";\nimport Loading from \"../../components/Loading\";\nimport Upload from \"../../components/Files/Upload\";\nimport Confirm from \"../../components/ConfirmDialog.vue\";\nimport util from \"../../services/util\";\n\nexport default {\n  components: {\n    Loading,\n    Upload,\n    Confirm,\n  },\n  data() {\n    return {\n      path: \"/\",\n      domainId: null,\n      post: null,\n      error: null,\n      data: {\n        domain: \"\",\n        items: [],\n      },\n      loading: false,\n      details: \"\",\n      fetching: false,\n      loading: null,\n      alias: {\n        domain: \"\",\n        dns: false,\n      },\n      serverId: 0,\n      progress: 0,\n    };\n  },\n  created() {\n    // fetch the data when the view is created and the data is\n    // already being observed\n    this.fetchData();\n  },\n  watch: {\n    // call again the method if the route changes\n    $route: \"fetchData\",\n  },\n  methods: {\n    fetchData() {\n      var self = this;\n      this.error = \"\";\n      this.domainId = this.$route.params.id;\n\n      this.fetching = true;\n      this.progress = 0;\n\n      api\n        .get(\"sites/\" + this.domainId + \"/backups\")\n        .then(function (response) {\n          console.log(response);\n\n          if (response.data.error) {\n            self.error = response.data.error;\n            return false;\n          }\n\n          self.data = response.data;\n          document.title = \"Backups\" + \" | \" + self.data.domain;\n\n          self.serverId = self.data.server.id;\n          self.path = '/var/www/vhosts/' + self.data.server.ip + '/public/backups';\n        })\n        .catch(function (error) {\n          console.log(error);\n        })\n        .finally(function () {\n          self.fetching = false;\n        });\n    },\n    createBackup() {\n      var self = this;\n      this.fetching = true;\n      this.error = '';\n\n      api\n        .get(\"sites/\" + this.domainId + \"/backups/create\")\n        .then(function (response) {\n          console.log(response);\n\n          if (!response.data.success) {\n            self.error = response.data.error;\n          } else {\n            self.fetchData();\n          }\n        })\n        .catch(function (error) {\n          console.log(error);\n        })\n        .finally(function () {\n          self.fetching = false;\n        });\n    },\n    download(item) {\n      console.log(\"https://\" + this.data.server.ip + \"/backups/\" + item.name);\n      window.open(\"https://\" + this.data.server.ip + \"/backups/\" + item.name);\n    },\n    deleteItem: async function (item) {\n      if (!await this.$refs.confirm.open(\"Delete \" + item.name)) {\n        return;\n      }\n\n      var self = this;\n      this.fetching = true;\n      this.loading = item.name;\n\n      api\n        .post(\"sites/\" + this.domainId + \"/backups\", { ids: [item.name] })\n        .then(function () {\n          self.fetchData();\n        })\n        .catch(function (error) {\n          console.log(error);\n          self.fetching = false;\n        })\n        .finally(function () {\n          self.loading = null;\n        });\n    },\n    restore: async function (item) {\n      if (!await this.$refs.confirm.open(\"Restore \" + item.name)) {\n        return;\n      }\n\n      var self = this;\n      self.fetching = true;\n\n      api\n        .post(\"sites/\" + this.domainId + \"/backups\", { restore: item.name })\n        .then(function () {\n          self.fetchData();\n        })\n        .catch(function (error) {\n          console.log(error);\n          self.fetching = false;\n        });\n    },\n    handleError(error) {\n      this.error = error;\n    },\n    handleLoading(loading) {\n      this.fetching = loading;\n    },\n    prettyBytes(value) {\n      return util.prettyBytes(value);\n    },\n  },\n};\n</script>\n","import { render } from \"./Backups.vue?vue&type=template&id=5222d3e4\"\nimport script from \"./Backups.vue?vue&type=script&lang=js\"\nexport * from \"./Backups.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementBlock","$data","error","_createBlock","_component_v_alert","type","text","_createVNode","_component_Loading","value","loading","_component_v_card","fetching","ref","_component_v_card_actions","_component_v_btn","title","onClick","_cache","$event","$options","createBackup","icon","_component_Upload","serverId","path","dropZone","_ctx","$refs","results","onComplete","fetchData","onError","handleError","_component_v_card_text","data","items","length","_component_v_list","_Fragment","_renderList","item","i","_component_v_list_item","key","concat","name","subtitle","date","prettyBytes","size","restore","append","_withCtx","disabled","_withModifiers","download","_component_v_icon","deleteItem","_component_Confirm","components","Loading","Upload","Confirm","_defineProperty","domainId","post","domain","details","dns","created","this","watch","$route","methods","self","params","id","progress","api","get","then","response","console","log","document","server","ip","catch","finally","success","window","open","_deleteItem","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","confirm","sent","abrupt","ids","stop","_x","apply","arguments","_restore","_callee2","_context2","_x2","handleLoading","util","__exports__","render"],"sourceRoot":""}