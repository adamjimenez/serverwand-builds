{"version":3,"file":"js/8721-legacy.bafd3040.js","mappings":"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","sources":["webpack://ServerWand/./src/views/sites/Backups.vue","webpack://ServerWand/./src/views/sites/Backups.vue?bb72"],"sourcesContent":["<template>\n  <div>\n    <v-alert v-if=\"error\" type=\"error\">\n      {{ error }}\n    </v-alert>\n\n    <Loading :value=\"loading\" />\n\n    <v-card class=\"pa-3\" :loading=\"fetching\" ref=\"results\">\n\n      <v-container fluid>\n        <v-row>\n\n          <v-col class=\"flex-grow-0\">\n            <v-btn title=\"Create backup\" ref=\"uploadFolderButton\" @click=\"createBackup()\">\n              <v-icon>mdi:mdi-plus</v-icon>\n            </v-btn>\n          </v-col>\n\n          <Upload :serverId=\"serverId\" :path=\"path\" :dropZone=\"$refs.results\" @complete=\"fetchData()\"\n            @error=\"handleError\" />\n        </v-row>\n      </v-container>\n\n      <v-list v-if=\"data.items.length > 0\">\n        <v-list group>\n\n          <v-list-item v-for=\"(item, i) in data.items\" :key=\"`item-${i}`\" :title=\"item.name\" @click=\"restore(item.name)\">\n            <template v-slot:append>\n                <v-list-item-subtitle>{{ item.date }} -\n                  {{ util.prettyBytes(item.size) }}</v-list-item-subtitle>\n              <v-btn icon :disabled=\"fetching\" :loading=\"fetching\" @click=\"deleteItem(item.line)\" @click.stop>\n                <v-icon size=\"small\">mdi:mdi-delete</v-icon>\n              </v-btn>\n            </template>\n          </v-list-item>\n        </v-list>\n      </v-list>\n\n      <v-card-text v-else> Empty </v-card-text>\n    </v-card>\n    <Confirm ref=\"confirm\" />\n\n  </div>\n</template>\n\n<script>\nimport api from \"../../services/api\";\nimport Loading from \"../../components/Loading\";\nimport Upload from \"../../components/Files/Upload\";\nimport Confirm from \"../../components/ConfirmDialog.vue\";\nimport util from \"../../services/util\";\n\nexport default {\n  components: {\n    Loading,\n    Upload,\n    Confirm,\n  },\n  data() {\n    return {\n      path: \"/\",\n      domainId: null,\n      post: null,\n      error: null,\n      data: {\n        domain: \"\",\n        items: [],\n      },\n      loading: false,\n      details: \"\",\n      loading: false,\n      fetching: false,\n      alias: {\n        domain: \"\",\n        dns: false,\n      },\n      timer: null,\n      serverId: 0,\n      progress: 0,\n    };\n  },\n  created() {\n    // fetch the data when the view is created and the data is\n    // already being observed\n    this.fetchData();\n  },\n  watch: {\n    // call again the method if the route changes\n    $route: \"fetchData\",\n  },\n  methods: {\n    fetchData() {\n      var self = this;\n      this.error = \"\";\n      this.domainId = this.$route.params.id;\n      clearTimeout(self.timer);\n\n      this.fetching = true;\n      this.progress = 0;\n\n      api\n        .get(\"sites/\" + this.domainId + \"/backups\")\n        .then(function (response) {\n          console.log(response);\n\n          if (response.data.error) {\n            self.error = response.data.error;\n            return false;\n          }\n\n          self.data = response.data;\n          document.title = \"Backups\" + \" | \" + self.data.domain;\n\n          self.serverId = self.data.server.id;\n          self.path = '/var/www/vhosts/' + self.data.server.ip + '/public/backups';\n        })\n        .catch(function (error) {\n          console.log(error);\n        })\n        .finally(function () {\n          self.fetching = false;\n        });\n    },\n    createBackup() {\n      var self = this;\n      this.fetching = true;\n      this.error = '';\n\n      api\n        .get(\"sites/\" + this.domainId + \"/backups/create\")\n        .then(function (response) {\n          console.log(response);\n\n          if (!response.data.success) {\n            self.error = response.data.error;\n          } else {\n            self.fetchData();\n          }\n        })\n        .catch(function (error) {\n          console.log(error);\n        })\n        .finally(function () {\n          self.fetching = false;\n        });\n    },\n    download(item) {\n      console.log(\"https://\" + this.data.server.ip + \"/backups/\" + item.name);\n      window.open(\"https://\" + this.data.server.ip + \"/backups/\" + item.name);\n    },\n    deleteItem: async function (item) {\n      if (\n        await this.$refs.confirm.open(\n          \"Confirm\",\n          \"Delete \" + item\n        )\n      ) {\n\n        var self = this;\n        self.fetching = true;\n\n        api\n          .post(\"sites/\" + this.domainId + \"/backups\", { ids: [item] })\n          .then(function () {\n            self.fetchData();\n          })\n          .catch(function (error) {\n            console.log(error);\n            self.fetching = false;\n          });\n      }\n    },\n    restore: async function (item) {\n      if (\n        await this.$refs.confirm.open(\n          \"Confirm\",\n          \"Restore \" + item\n        )\n      ) {\n\n        var self = this;\n        self.fetching = true;\n\n        api\n          .post(\"sites/\" + this.domainId + \"/backups\", { restore: item })\n          .then(function () {\n            self.fetchData();\n          })\n          .catch(function (error) {\n            console.log(error);\n            self.fetching = false;\n          });\n      };\n    },\n    handleError(error) {\n      this.error = error;\n    },\n    handleLoading(loading) {\n      this.fetching = loading;\n    },\n    prettyBytes(value) {\n      return util.prettyBytes(value);\n    },\n  },\n};\n</script>\n","import { render } from \"./Backups.vue?vue&type=template&id=db79624c\"\nimport script from \"./Backups.vue?vue&type=script&lang=js\"\nexport * from \"./Backups.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/home/runner/work/serverwand/serverwand/node_modules/@vue/cli-service/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementBlock","$data","_createBlock","_component_v_alert","type","_createVNode","_component_Loading","value","_component_v_card","class","loading","ref","_component_v_container","fluid","_component_v_row","_component_v_col","_component_v_btn","title","onClick","$options","_component_v_icon","_component_Upload","serverId","path","dropZone","_ctx","results","onComplete","onError","items","length","_component_v_list","key","group","_Fragment","_renderList","item","i","_component_v_list_item","name","append","_component_v_list_item_subtitle","date","_toDisplayString","prettyBytes","size","icon","disabled","line","_component_v_card_text","_component_Confirm","components","Loading","Upload","Confirm","data","domainId","post","error","domain","details","dns","created","this","fetchData","watch","$route","methods","self","params","id","clearTimeout","timer","fetching","progress","api","then","response","console","log","document","server","ip","catch","finally","createBackup","success","download","window","open","deleteItem","$refs","confirm","ids","restore","handleError","handleLoading","util","__exports__","render"],"sourceRoot":""}