"use strict";(self["webpackChunkServerWand"]=self["webpackChunkServerWand"]||[]).push([[2739],{84285:function(e,a,t){t.d(a,{Z:function(){return d}});var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-dialog",{attrs:{persistent:"",content:"","content-class":"centered-dialog"},model:{value:e.value,callback:function(a){e.value=a},expression:"value"}},[t("v-container",{attrs:{"fill-height":""}},[t("v-card",{attrs:{color:"primary",dark:""}},[t("v-card-text",[t("v-layout",{attrs:{row:""}},[t("i",{staticClass:"fas fa-magic fa-2x faa-horizontal animated"}),t("h2",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.message))])])],1)],1)],1)],1)},s=[],i={name:"Loading",data:()=>({}),props:{value:{type:Boolean,default:!1},message:{type:String,default:"Summoning..."}}},o=i,l=t(1001),n=(0,l.Z)(o,r,s,!1,null,null,null),d=n.exports},82739:function(e,a,t){t.r(a),t.d(a,{default:function(){return c}});var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[e.error?t("v-alert",{attrs:{type:"error"}},[e._v(" "+e._s(e.error)+" ")]):e._e(),t("Loading",{attrs:{value:e.loading}}),t("v-card",{staticClass:"pb-5",attrs:{loading:e.fetching}},[t("v-card-title",[e._v("Server details")]),e.serverId?e._e():t("v-card-subtitle",[e._v(" Choose a VPS provider below or add a custom server ")]),e.serverId?e._e():t("div",[t("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(a){var r=a.on;return[t("v-btn",e._g({staticClass:"mx-3",attrs:{slot:"activator","value:":"menu",color:"primary"},slot:"activator"},r),[e._v(" "+e._s(e.provider)+" "),t("v-icon",{attrs:{dark:""}},[e._v(e._s(e.isOpen?"expand_less":"expand_more"))])],1)]}}],null,!1,528249069),model:{value:e.isOpen,callback:function(a){e.isOpen=a},expression:"isOpen"}},[t("v-list",e._l(e.items,(function(a,r){return t("v-list-item",{key:r,on:{click:function(t){return e.getOptions(a.value)}}},[t("v-list-item-avatar",[t("v-icon",[e._v(e._s(a.avatar))])],1),t("v-list-item-content",[t("v-list-item-title",[e._v(e._s(a.title))])],1)],1)})),1)],1)],1),e.data.provider||e.serverId?t("v-form",{ref:"form",staticClass:"mx-3 my-5",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(a){e.valid=a},expression:"valid"}},["custom"!=e.data.provider||e.serverId?e._e():t("p",[e._v(" Connect a server which is freshly installed with Ubuntu. Once configured, root login will be disabled for increased security ")]),e.unclaimed.length?t("v-select",{attrs:{items:e.unclaimed,label:"Server"},model:{value:e.data.unclaimed,callback:function(a){e.$set(e.data,"unclaimed",a)},expression:"data.unclaimed"}}):e._e(),t("v-text-field",{attrs:{rules:e.nameRules,label:"Name",required:""},model:{value:e.data.name,callback:function(a){e.$set(e.data,"name",a)},expression:"data.name"}}),"custom"===e.data.provider||this.serverId>0?t("v-text-field",{attrs:{rules:e.hostRules,label:"IP"},model:{value:e.data.ip,callback:function(a){e.$set(e.data,"ip",a)},expression:"data.ip"}}):e._e(),"custom"===e.data.provider||"vultr"===e.data.provider||e.unclaimed.length?e._e():t("div",[e.serverId?e._e():t("v-select",{attrs:{items:e.regions,label:"Region"},model:{value:e.data.region,callback:function(a){e.$set(e.data,"region",a)},expression:"data.region"}}),e.serverId?e._e():t("v-select",{attrs:{items:e.types,label:"Type"},model:{value:e.data.type,callback:function(a){e.$set(e.data,"type",a)},expression:"data.type"}}),!e.serverId&&e.images.length?t("v-select",{attrs:{items:e.images,label:"Image"},model:{value:e.data.image,callback:function(a){e.$set(e.data,"image",a)},expression:"data.image"}}):e._e()],1),"custom"==e.data.provider||"vultr"==e.data.provider?t("div",[t("v-text-field",{attrs:{disabled:e.serverId>0,rules:e.hostRules,label:"Host name/ IP Address",required:""},model:{value:e.data.hostname,callback:function(a){e.$set(e.data,"hostname",a)},expression:"data.hostname"}}),"custom"==e.data.provider?t("div",[t("v-text-field",{attrs:{disabled:e.serverId>0,label:"Username",required:""},model:{value:e.data.user,callback:function(a){e.$set(e.data,"user",a)},expression:"data.user"}}),t("v-text-field",{attrs:{type:"password",disabled:e.serverId>0,label:"Password",required:""},model:{value:e.data.pass,callback:function(a){e.$set(e.data,"pass",a)},expression:"data.pass"}})],1):e._e()],1):e._e(),e.serverId>0||"custom"==e.data.provider?t("v-text-field",{attrs:{label:"Port",required:""},model:{value:e.data.port,callback:function(a){e.$set(e.data,"port",a)},expression:"data.port"}}):e._e(),"custom"===e.data.provider||e.serverId>0?t("v-select",{attrs:{items:e.dns,label:"DNS provider"},model:{value:e.data.dns,callback:function(a){e.$set(e.data,"dns",a)},expression:"data.dns"}}):e._e(),e.data.dns?t("v-select",{attrs:{items:e.provider_tokens,label:"DNS provider API token (optional)"},model:{value:e.data.provider_token,callback:function(a){e.$set(e.data,"provider_token",a)},expression:"data.provider_token"}}):e._e(),t("v-checkbox",{attrs:{label:"Mailserver"},model:{value:e.data.mailserver,callback:function(a){e.$set(e.data,"mailserver",a)},expression:"data.mailserver"}}),t("v-btn",{attrs:{disabled:e.dialog,loading:e.dialog,color:"success"},on:{click:e.validate}},[e._v(" Save ")])],1):e._e()],1),t("v-dialog",{attrs:{persistent:"",width:"300"},model:{value:e.dialog,callback:function(a){e.dialog=a},expression:"dialog"}},[t("v-card",{attrs:{color:"primary",dark:""}},[t("v-card-text",[t("v-layout",{staticClass:"pt-5"},[t("i",{staticClass:"fas fa-magic fa-2x faa-horizontal animated"}),t("h2",{staticStyle:{"margin-left":"10px"}},[e._v("Spellcasting...")])]),t("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:0==e.progress,color:"white"},model:{value:e.progress,callback:function(a){e.progress=a},expression:"progress"}}),t("div",{domProps:{innerHTML:e._s(e.details)}})],1)],1)],1),t("v-navigation-drawer",{attrs:{temporary:"",right:"",app:""},model:{value:e.drawer,callback:function(a){e.drawer=a},expression:"drawer"}},[t("v-card",[t("v-card-title",[e._v(" API token ")]),t("v-card-text",[t("v-text-field",{attrs:{label:"Label",required:""},model:{value:e.provider_token.label,callback:function(a){e.$set(e.provider_token,"label",a)},expression:"provider_token.label"}}),t("v-text-field",{attrs:{label:"Token",required:""},model:{value:e.provider_token.token,callback:function(a){e.$set(e.provider_token,"token",a)},expression:"provider_token.token"}}),t("v-btn",{attrs:{disabled:e.fetching,loading:e.fetching,color:"success"},on:{click:e.submitToken}},[e._v(" Save ")])],1)],1)],1)],1)},s=[],i=t(4296),o=t(84285),l={components:{Loading:o.Z},data:()=>({fetching:!1,loading:!1,valid:!0,data:{images:[],unclaimed:[],provider:"",name:"New-server",hostname:"",user:"root",pass:"",port:"22",webserver:!0,mailserver:!1},dns:[{text:"Linode",value:"linode"},{text:"Digital Ocean",value:"digitalocean"},{text:"Other",value:""}],provider_tokens:[{text:"Add new",value:"new"}],nameRules:[e=>!!e||"Name is required",e=>/^[a-zA-Z0-9_-]+$/g.test(e)||"Must contain alphanumeric characters only"],hostRules:[e=>!!e||"IP is required"],provider_token:{},drawer:!1,dialog:!1,details:"",serverId:0,error:"",progress:0,regions:[],types:[],images:[],unclaimed:[],items:[{title:"Linode",value:"linode",avatar:"fab fa-linode"},{title:"DigitalOcean",value:"digitalocean",avatar:"fab fa-digital-ocean"},{title:"Vultr",value:"vultr",avatar:"fas fa-server"},{title:"Custom server",value:"custom",avatar:"fas fa-server"}],isOpen:!1,provider:"Choose"}),created(){document.title="Server details",this.$route.params.id&&(this.serverId=this.$route.params.id),this.fetchData(),this.$route.query.ip&&(this.data.hostname=this.$route.query.ip,this.data.provider="vultr",this.provider="vultr")},watch:{"data.provider_token":function(){"new"===this.data.provider_token&&(this.drawer=!0,this.data.provider_token="",this.provider_token["provider"]=this.data.dns)}},methods:{fetchData(){var e=this;this.error="",this.loading=!0,i.Z.get("servers/"+this.serverId).then((function(a){console.log(a),e.serverId&&(e.data=a.data.item)})).catch((function(e){console.log(e)})).finally((function(){e.loading=!1})),i.Z.get("providers/tokens").then((function(a){console.log(a),e.provider_tokens.splice(1),a.data.tokens&&a.data.tokens.forEach((function(a){e.provider_tokens.push({text:a.label,value:a.id})}))})).catch((function(a){e.error=a})).finally((function(){e.loading=!1}))},install(){var e=this;e.dialog=!0,e.details="";var a="servers/"+e.serverId+"/install?webserver=1";e.data.mailserver&&(a+="&mailserver=1"),i.Z.event(a,(a=>{e.details=a.msg+"...",a.progress&&(e.progress=a.progress)}),(a=>{e.error=a}),(()=>{e.dialog=!1,e.error||(e.$eventHub.$emit("itemsChanged"),e.$router.push("/servers/"+e.serverId+"/summary"))}))},validate(){var e=this;this.$refs.form.validate()&&(this.details="",this.dialog=!0,this.error="",e.data.unclaimed>0&&(e.serverId=e.data.unclaimed),console.log("save server"),console.log(e.serverId),e.serverId?i.Z.post("servers/"+e.serverId+"/update",this.data).then((function(){e.install()})).catch((function(e){console.log(e)})):i.Z.post("servers/create",this.data).then((function(a){console.log(a),a.data.success?a.data.id&&(e.serverId=a.data.id,e.serverId&&e.install()):(e.error=a.data.error,e.dialog=!1)})).catch((function(a){console.log(a),e.dialog=!1})))},getOptions(e,a){if(this.data.provider=e,this.provider=e,"custom"!==e&&"vultr"!==e){var t;a||(t=window.open("loading"));var r=this;this.loading=!0,r.regions=[],r.images=[],r.types=[],r.unclaimed=[],i.Z.post("providers/?cmd=options",{provider:e}).then((function(s){if(console.log(s),s.data.require_auth&&!a){t.location="https://serverwand.com/account/services/"+e;var i=setInterval((function(){if(t.closed)return clearInterval(i),void r.getOptions(e,!0)}),500)}else s.data.require_auth||(t&&t.close(),r.regions=s.data.options.regions,r.images=s.data.options.images,r.types=s.data.options.types,s.data.unclaimed.forEach((e=>{r.unclaimed.push({text:e.label,value:e.id})})))})).catch((function(e){t&&t.close(),console.log(e)})).finally((function(){r.loading=!1}))}},submitToken(){var e=this;i.Z.post("providers/tokens",this.provider_token).then((function(a){a.data.error?e.error=a.data.error:(e.drawer=!1,e.fetchData())})).catch((function(a){e.error=a}))}}},n=l,d=t(1001),v=(0,d.Z)(n,r,s,!1,null,null,null),c=v.exports}}]);
//# sourceMappingURL=2739.17dc9228.js.map