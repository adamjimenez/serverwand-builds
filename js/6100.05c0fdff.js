"use strict";(self["webpackChunkServerWand"]=self["webpackChunkServerWand"]||[]).push([[6100],{86712:function(e,t,a){a.r(t),a.d(t,{default:function(){return p}});var n=a(66252),i=a(49963);function o(e,t,a,o,r,s){const l=(0,n.up)("v-alert"),d=(0,n.up)("Loading"),c=(0,n.up)("v-icon"),u=(0,n.up)("v-btn"),f=(0,n.up)("v-col"),h=(0,n.up)("Upload"),p=(0,n.up)("v-row"),m=(0,n.up)("v-container"),g=(0,n.up)("v-list-item"),w=(0,n.up)("v-list"),v=(0,n.up)("v-card-text"),k=(0,n.up)("v-card"),b=(0,n.up)("Confirm");return(0,n.wg)(),(0,n.iD)("div",null,[r.error?((0,n.wg)(),(0,n.j4)(l,{key:0,type:"error",text:r.error},null,8,["text"])):(0,n.kq)("",!0),(0,n.Wm)(d,{value:r.loading},null,8,["value"]),(0,n.Wm)(k,{loading:r.fetching,ref:"results"},{default:(0,n.w5)((()=>[(0,n.Wm)(v,null,{default:(0,n.w5)((()=>[(0,n.Wm)(m,{fluid:""},{default:(0,n.w5)((()=>[(0,n.Wm)(p,null,{default:(0,n.w5)((()=>[(0,n.Wm)(f,{class:"flex-grow-0"},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{title:"Create backup",ref:"uploadFolderButton",onClick:t[0]||(t[0]=e=>s.createBackup()),icon:""},{default:(0,n.w5)((()=>[(0,n.Wm)(c,null,{default:(0,n.w5)((()=>[(0,n.Uk)("mdi:mdi-plus")])),_:1})])),_:1},512)])),_:1}),(0,n.Wm)(h,{serverId:r.serverId,path:r.path,dropZone:e.$refs.results,onComplete:t[1]||(t[1]=e=>s.fetchData()),onError:s.handleError},null,8,["serverId","path","dropZone","onError"])])),_:1})])),_:1}),r.data.items.length>0?((0,n.wg)(),(0,n.j4)(w,{key:0,"max-width":"600"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.data.items,((e,t)=>((0,n.wg)(),(0,n.j4)(g,{key:`item-${t}`,title:e.name,subtitle:e.date+" - "+s.prettyBytes(e.size),onClick:t=>s.restore(e)},{append:(0,n.w5)((()=>[(0,n.Wm)(u,{icon:"",disabled:r.fetching,loading:r.fetching,onClick:(0,i.iM)((t=>s.download(e)),["stop"])},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{size:"small"},{default:(0,n.w5)((()=>[(0,n.Uk)("mdi:mdi-download")])),_:1})])),_:2},1032,["disabled","loading","onClick"]),(0,n.Wm)(u,{icon:"",disabled:r.fetching,loading:r.fetching,onClick:(0,i.iM)((t=>s.deleteItem(e)),["stop"])},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{size:"small"},{default:(0,n.w5)((()=>[(0,n.Uk)("mdi:mdi-delete")])),_:1})])),_:2},1032,["disabled","loading","onClick"])])),_:2},1032,["title","subtitle","onClick"])))),128))])),_:1})):(0,n.kq)("",!0)])),_:1})])),_:1},8,["loading"]),(0,n.Wm)(b,{ref:"confirm"},null,512)])}var r=a(1006),s=a(11912),l=a(42322),d=a(14796),c=a(72564),u={components:{Loading:s.Z,Upload:l.Z,Confirm:d.Z},data(){return{path:"/",domainId:null,post:null,error:null,data:{domain:"",items:[]},loading:!1,details:"",loading:!1,fetching:!1,alias:{domain:"",dns:!1},serverId:0,progress:0}},created(){this.fetchData()},watch:{$route:"fetchData"},methods:{fetchData(){var e=this;this.error="",this.domainId=this.$route.params.id,this.fetching=!0,this.progress=0,r.Z.get("sites/"+this.domainId+"/backups").then((function(t){if(console.log(t),t.data.error)return e.error=t.data.error,!1;e.data=t.data,document.title="Backups | "+e.data.domain,e.serverId=e.data.server.id,e.path="/var/www/vhosts/"+e.data.server.ip+"/public/backups"})).catch((function(e){console.log(e)})).finally((function(){e.fetching=!1}))},createBackup(){var e=this;this.fetching=!0,this.error="",r.Z.get("sites/"+this.domainId+"/backups/create").then((function(t){console.log(t),t.data.success?e.fetchData():e.error=t.data.error})).catch((function(e){console.log(e)})).finally((function(){e.fetching=!1}))},download(e){console.log("https://"+this.data.server.ip+"/backups/"+e.name),window.open("https://"+this.data.server.ip+"/backups/"+e.name)},deleteItem:async function(e){if(await this.$refs.confirm.open("Confirm","Delete "+e.name)){var t=this;t.fetching=!0,r.Z.post("sites/"+this.domainId+"/backups",{ids:[e.name]}).then((function(){t.fetchData()})).catch((function(e){console.log(e),t.fetching=!1}))}},restore:async function(e){if(await this.$refs.confirm.open("Confirm","Restore "+e.name)){var t=this;t.fetching=!0,r.Z.post("sites/"+this.domainId+"/backups",{restore:e.name}).then((function(){t.fetchData()})).catch((function(e){console.log(e),t.fetching=!1}))}},handleError(e){this.error=e},handleLoading(e){this.fetching=e},prettyBytes(e){return c.Z.prettyBytes(e)}}},f=a(48118);const h=(0,f.Z)(u,[["render",o]]);var p=h}}]);
//# sourceMappingURL=6100.05c0fdff.js.map