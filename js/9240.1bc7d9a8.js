"use strict";(self["webpackChunkServerWand"]=self["webpackChunkServerWand"]||[]).push([[9240],{84285:function(t,a,e){e.d(a,{Z:function(){return d}});var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-dialog",{attrs:{persistent:"",content:"","content-class":"centered-dialog"},model:{value:t.value,callback:function(a){t.value=a},expression:"value"}},[e("v-container",{attrs:{"fill-height":""}},[e("v-card",{attrs:{color:"primary",dark:""}},[e("v-card-text",[e("v-layout",{attrs:{row:""}},[e("i",{staticClass:"fas fa-magic fa-2x faa-horizontal animated"}),e("h2",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t.message))])])],1)],1)],1)],1)},r=[],n={name:"Loading",data:()=>({}),props:{value:{type:Boolean,default:!1},message:{type:String,default:"Summoning..."}}},s=n,o=e(1001),l=(0,o.Z)(s,i,r,!1,null,null,null),d=l.exports},19240:function(t,a,e){e.r(a),e.d(a,{default:function(){return u}});var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[t.error?e("v-alert",{attrs:{type:"error"}},[t._v(" "+t._s(t.error)+" ")]):t._e(),e("Loading",{attrs:{value:t.loading}}),e("v-card",{staticClass:"pa-3",attrs:{loading:t.fetching}},[t.authRequired?e("v-layout",{attrs:{row:""}},[e("v-flex",{attrs:{xs12:""}},[e("v-card",{attrs:{tile:"",flat:""}},[e("v-card-text",[e("strong",[t._v("DNS auth required: ")]),e("v-btn",{on:{click:function(a){return t.authPrompt()}}},[t._v("Fix")])],1)],1)],1)],1):t._e(),!t.authRequired&&t.data.server&&t.data.dns&&t.data.dns.MX!=t.data.server.hostname?e("v-layout",{attrs:{row:""}},[e("v-flex",{attrs:{xs12:""}},[e("v-card",{attrs:{tile:"",flat:""}},[e("v-card-text",[e("strong",[t._v("MX mismatch: "+t._s(t.data.dns.MX)+" != "+t._s(t.data.server.hostname))]),t.data.dns.not_set?e("v-btn",{on:{click:function(a){return t.fixDomainDns(t.data.domain)}}},[t._v("Fix")]):t._e()],1)],1)],1)],1):t._e(),!t.authRequired&&t.data.server&&t.data.dkim&&t.data.dkim.not_set?e("v-layout",{attrs:{row:""}},[e("v-flex",{attrs:{xs12:""}},[e("v-card",{attrs:{tile:"",flat:""}},[e("v-card-text",[e("strong",[t._v("Missing DKIM")]),t.data.dkim.not_set?e("v-btn",{on:{click:function(a){return t.fixDkim(t.data.domain)}}},[t._v("Fix")]):t._e()],1)],1)],1)],1):t._e(),!t.authRequired&&t.data.server&&t.data.spf&&t.data.spf.not_set&&!t.data.spf.SPF?e("v-layout",{attrs:{row:""}},[e("v-flex",{attrs:{xs12:""}},[e("v-card",{attrs:{tile:"",flat:""}},[e("v-card-text",[e("strong",[t._v("Missing SPF")]),t.data.spf.not_set?e("v-btn",{on:{click:function(a){return t.fixSpf(t.data.domain)}}},[t._v("Fix")]):t._e()],1)],1)],1)],1):t._e(),t.data.server.mailserver?e("v-card-title",{attrs:{"primary-title":""}},[e("v-switch",{attrs:{label:"Email"},on:{change:function(a){return t.toggleEmail()}},model:{value:t.data.email,callback:function(a){t.$set(t.data,"email",a)},expression:"data.email"}})],1):t._e()],1),t.data.server.mailserver?e("div",[e("v-card",{staticClass:"mx-auto"},[e("v-list",[e("v-list-item-group",[t._l(t.data.emails,(function(a,i){return[e("v-list-item",{key:"item-"+i,attrs:{value:a},on:{click:function(a){return t.editEmail(i)}},scopedSlots:t._u([{key:"default",fn:function(){return[e("v-list-item-content",[e("v-list-item-title",[t._v(" "+t._s(a.user)+" "),a.destination?e("span",[e("v-icon",[t._v("fas fa-long-arrow-alt-right")]),t._v(" "+t._s(a.destination)+" ")],1):t._e()]),e("v-list-item-subtitle",[t._v(t._s(t._f("prettyBytes")(a.disk_usage)))])],1),e("v-list-item-action",[e("v-btn",{attrs:{icon:"",disabled:t.fetching,loading:t.fetching},on:{click:[function(e){return t.deleteEmail(a.user)},function(t){t.stopPropagation()}]}},[e("v-icon",{attrs:{small:""}},[t._v("delete")])],1)],1)]},proxy:!0}],null,!0)})]}))],2)],1)],1),e("v-card",[e("v-card-text",[e("v-btn",{on:{click:function(a){return t.addEmail()}}},[t._v(" Add email ")])],1)],1),e("v-navigation-drawer",{attrs:{fixed:"",temporary:"",right:""},model:{value:t.drawer,callback:function(a){t.drawer=a},expression:"drawer"}},[e("v-card",[e("v-card-title",[t._v(" Email account ")]),e("v-card-text",[e("v-text-field",{attrs:{label:"Name",required:"",readonly:t.userReadonly},model:{value:t.email.user,callback:function(a){t.$set(t.email,"user",a)},expression:"email.user"}}),e("v-text-field",{attrs:{type:"password",label:"Password",required:""},model:{value:t.email.password,callback:function(a){t.$set(t.email,"password",a)},expression:"email.password"}}),e("v-text-field",{attrs:{label:"Forwarding",required:""},model:{value:t.email.destination,callback:function(a){t.$set(t.email,"destination",a)},expression:"email.destination"}}),e("v-btn",{attrs:{disabled:t.fetching,loading:t.fetching,color:"success"},on:{click:function(a){return t.saveEmail()}}},[t._v(" Save ")])],1)],1)],1)],1):t._e()],1)},r=[],n=e(4296),s=e(84285),o={components:{Loading:s.Z},data(){return{domainId:null,post:null,error:null,data:{email:!1,emails:[],server:{},records:{}},email:{},fetching:!1,loading:!1,rules:{required:t=>!!t||"Required.",min:t=>t.length>=8||"Min 8 characters",emailMatch:()=>"The email and password you entered don't match"},copyText:"Copy",drawer:!1,userReadonly:!1,timer:null,authRequired:!1}},created(){this.fetchData()},watch:{$route:"fetchData"},methods:{fetchData(){var t=this;this.error="",this.domainId=this.$route.params.id,clearTimeout(t.timer),this.fetching=!0,n.Z.get("sites/"+this.domainId+"/email?v="+Date.now()).then((function(a){console.log(a),t.data=a.data.item,document.title="Email | "+t.data.domain,t.data.dns.updating&&(console.log("checking dns"),t.timer=setTimeout(t.fetchData,6e4))})).catch((function(t){console.log(t)})).finally((function(){t.fetching=!1}))},toggleEmail(){var t=this;this.error="",this.loading=!0,n.Z.post("sites/"+this.domainId+"/email",{update:1,status:this.data.email}).then((function(a){console.log(a),a.data.error?t.error=a.data.error:a.data.success&&t.fetchData()})).catch((function(t){console.log(t)})).finally((function(){t.fetching=!1,t.loading=!1}))},addEmail(){this.drawer=!0,this.userReadonly=!1,this.email={}},editEmail(t){this.drawer=!0,this.userReadonly=!0,this.email=this.data.emails[t]},saveEmail(){var t=this;this.email.user&&(this.loading=!0,this.error="",n.Z.post("sites/"+this.domainId+"/email",this.email).then((function(a){console.log(a),a.data.success?(t.drawer=!1,t.fetchData()):(t.error=a.data.error,t.loading=!1)})).catch((function(t){console.log(t)})).finally((function(){t.loading=!1})))},deleteEmail(t){this.$confirm("Delete "+t+"?").then((a=>{if(a){var e=this;this.loading=!0,this.error="",n.Z.post("sites/"+this.domainId+"/email",{delete:1,user:t}).then((function(t){console.log(t),t.data.success?e.fetchData():(e.error=t.data.error,e.loading=!1)})).catch((function(t){console.log(t)})).finally((function(){e.loading=!1}))}}))},fixDomainDns(){var t=this;this.error="",this.loading=!0,n.Z.post("sites/"+t.domainId+"/fixmx",{}).then((function(a){console.log(a),t.loading=!1,a.data.success?t.fetchData():"auth"==a.data.error?t.authRequired=!0:t.error=a.data.error})).catch((function(t){console.log(t)}))},fixDkim(){var t=this;this.error="",this.loading=!0,n.Z.post("sites/"+t.domainId+"/fixdkim",{}).then((function(a){console.log(a),t.loading=!1,a.data.success?t.fetchData():"auth"==a.data.error?t.authRequired=!0:t.error=a.data.error})).catch((function(t){console.log(t)}))},fixSpf(){var t=this;this.error="",this.loading=!0,n.Z.post("sites/"+t.domainId+"/fixspf",{}).then((function(a){console.log(a),t.loading=!1,a.data.success?t.fetchData():"auth"==a.data.error?t.authRequired=!0:t.error=a.data.error})).catch((function(t){console.log(t)}))},authPrompt(){this.authRequired=!1,window.open("https://serverwand.com/account/services/"+this.data.server.dns)}}},l=o,d=e(1001),c=(0,d.Z)(l,i,r,!1,null,null,null),u=c.exports}}]);
//# sourceMappingURL=9240.1bc7d9a8.js.map