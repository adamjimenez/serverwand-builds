(self["webpackChunkServerWand"]=self["webpackChunkServerWand"]||[]).push([[8547],{87622:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ge}});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.error?a("v-alert",{attrs:{type:"error"}},[e._v(" "+e._s(e.error)+" ")]):e._e(),a("Loading",{attrs:{value:e.loading}}),a("EditFile",{ref:"editFile",attrs:{serverId:e.serverId,action:"files"},on:{complete:function(t){return e.fetchData()},error:e.handleError,loading:e.handleLoading}}),a("v-card",{attrs:{loading:e.fetching}},[a("v-container",{attrs:{fluid:""}},[a("v-row",[a("v-col",{staticClass:"flex-grow-0"},[a("NewFile",{attrs:{serverId:e.serverId,path:e.path},on:{complete:function(t){return e.fetchData()},error:e.handleError}})],1),a("v-col",{staticClass:"flex-grow-0"},[a("NewFolder",{attrs:{serverId:e.serverId,path:e.path},on:{complete:function(t){return e.fetchData()},error:e.handleError}})],1),a("Upload",{attrs:{serverId:e.serverId,path:e.path,dropZone:e.$refs.results,folder:"folder"},on:{complete:function(t){return e.fetchData()},error:e.handleError}}),1===e.selected.length?a("v-col",{staticClass:"flex-grow-0"},[a("Rename",{attrs:{serverId:e.serverId,path:e.path,selected:e.selected},on:{complete:function(t){return e.fetchData()},error:e.handleError}})],1):e._e(),e.selected.length?a("v-col",{staticClass:"flex-grow-0"},[a("DeleteFiles",{attrs:{serverId:e.serverId,path:e.path,selected:e.selected},on:{complete:function(t){return e.fetchData()},error:e.handleError}})],1):e._e(),a("v-col",{staticClass:"flex-grow-0"},[a("Chmod",{attrs:{serverId:e.serverId,path:e.path,selected:e.selected,folderSelected:e.folderSelected},on:{complete:function(t){return e.fetchData()},error:e.handleError}})],1),a("v-col",{staticClass:"flex-grow-0"},[a("Chown",{attrs:{serverId:e.serverId,path:e.path,selected:e.selected,folderSelected:e.folderSelected},on:{complete:function(t){return e.fetchData()},error:e.handleError}})],1),a("Extract",{attrs:{serverId:e.serverId,path:e.path,selected:e.selected},on:{complete:e.fetchData,error:e.handleError,loading:e.handleLoading}}),1===e.selected.length&&"file"===e.selected[0].type?a("v-col",{staticClass:"flex-grow-0"},[a("Download",{attrs:{serverId:e.serverId,path:e.path,selected:e.selected}})],1):e._e(),a("Clipboard",{attrs:{serverId:e.serverId,path:e.path,selected:e.selected},on:{complete:function(t){return e.fetchData()},error:e.handleError}})],1)],1),a("v-container",{attrs:{fluid:""}},[a("v-row",[a("v-col",{staticClass:"flex-grow-0"},[a("v-btn",{attrs:{icon:"",disabled:"/"===e.path,title:"Up one level"},on:{click:function(t){return e.upLevel()}}},[a("v-icon",{attrs:{small:""}},[e._v("arrow_upward")])],1)],1),a("v-col",[a("v-text-field",{staticClass:"ma-0 pa-0",on:{change:e.fetchData,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.fetchData.apply(null,arguments)}},model:{value:e.path,callback:function(t){e.path=t},expression:"path"}})],1),a("v-col",{attrs:{cols:"2"}},[a("v-text-field",{staticClass:"ma-0 pa-0",attrs:{placeholder:"Search","prepend-inner-icon":"search"},on:{change:e.fetchData,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.fetchData.apply(null,arguments)}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],1)],1),a("v-data-table",{ref:"results",staticClass:"results",attrs:{headers:e.headers,items:e.items,"show-select":"","mobile-breakpoint":"0"},on:{"click:row":e.open},scopedSlots:e._u([{key:"item.size",fn:function(t){var a=t.item;return[e._v(" "+e._s(e._f("prettyBytes")(a.size))+" ")]}},{key:"item.modified",fn:function(t){var a=t.item;return[e._v(" "+e._s(e._f("formatDate")(a.modified))+" ")]}},{key:"item.owner",fn:function(t){var a=t.item;return[e._v(" "+e._s(a.owner)+" "+e._s(a.group)+" ")]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)],1)},r=[],o=a(77673),l=a(16198),i=(a(74916),a(23123),a(69600),a(41539),a(54747),a(64765),a(68309),a(4296)),s=a(84285),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-btn",{attrs:{title:"New file"},on:{click:function(t){return e.open()}}},[a("v-icon",[e._v("mdi-file-outline")])],1),a("v-dialog",{attrs:{app:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",{attrs:{loading:e.fetching}},[a("v-card-title",[e._v(" New file ")]),a("v-card-text",[a("v-text-field",{attrs:{label:"name",autofocus:""},model:{value:e.data.value,callback:function(t){e.$set(e.data,"value",t)},expression:"data.value"}}),a("v-btn",{attrs:{color:"primary",disabled:""===e.data.value},on:{click:e.save}},[e._v(" Save ")])],1)],1)],1)],1)},d=[],u={props:{serverId:null,path:null},watch:{path:function(e){this&&(this.data.path=e)}},data:function(){return{fetching:!1,dialog:!1,data:{value:""}}},created:function(){this.data.path=this.path},methods:{open:function(){this.data.value="",this.dialog=!0},save:function(){var e=this;this.error="",this.fetching=!0,this.loading=!0,i.Z.post("servers/"+this.serverId+"/files",{cmd:"new_file",new_file:this.data.value,path:this.data.path}).then((function(t){if(console.log(t),t.data.success)e.dialog=!1,e.$emit("complete");else{var a=t.data.error?t.data.error:t.data;e.$emit("error",a)}})).catch((function(e){return console.log(e)})).finally((function(){e.fetching=!1,e.loading=!1}))}}},h=u,f=a(1001),v=(0,f.Z)(h,c,d,!1,null,null,null),p=v.exports,m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-btn",{attrs:{title:"New folder"},on:{click:function(t){return e.open()}}},[a("v-icon",[e._v("mdi-folder-outline")])],1),a("v-dialog",{attrs:{app:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",{attrs:{loading:e.fetching}},[a("v-card-title",[e._v(" New folder ")]),a("v-card-text",[a("v-text-field",{attrs:{label:"name",autofocus:""},model:{value:e.data.value,callback:function(t){e.$set(e.data,"value",t)},expression:"data.value"}}),a("v-btn",{attrs:{color:"primary",disabled:""===e.data.value},on:{click:e.save}},[e._v(" Save ")])],1)],1)],1)],1)},g=[],b={props:{serverId:null,path:null},watch:{path:function(e){this&&(this.data.path=e)}},data:function(){return{fetching:!1,dialog:!1,data:{value:""}}},created:function(){this.data.path=this.path},methods:{open:function(){this.data.value="",this.dialog=!0},save:function(){var e=this;this.error="",this.fetching=!0,this.loading=!0,i.Z.post("servers/"+this.serverId+"/files",{cmd:"new_folder",new_folder:this.data.value,path:this.data.path}).then((function(t){if(console.log(t),t.data.success)e.dialog=!1,e.$emit("complete");else{var a=t.data.error?t.data.error:t.data;e.$emit("error",a)}})).catch((function(e){return console.log(e)})).finally((function(){e.fetching=!1,e.loading=!1}))}}},w=b,x=(0,f.Z)(w,m,g,!1,null,null,null),_=x.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.selected.length?a("div",[a("v-btn",{attrs:{disabled:!e.selected,title:"Change Permissions"},on:{click:function(t){return e.chmod()}}},[a("v-icon",[e._v("mdi-file-key-outline")])],1),a("v-dialog",{attrs:{app:"",width:"unset"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",{attrs:{loading:e.fetching,flat:""}},[a("v-card-title",[e._v(" File permissions ")]),a("v-card-text",[a("v-container",{attrs:{fluid:""}},[a("div",[e._v("Owner")]),a("v-row",[a("v-col",[a("v-checkbox",{attrs:{label:"Read"},on:{change:function(t){return e.calcMode()}},model:{value:e.ownerR,callback:function(t){e.ownerR=t},expression:"ownerR"}})],1),a("v-col",[a("v-checkbox",{attrs:{label:"Write"},on:{change:function(t){return e.calcMode()}},model:{value:e.ownerW,callback:function(t){e.ownerW=t},expression:"ownerW"}})],1),a("v-col",[a("v-checkbox",{attrs:{label:"Execute"},on:{change:function(t){return e.calcMode()}},model:{value:e.ownerE,callback:function(t){e.ownerE=t},expression:"ownerE"}})],1)],1),a("div",{staticClass:"mt-5"},[e._v("Group")]),a("v-row",[a("v-col",[a("v-checkbox",{attrs:{label:"Read"},on:{change:function(t){return e.calcMode()}},model:{value:e.groupR,callback:function(t){e.groupR=t},expression:"groupR"}})],1),a("v-col",[a("v-checkbox",{attrs:{label:"Write"},on:{change:function(t){return e.calcMode()}},model:{value:e.groupW,callback:function(t){e.groupW=t},expression:"groupW"}})],1),a("v-col",[a("v-checkbox",{attrs:{label:"Execute"},on:{change:function(t){return e.calcMode()}},model:{value:e.groupE,callback:function(t){e.groupE=t},expression:"groupE"}})],1)],1),a("div",{staticClass:"mt-5"},[e._v("Public")]),a("v-row",[a("v-col",[a("v-checkbox",{attrs:{label:"Read"},on:{change:function(t){return e.calcMode()}},model:{value:e.publicR,callback:function(t){e.publicR=t},expression:"publicR"}})],1),a("v-col",[a("v-checkbox",{attrs:{label:"Write"},on:{change:function(t){return e.calcMode()}},model:{value:e.publicW,callback:function(t){e.publicW=t},expression:"publicW"}})],1),a("v-col",[a("v-checkbox",{attrs:{label:"Execute"},on:{change:function(t){return e.calcMode()}},model:{value:e.publicE,callback:function(t){e.publicE=t},expression:"publicE"}})],1)],1)],1),a("v-text-field",{attrs:{label:"mode",autofocus:""},on:{keyup:function(t){return e.modeToCheckboxes()}},model:{value:e.data.mode,callback:function(t){e.$set(e.data,"mode",t)},expression:"data.mode"}}),e.folderSelected?a("v-checkbox",{attrs:{label:"Replace child permissions"},model:{value:e.data.recursive,callback:function(t){e.$set(e.data,"recursive",t)},expression:"data.recursive"}}):e._e(),a("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.doChmod()}}},[e._v(" Save ")])],1)],1)],1)],1):e._e()},E=[],I={props:{serverId:null,path:null,selected:null,folderSelected:null},watch:{path:function(e){this.data.path=e},selected:function(e){this.data.selected=e}},data:function(){return{fetching:!1,data:{recursive:!1},error:"",dialog:!1,ownerR:!1,ownerW:!1,ownerE:!1,groupR:!1,groupW:!1,groupE:!1,publicR:!1,publicW:!1,publicE:!1}},methods:{calcMode:function(){var e=0,t=0,a=0;this.ownerR&&(e+=4),this.ownerW&&(e+=2),this.ownerE&&(e+=1),this.groupR&&(a+=4),this.groupW&&(a+=2),this.groupE&&(a+=1),this.publicR&&(t+=4),this.publicW&&(t+=2),this.publicE&&(t+=1),this.data.mode=""+e+a+t},modeToCheckboxes:function(){var e=this.data.mode,t=e.substr(0,1),a=e.substr(1,1),n=e.substr(2,1);this.ownerR=t>=4&&t<=7,this.ownerW=2==t||3==t||6==t||7==t,this.ownerE=1==t||3==t||5==t||7==t,this.groupR=a>=4&&a<=7,this.groupW=2==a||3==a||6==a||7==a,this.groupE=1==a||3==a||5==a||7==a,this.publicR=n>=4&&n<=7,this.publicW=2==n||3==n||6==n||7==n,this.publicE=1==n||3==n||5==n||7==n},chmod:function(){this.dialog=!0,1===this.selected.length?this.data.mode=this.selected[0].permsn:this.data.mode="000",this.modeToCheckboxes()},doChmod:function(){var e=this;this.fetching=!0;var t=[];this.selected.forEach((function(e){return t.push(e.id)})),i.Z.post("servers/"+this.serverId+"/files",{cmd:"chmod",mode:this.data.mode,recursive:this.data.recursive,files:t}).then((function(t){if(console.log(t),t.data.success)e.dialog=!1,e.$emit("complete");else{var a=t.data.error?t.data.error:t.data;e.$emit("error",a)}})).catch((function(e){return console.log(e)})).finally((function(){return e.fetching=!1}))}}},C=I,y=(0,f.Z)(C,k,E,!1,null,null,null),$=y.exports,R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.selected.length?a("div",[a("v-btn",{attrs:{disabled:!e.selected,title:"Change owner"},on:{click:function(t){return e.chown()}}},[a("v-icon",[e._v("mdi-account")])],1),a("v-dialog",{attrs:{app:"",width:"unset"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",{attrs:{loading:e.fetching,flat:""}},[a("v-card-title",[e._v(" File ownership ")]),a("v-card-text",[a("v-text-field",{attrs:{label:"Owner",autofocus:""},model:{value:e.data.owner,callback:function(t){e.$set(e.data,"owner",t)},expression:"data.owner"}}),a("v-text-field",{attrs:{label:"Group"},model:{value:e.data.group,callback:function(t){e.$set(e.data,"group",t)},expression:"data.group"}}),e.folderSelected?a("v-checkbox",{attrs:{label:"Replace child permissions"},model:{value:e.data.recursive,callback:function(t){e.$set(e.data,"recursive",t)},expression:"data.recursive"}}):e._e(),a("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.doChown()}}},[e._v(" Save ")])],1)],1)],1)],1):e._e()},D=[],Z={props:{serverId:null,path:null,selected:null,folderSelected:null},watch:{path:function(e){this.data.path=e},selected:function(e){this.data.selected=e}},data:function(){return{fetching:!1,data:{recursive:!1},error:"",dialog:!1}},methods:{chown:function(){this.dialog=!0,1===this.selected.length?(this.data.owner=this.selected[0].owner,this.data.group=this.selected[0].group):(this.data.owner="",this.data.group="")},doChown:function(){var e=this;this.fetching=!0;var t=[];this.selected.forEach((function(e){return t.push(e.id)})),i.Z.post("servers/"+this.serverId+"/files",{cmd:"chown",owner:this.data.owner,group:this.data.group,recursive:this.data.recursive,files:t}).then((function(t){if(console.log(t),t.data.success)e.dialog=!1,e.$emit("complete");else{var a=t.data.error?t.data.error:t.data;e.$emit("error",a)}})).catch((function(e){console.log(e)})).finally((function(){e.fetching=!1}))}}},W=Z,S=(0,f.Z)(W,R,D,!1,null,null,null),O=S.exports,N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return 1===e.selected.length?a("div",[a("v-btn",{attrs:{disabled:!e.selected,title:"Rename"},on:{click:function(t){return e.rename()}}},[a("v-icon",[e._v("mdi-rename-box")])],1),a("v-dialog",{attrs:{app:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",{attrs:{loading:e.fetching}},[a("v-card-title",[e._v(" Rename ")]),a("v-card-text",[a("v-text-field",{attrs:{label:"name",autofocus:""},model:{value:e.data.newName,callback:function(t){e.$set(e.data,"newName",t)},expression:"data.newName"}}),a("v-btn",{attrs:{color:"primary"},on:{click:e.doRename}},[e._v(" Save ")])],1)],1)],1)],1):e._e()},F=[],L=void 0,M={props:{serverId:null,path:null,selected:null},watch:{path:function(e){return L.data.path=e},selected:function(e){return L.data.selected=e}},data:function(){return{fetching:!1,data:{},error:"",dialog:!1}},methods:{rename:function(){this.dialog=!0,this.data.oldName=this.selected[0].name,this.data.newName=this.selected[0].name},doRename:function(){var e=this;this.fetching=!0,i.Z.post("servers/"+this.serverId+"/files",{cmd:"rename",path:this.path,old_name:this.data.oldName,new_name:this.data.newName}).then((function(t){if(console.log(t),t.data.success)e.dialog=!1,e.$emit("complete");else{var a=t.data.error?t.data.error:t.data;e.$emit("error",a)}})).catch((function(e){return console.log(e)})).finally((function(){return e.fetching=!1}))}}},z=M,T=(0,f.Z)(z,N,F,!1,null,null,null),U=T.exports,j=a(32724),H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.selected.length?a("div",[a("v-btn",{attrs:{title:"Delete"},on:{click:function(t){return e.deleteItem()}}},[a("v-icon",[e._v("delete")])],1)],1):e._e()},P=[],G={props:{serverId:null,path:null,selected:null},watch:{path:function(e){this.data.path=e},selected:function(e){this.data.selected=e}},data:function(){return{fetching:!1,error:"",data:{}}},methods:{deleteItem:function(){var e=this;this.$confirm("Delete selected files?").then((function(t){if(t){var a=e;e.fetching=!0;var n=[];e.selected.forEach((function(e){return n.push(e.id)})),i.Z.post("servers/"+e.serverId+"/files",{cmd:"delete",files:n}).then((function(e){if(console.log(e),e.data.success)a.$emit("complete");else{var t=e.data.error?e.data.error:e.data;a.$emit("error",t)}})).catch((function(e){console.log(e)})).finally((function(){return a.fetching=!1}))}}))}}},A=G,B=(0,f.Z)(A,H,P,!1,null,null,null),q=B.exports,J=function(){var e=this,t=e.$createElement,a=e._self._c||t;return 1===e.selected.length&&"file"===e.selected[0].type?a("div",[a("v-btn",{attrs:{title:"Download"},on:{click:function(t){return e.download()}}},[a("v-icon",[e._v("download")])],1)],1):e._e()},K=[],Q=void 0,V={props:{serverId:null,path:null,selected:null},watch:{path:function(e){return Q.data.path=e},selected:function(e){return Q.data.selected=e}},data:function(){return{fetching:!1,data:{},error:"",dialog:!1}},methods:{download:function(){window.open("https://serverwand.com/api/servers/"+this.serverId+"/files?d="+encodeURIComponent(this.selected[0].id))}}},X=V,Y=(0,f.Z)(X,J,K,!1,null,null,null),ee=Y.exports,te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-col",{staticClass:"flex-grow-0",staticStyle:{"min-width":"264px"}},[a("v-row",[e.selected.length?a("v-col",{staticClass:"flex-grow-0"},[a("v-btn",{attrs:{title:"Cut"},on:{click:function(t){return e.cut()}}},[a("v-icon",[e._v("content_cut")])],1)],1):e._e(),e.selected.length?a("v-col",{staticClass:"flex-grow-0"},[a("v-btn",{attrs:{title:"Copy"},on:{click:function(t){return e.copy()}}},[a("v-icon",[e._v("file_copy")])],1)],1):e._e(),e.data.items.length&&e.path!=e.data.src?a("v-col",{staticClass:"flex-grow-0"},[a("v-btn",{attrs:{title:"Paste"},on:{click:function(t){return e.paste()}}},[a("v-icon",[e._v("content_paste")])],1)],1):e._e()],1)],1)},ae=[],ne={props:{serverId:null,path:null,selected:null},watch:{path:function(e){this.data.path=e},selected:function(e){this.data.selected=e}},data:function(){return{fetching:!1,data:{items:[],cut:!1,src:""},error:"",dialog:!1}},methods:{cut:function(){this.copy(!0)},copy:function(e){var t=this;this.data.cut=!!e,this.data.src=this.path,this.data.items=[],this.selected.forEach((function(e){return t.data.items.push(e.name)}))},paste:function(){var e=this;console.log(this.data);var t=this.data.cut?"Move":"Copy";this.$confirm(t+" "+this.data.items.length+" items?").then((function(a){if(a){var n=e;e.fetching=!0,i.Z.post("servers/"+e.serverId+"/files",{cmd:t.toLowerCase(),path:e.path,src:e.data.src,files:e.data.items}).then((function(e){if(console.log(e),"move"===t.toLowerCase()&&(n.data.items=[]),e.data.success)n.$emit("complete");else{var a=e.data.error?e.data.error:e.data;n.$emit("error",a)}})).catch((function(e){return console.log(e)})).finally((function(){return n.fetching=!1}))}}))}}},re=ne,oe=(0,f.Z)(re,te,ae,!1,null,null,null),le=oe.exports,ie=a(22046),se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.msg?a("v-alert",{staticStyle:{position:"fixed",width:"100%","z-index":"10",left:"0",bottom:"0",margin:"0 auto"},attrs:{dark:"",type:"info"}},[e._v(" "+e._s(e.msg)+" ")]):e._e(),1===e.selected.length&&-1!==["zip","gz","tar"].indexOf(e.fileExtension(e.selected[0].name))?a("v-col",{staticClass:"flex-grow-0"},[a("v-btn",{attrs:{disabled:!e.selected,title:"Extract"},on:{click:function(t){return e.extract()}}},[a("v-icon",[e._v("mdi-folder-zip-outline")])],1)],1):e._e()],1)},ce=[],de={props:{serverId:null,path:null,selected:null},watch:{path:function(e){this.data.path=e},selected:function(e){this.data.selected=e}},data:function(){return{data:{recursive:!1},error:"",dialog:!1,msg:""}},methods:{fileExtension:function(e){var t=e.lastIndexOf(".");return-1===t?"":e.substr(t+1,e.length)},extract:function(){var e=this;this.$emit("loading",!0),i.Z.event("servers/"+this.serverId+"/files?cmd=extract&id="+encodeURIComponent(this.selected[0].id),(function(t){e.msg=t.msg}),(function(t){return e.$emit("error",t)}),(function(){e.msg="",e.$emit("complete")}))}}},ue=de,he=(0,f.Z)(ue,se,ce,!1,null,null,null),fe=he.exports,ve={components:{Loading:s.Z,NewFile:p,NewFolder:_,Chmod:$,Chown:O,Rename:U,EditFile:j.Z,DeleteFiles:q,Download:ee,Clipboard:le,Upload:ie.Z,Extract:fe},data:function(){return{path:"/",search:"",error:"",items:[],server:{},data:{},loading:!1,fetching:!1,userHashChange:!0,serverId:0,selected:[],folderSelected:!1,headers:[{text:"",value:""},{text:"Name ",value:"name"},{text:"Size ",value:"size",class:"d-none d-sm-table-cell",cellClass:"d-none d-sm-table-cell"},{text:"Last modified ",value:"modified",class:"d-none d-sm-table-cell",cellClass:"d-none d-sm-table-cell"},{text:"Permissions ",value:"perms",class:"d-none d-sm-table-cell",cellClass:"d-none d-sm-table-cell"},{text:"Owner ",value:"owner",class:"d-none d-sm-table-cell",cellClass:"d-none d-sm-table-cell"}],fileToOpen:""}},computed:{dir:function(){var e=this.basename(this.path);if(-1!==e.indexOf(".")){var t=this.path.split(/[\\/]/);return t.pop(),t.join("/")}return this.path}},watch:{path:{handler:function(e){window.ssh_path=e,this.userHashChange=!1,location.hash=e}},selected:function(e){var t=!1;e.forEach((function(e){"folder"===e.type&&(t=!0)})),this.folderSelected=t}},created:function(){this.serverId=this.$route.params.id;var e=this;if(window.onhashchange=function(){e.userHashChange?(e.path=location.hash.substr(1),e.fetchData()):e.userHashChange=!0},location.hash){this.path=location.hash.substr(1);var t=this.basename(this.path);-1!==t.indexOf(".")&&(this.fileToOpen=t)}this.fetchData()},methods:{basename:function(e){return e.split(/[\\/]/).pop()},fetchData:function(){var e=this;this.error="",this.fetching=!0,this.search?(this.items=[],i.Z.event("servers/"+this.serverId+"/files?path="+encodeURIComponent(this.dir)+"&search="+encodeURIComponent(this.search),(function(t){var a=t.msg.split("\n");a.forEach((function(t){var a=!1;e.items.forEach((function(e){e.id===t&&(a=!0)})),a||e.items.push({id:t,name:e.basename(t),type:"file"})}))}),(function(t){return e.error=t}),(function(){return e.fetching=!1}))):i.Z.post("servers/"+this.serverId+"/files",{path:this.dir}).then((function(t){console.log(t),t.data.error?e.error=t.data.error:(e.server=t.data.item,e.items=[],t.data.files.forEach((function(t){e.items.push({id:t.id,name:t.name,size:t.size,type:t.type,modified:t.modified,perms:t.perms,permsn:t.permsn,owner:t.owner,group:t.group,selected:!1})})),document.title="Files | "+e.server.name)})).catch((function(e){console.log(e)})).finally((function(){if(e.fetching=!1,e.selected=[],e.fileToOpen){var t=e.fileToOpen,a=1;if(-1!==t.indexOf(":")){var n=t.split(":");t=n[0],a=n[1]}e.items.forEach(function(){var n=(0,l.Z)((0,o.Z)().mark((function n(r){return(0,o.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r.name!==t){n.next=5;break}return e.fileToOpen="",n.next=4,e.$refs.editFile.open(r);case 4:e.$refs.editFile.goToLine(a);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}}))},open:function(e){this.error="","folder"===e.type||"link"===e.type?(this.path=e.id,this.fetchData()):"file"===e.type&&this.$refs.editFile.open(e)},upLevel:function(){console.log(this.path),this.search="";var e=this.path.lastIndexOf("/");-1!==e&&(this.path=this.dir.substr(0,e),this.dir||(this.path="/")),this.fetchData()},handleError:function(e){this.error=e},handleLoading:function(e){this.fetching=e}}},pe=ve,me=(0,f.Z)(pe,n,r,!1,null,null,null),ge=me.exports},81150:function(e){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},69600:function(e,t,a){"use strict";var n=a(82109),r=a(1702),o=a(68361),l=a(45656),i=a(9341),s=r([].join),c=o!=Object,d=i("join",",");n({target:"Array",proto:!0,forced:c||!d},{join:function(e){return s(l(this),void 0===e?",":e)}})},64765:function(e,t,a){"use strict";var n=a(46916),r=a(27007),o=a(19670),l=a(84488),i=a(81150),s=a(41340),c=a(58173),d=a(97651);r("search",(function(e,t,a){return[function(t){var a=l(this),r=void 0==t?void 0:c(t,e);return r?n(r,t,a):new RegExp(t)[e](s(a))},function(e){var n=o(this),r=s(e),l=a(t,n,r);if(l.done)return l.value;var c=n.lastIndex;i(c,0)||(n.lastIndex=0);var u=d(n,r);return i(n.lastIndex,c)||(n.lastIndex=c),null===u?-1:u.index}]}))}}]);
//# sourceMappingURL=8547-legacy.bf54bd6f.js.map