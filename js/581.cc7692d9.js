"use strict";(self["webpackChunkServerWand"]=self["webpackChunkServerWand"]||[]).push([[581],{37428:function(e,t,s){s.d(t,{Z:function(){return c}});var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{ref:"container"},[e.text?s("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[s("span",e._g({on:{click:function(t){return e.copy(e.val)},mouseleave:function(t){return e.resetCopyText()}}},r),[e._v(" "+e._s(e.val)+" ")])]}}],null,!1,276876146)},[s("span",[e._v(e._s(e.copyText))])]):s("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[s("v-btn",e._g({attrs:{icon:""},on:{click:function(t){return e.copy(e.val)},mouseleave:function(t){return e.resetCopyText()}}},r),[s("v-icon",{attrs:{small:""}},[e._v("file_copy")])],1)]}}])},[s("span",[e._v(e._s(e.copyText))])])],1)},a=[],n={props:{val:null,text:Boolean},data(){return{copyText:"Copy"}},methods:{copy(e){var t=document.createElement("textarea");this.$refs["container"].appendChild(t),t.setAttribute("id","clipboard"),t.value=e,t.select(),document.execCommand("Copy"),t.parentNode.removeChild(t),this.copyText="Copied"},resetCopyText(){var e=this;setTimeout((()=>e.copyText="Copy"),500)}}},o=n,i=s(1001),l=(0,i.Z)(o,r,a,!1,null,null,null),c=l.exports},84285:function(e,t,s){s.d(t,{Z:function(){return c}});var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-dialog",{attrs:{persistent:"",content:"","content-class":"centered-dialog"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[s("v-container",{attrs:{"fill-height":""}},[s("v-card",{attrs:{color:"primary",dark:""}},[s("v-card-text",[s("v-layout",{attrs:{row:""}},[s("i",{staticClass:"fas fa-magic fa-2x faa-horizontal animated"}),s("h2",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.message))])])],1)],1)],1)],1)},a=[],n={name:"Loading",data:()=>({}),props:{value:{type:Boolean,default:!1},message:{type:String,default:"Summoning..."}}},o=n,i=s(1001),l=(0,i.Z)(o,r,a,!1,null,null,null),c=l.exports},10581:function(e,t,s){s.r(t),s.d(t,{default:function(){return S}});var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.error?s("v-alert",{attrs:{type:"error"}},[e._v(" "+e._s(e.error)+" ")]):e._e(),s("Loading",{attrs:{value:e.loading}}),s("v-card",{staticClass:"pa-3",attrs:{loading:e.fetching}},[s("TogglePasswordAuthentication",{attrs:{serverId:e.serverId,passwordAuthentication:e.data.password_authentication}}),s("v-list",[s("v-list-item-group",[e._l(e.data.users,(function(t,r){return[s("v-list-item",{key:"item-"+r,attrs:{value:t},on:{click:function(s){return e.editItem(t)}},scopedSlots:e._u([{key:"default",fn:function(){return[s("v-list-item-content",[s("v-list-item-title",[e._v(" "+e._s(t.name)+" "),t.sudo?s("v-icon",{attrs:{"x-small":"",right:""}},[e._v("fas fa-crown")]):e._e()],1)],1),s("v-list-item-action",[s("v-btn",{attrs:{icon:"",disabled:e.loading,loading:e.loading,title:"Authorized keys"},on:{click:[function(s){return e.openKeys(t)},function(e){e.stopPropagation()}]}},[s("v-icon",{attrs:{small:""}},[e._v("vpn_key")])],1)],1),s("v-list-item-action",[s("v-btn",{attrs:{icon:"",disabled:e.loading,loading:e.loading},on:{click:[function(s){return e.deleteItem(t.name)},function(e){e.stopPropagation()}]}},[s("v-icon",{attrs:{small:""}},[e._v("delete")])],1)],1)]},proxy:!0}],null,!0)})]}))],2)],1),s("v-container",{staticClass:"mt-5",attrs:{fluid:""}},[s("v-row",[s("v-btn",{staticClass:"mr-3",on:{click:function(t){return e.addItem()}}},[e._v(" Add system user ")]),s("ClearSSHUser",{attrs:{serverId:e.serverId,server:e.data}})],1)],1)],1),s("v-navigation-drawer",{attrs:{app:"",temporary:"",right:""},model:{value:e.userDrawer,callback:function(t){e.userDrawer=t},expression:"userDrawer"}},[s("v-card",[s("v-card-title",[e._v(" System user ")]),s("v-card-text",[s("v-text-field",{attrs:{label:"User",required:""},model:{value:e.system_user.name,callback:function(t){e.$set(e.system_user,"name",t)},expression:"system_user.name"}}),s("v-text-field",{attrs:{type:"password",label:"Password",required:"",autocomplete:"new-password"},model:{value:e.system_user.password,callback:function(t){e.$set(e.system_user,"password",t)},expression:"system_user.password"}}),s("v-switch",{attrs:{label:"sudo"},model:{value:e.system_user.sudo,callback:function(t){e.$set(e.system_user,"sudo",t)},expression:"system_user.sudo"}}),s("v-switch",{attrs:{disabled:!e.system_user.sudo,label:"sudo without password"},model:{value:e.system_user.sudo_without_password,callback:function(t){e.$set(e.system_user,"sudo_without_password",t)},expression:"system_user.sudo_without_password"}}),s("v-btn",{attrs:{disabled:e.fetching,loading:e.loading,color:"success"},on:{click:e.saveUser}},[e._v(" Save ")])],1)],1)],1),s("v-navigation-drawer",{attrs:{app:"",temporary:"",right:""},model:{value:e.keyDrawer,callback:function(t){e.keyDrawer=t},expression:"keyDrawer"}},[s("v-card",[s("v-card-title",[e._v(" Add key for "+e._s(e.user.name)+" ")]),s("v-card-text",[s("v-text-field",{attrs:{label:"key"},model:{value:e.key,callback:function(t){e.key=t},expression:"key"}}),s("v-btn",{attrs:{disabled:e.fetching,loading:e.loading,color:"success"},on:{click:e.saveKey}},[e._v(" Save ")])],1)],1)],1),s("v-dialog",{model:{value:e.showKeys,callback:function(t){e.showKeys=t},expression:"showKeys"}},[s("v-card",{attrs:{loading:e.fetching}},[s("v-card-title",[e._v(" Keys for "+e._s(e.user.name)+" ")]),s("v-card-text",[s("div",[e._v("Public SSH key")]),s("v-list",[s("v-list-item-group",[s("v-list-item",[s("v-list-item-content",[s("v-list-item-subtitle",[e._v(" "+e._s(e.user.key)+" ")])],1),s("v-list-item-action",[s("v-btn",{attrs:{icon:"",disabled:e.fetching,loading:e.fetching}},[s("Copy",{attrs:{val:e.user.key}})],1)],1)],1)],1)],1),s("div",[e._v("Authorized keys")]),e.fetching?e._e():s("v-list",[s("v-list-item-group",[e._l(e.keys,(function(t,r){return[s("v-list-item",{key:"item-"+r,attrs:{value:t},scopedSlots:e._u([{key:"default",fn:function(){return[s("v-list-item-content",[s("v-list-item-title",[e._v(" "+e._s(t.name)+" ")]),s("v-list-item-subtitle",[e._v(" "+e._s(t.key)+" ")])],1),s("v-list-item-action",[s("v-btn",{attrs:{icon:"",disabled:e.fetching,loading:e.fetching}},[s("Copy",{attrs:{val:t.key}})],1),s("v-btn",{attrs:{icon:"",disabled:e.fetching,loading:e.fetching},on:{click:[function(s){return e.deleteKey(t.line)},function(e){e.stopPropagation()}]}},[s("v-icon",{attrs:{small:""}},[e._v("delete")])],1)],1)]},proxy:!0}],null,!0)})]}))],2)],1)],1),e.keys.length?e._e():s("v-card-text",[e._v(" No keys ")])],1),s("v-card",[s("div",[s("v-card-title",{attrs:{"primary-title":""}},[s("v-btn",{on:{click:function(t){return e.addKey()}}},[e._v(" Add Key ")])],1)],1)])],1)],1)},a=[],n=s(4296),o=s(84285),i=s(37428),l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("v-container",{attrs:{fluid:""}},[s("v-row",[s("v-switch",{staticClass:"mx-3",attrs:{label:"Password Authentication"},on:{change:function(t){return e.togglePasswordAuthentication()}},model:{value:e.data.passwordAuthentication,callback:function(t){e.$set(e.data,"passwordAuthentication",t)},expression:"data.passwordAuthentication"}}),s("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,a=t.attrs;return[s("v-icon",e._g(e._b({attrs:{color:"primary"}},"v-icon",a,!1),r),[e._v(" mdi-information ")])]}}])},[s("span",[e._v(" Allow password authentication. We recommend this is disabled in favour of key authentication.")])])],1)],1)],1)},c=[],u={props:{serverId:null,passwordAuthentication:null},watch:{passwordAuthentication:function(e){this.data.passwordAuthentication=e}},data(){return{fetching:!1,data:{passwordAuthentication:!1}}},created(){this.data.passwordAuthentication=this.passwordAuthentication},methods:{togglePasswordAuthentication(){var e=this;this.error="",this.fetching=!0,this.loading=!0,n.Z.post("servers/"+this.serverId+"/password_authentication",{save:1,enable:this.data.passwordAuthentication}).then((t=>{console.log(t),t.data.error?e.error=t.data.error:t.data.success&&e.$emit("complete")})).catch((e=>{console.log(e)})).finally((()=>{e.fetching=!1,e.loading=!1}))}}},d=u,v=s(1001),h=(0,v.Z)(d,l,c,!1,null,null,null),f=h.exports,m=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-btn",{attrs:{disabled:e.fetching,loading:e.fetching},on:{click:e.clearSSHUser}},[e._v(" Clear SSH user ")])},p=[],y={props:{serverId:null},data(){return{fetching:!1}},methods:{clearSSHUser(){this.$confirm("Clear the default SSH user used for terminal access?").then((e=>{if(e){var t=this;t.fetching=!0,n.Z.post("servers/"+this.serverId+"/savesshuser",{ssh_username:""}).then((e=>{console.log(e),e.data.success?t.$emit("complete"):t.error=e.data.error})).catch((e=>console.log(e))).finally((()=>t.fetching=!1))}}))}}},g=y,_=(0,v.Z)(g,m,p,!1,null,null,null),w=_.exports,k={components:{Loading:o.Z,Copy:i.Z,TogglePasswordAuthentication:f,ClearSSHUser:w},data(){return{error:"",data:{users:{}},system_user:{user:"",password:"",key:"",sudo:!1,sudo_without_password:!1},details:"",loading:!1,fetching:!1,userDrawer:!1,keyDrawer:!1,serverId:0,user:"",showKeys:!1,keys:[],key:""}},created(){this.serverId=this.$route.params.id,this.fetchData()},methods:{fetchData(){var e=this;this.error="",this.fetching=!0,n.Z.get("servers/"+this.serverId+"/systemusers?detailed=1").then((function(t){if(console.log(t),t.data.error)return e.error=t.data.error,!1;e.data=t.data.item,document.title="System users | "+e.data.name})).catch((function(e){console.log(e)})).finally((function(){e.fetching=!1}))},addItem(){this.system_user.name="",this.system_user.password="",this.system_user.key="",this.system_user.sudo=!1,this.userDrawer=!0},editItem(e){this.system_user=e,this.userDrawer=!0},deleteItem(e){return this.$confirm("Delete "+e+"?").then((t=>{if(t){var s=this;this.fetching=!0,this.error="",n.Z.post("servers/"+this.serverId+"/systemusers",{user:e}).then((function(e){console.log(e),e.data.success?s.fetchData():(s.error=e.data.error,s.fetching=!1)})).catch((function(e){console.log(e),s.fetching=!1}))}})),!1},saveUser(){var e=this;this.system_user.name&&(this.details="",this.fetching=!0,this.error="",n.Z.post("servers/"+this.serverId+"/systemusers",this.system_user).then((function(t){console.log(t),t.data.success?(e.userDrawer=!1,e.fetchData()):(e.error=t.data.error,e.fetching=!1)})).catch((function(t){console.log(t),e.fetching=!1})))},openKeys(e){var t=this;this.user=e,this.showKeys=!0,this.fetching=!0,n.Z.get("servers/"+this.serverId+"/systemusers/"+this.user.name).then((function(e){console.log(e),t.keys=e.data.keys,t.fetching=!1})).catch((function(e){console.log(e),t.fetching=!1}))},deleteKey(e){this.$confirm("Delete key?").then((t=>{if(t){var s=this;this.fetching=!0,this.error="",n.Z.post("servers/"+this.serverId+"/systemusers/"+this.user.name,{line:e}).then((function(e){console.log(e),e.data.success?s.openKeys(s.user):(s.fetching=!1,s.error=e.data.error)})).catch((function(e){s.fetching=!1,console.log(e)}))}}))},addKey(){this.showKeys=!1,this.keyDrawer=!0},saveKey(){var e=this;this.fetching=!0,this.error="",n.Z.post("servers/"+this.serverId+"/systemusers/"+this.user.name,{key:e.key}).then((function(t){console.log(t),t.data.success?(e.keyDrawer=!0,e.openKeys(e.user)):(e.fetching=!1,e.error=t.data.error)})).catch((function(t){e.fetching=!1,console.log(t)}))}}},b=k,x=(0,v.Z)(b,r,a,!1,null,null,null),S=x.exports}}]);
//# sourceMappingURL=581.cc7692d9.js.map