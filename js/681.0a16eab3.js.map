{"version":3,"file":"js/681.0a16eab3.js","mappings":"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","sources":["webpack://ServerWand/./src/views/sites/Backups.vue","webpack://ServerWand/./src/views/sites/Backups.vue?bb72"],"sourcesContent":["<template>\n  <div>\n    <v-alert v-if=\"error\" type=\"error\" :text=\"error\"></v-alert>\n\n    <Loading :value=\"loading\" />\n\n    <v-card :loading=\"fetching\" ref=\"results\">\n      <v-card-text>\n        <v-container fluid>\n          <v-row>\n            <v-col class=\"flex-grow-0\">\n              <v-btn title=\"Create backup\" ref=\"uploadFolderButton\" @click=\"createBackup()\" icon>\n                <v-icon>mdi:mdi-plus</v-icon>\n              </v-btn>\n            </v-col>\n\n            <Upload :serverId=\"serverId\" :path=\"path\" :dropZone=\"$refs.results\" @complete=\"fetchData()\"\n              @error=\"handleError\" />\n          </v-row>\n        </v-container>\n\n        <v-list v-if=\"data.items.length > 0\" max-width=\"600\">\n          <v-list-item v-for=\"(item, i) in data.items\" :key=\"`item-${i}`\" :title=\"item.name\"\n            :subtitle=\"item.date + ' - ' + prettyBytes(item.size)\" @click=\"restore(item)\">\n            <template v-slot:append>\n              <v-btn icon :disabled=\"fetching\" :loading=\"fetching\" @click.stop=\"download(item)\">\n                <v-icon size=\"small\">mdi:mdi-download</v-icon>\n              </v-btn>\n              <v-btn icon :disabled=\"fetching\" :loading=\"fetching\" @click.stop=\"deleteItem(item)\">\n                <v-icon size=\"small\">mdi:mdi-delete</v-icon>\n              </v-btn>\n            </template>\n          </v-list-item>\n        </v-list>\n      </v-card-text>\n    </v-card>\n    <Confirm ref=\"confirm\" />\n  </div>\n</template>\n\n<script>\nimport api from \"../../services/api\";\nimport Loading from \"../../components/Loading\";\nimport Upload from \"../../components/Files/Upload\";\nimport Confirm from \"../../components/ConfirmDialog.vue\";\nimport util from \"../../services/util\";\n\nexport default {\n  components: {\n    Loading,\n    Upload,\n    Confirm,\n  },\n  data() {\n    return {\n      path: \"/\",\n      domainId: null,\n      post: null,\n      error: null,\n      data: {\n        domain: \"\",\n        items: [],\n      },\n      loading: false,\n      details: \"\",\n      loading: false,\n      fetching: false,\n      alias: {\n        domain: \"\",\n        dns: false,\n      },\n      timer: null,\n      serverId: 0,\n      progress: 0,\n    };\n  },\n  created() {\n    // fetch the data when the view is created and the data is\n    // already being observed\n    this.fetchData();\n  },\n  watch: {\n    // call again the method if the route changes\n    $route: \"fetchData\",\n  },\n  methods: {\n    fetchData() {\n      var self = this;\n      this.error = \"\";\n      this.domainId = this.$route.params.id;\n      clearTimeout(self.timer);\n\n      this.fetching = true;\n      this.progress = 0;\n\n      api\n        .get(\"sites/\" + this.domainId + \"/backups\")\n        .then(function (response) {\n          console.log(response);\n\n          if (response.data.error) {\n            self.error = response.data.error;\n            return false;\n          }\n\n          self.data = response.data;\n          document.title = \"Backups\" + \" | \" + self.data.domain;\n\n          self.serverId = self.data.server.id;\n          self.path = '/var/www/vhosts/' + self.data.server.ip + '/public/backups';\n        })\n        .catch(function (error) {\n          console.log(error);\n        })\n        .finally(function () {\n          self.fetching = false;\n        });\n    },\n    createBackup() {\n      var self = this;\n      this.fetching = true;\n      this.error = '';\n\n      api\n        .get(\"sites/\" + this.domainId + \"/backups/create\")\n        .then(function (response) {\n          console.log(response);\n\n          if (!response.data.success) {\n            self.error = response.data.error;\n          } else {\n            self.fetchData();\n          }\n        })\n        .catch(function (error) {\n          console.log(error);\n        })\n        .finally(function () {\n          self.fetching = false;\n        });\n    },\n    download(item) {\n      console.log(\"https://\" + this.data.server.ip + \"/backups/\" + item.name);\n      window.open(\"https://\" + this.data.server.ip + \"/backups/\" + item.name);\n    },\n    deleteItem: async function (item) {\n      if (\n        await this.$refs.confirm.open(\n          \"Confirm\",\n          \"Delete \" + item.name\n        )\n      ) {\n\n        var self = this;\n        self.fetching = true;\n\n        api\n          .post(\"sites/\" + this.domainId + \"/backups\", { ids: [item.name] })\n          .then(function () {\n            self.fetchData();\n          })\n          .catch(function (error) {\n            console.log(error);\n            self.fetching = false;\n          });\n      }\n    },\n    restore: async function (item) {\n      if (\n        await this.$refs.confirm.open(\n          \"Confirm\",\n          \"Restore \" + item.name\n        )\n      ) {\n\n        var self = this;\n        self.fetching = true;\n\n        api\n          .post(\"sites/\" + this.domainId + \"/backups\", { restore: item.name })\n          .then(function () {\n            self.fetchData();\n          })\n          .catch(function (error) {\n            console.log(error);\n            self.fetching = false;\n          });\n      };\n    },\n    handleError(error) {\n      this.error = error;\n    },\n    handleLoading(loading) {\n      this.fetching = loading;\n    },\n    prettyBytes(value) {\n      return util.prettyBytes(value);\n    },\n  },\n};\n</script>\n","import { render } from \"./Backups.vue?vue&type=template&id=208a8bc5\"\nimport script from \"./Backups.vue?vue&type=script&lang=js\"\nexport * from \"./Backups.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/@vue/cli-service/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementBlock","$data","error","_createBlock","_component_v_alert","type","text","_createVNode","_component_Loading","value","loading","_component_v_card","fetching","ref","_component_v_card_text","_component_v_container","fluid","_component_v_row","_component_v_col","class","_component_v_btn","title","onClick","_cache","$event","$options","createBackup","icon","_component_v_icon","_component_Upload","serverId","path","dropZone","_ctx","$refs","results","onComplete","fetchData","onError","handleError","data","items","length","_component_v_list","_Fragment","_renderList","item","i","_component_v_list_item","key","name","subtitle","date","prettyBytes","size","restore","append","_withCtx","disabled","_withModifiers","download","deleteItem","_component_Confirm","components","Loading","Upload","Confirm","domainId","post","domain","details","alias","dns","timer","progress","created","this","watch","$route","methods","self","params","id","clearTimeout","api","get","then","response","console","log","document","server","ip","catch","finally","success","window","open","async","confirm","ids","handleLoading","util","__exports__","render"],"sourceRoot":""}